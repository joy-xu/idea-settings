<application>
  <component name="VimEditorSettings">
    <editor>
      <key-repeat enabled="true" />
    </editor>
  </component>
  <component name="VimHistorySettings">
    <history>
      <history-search>
        <entry>bigtable</entry>
        <entry>status</entry>
        <entry>operateMonth</entry>
        <entry>zadd</entry>
        <entry>Pair</entry>
        <entry encoding="base64">XDxuYW1lXD4=</entry>
        <entry>olap</entry>
        <entry encoding="base64">XDxTdHJpbmdcPg==</entry>
        <entry>ALREADY_OFF</entry>
        <entry>schedul</entry>
        <entry>restart</entry>
        <entry>maven</entry>
        <entry>guava</entry>
        <entry>executor</entry>
        <entry>Blocking</entry>
        <entry>PPR</entry>
        <entry>ppr</entry>
        <entry>Function</entry>
        <entry>work_place</entry>
        <entry>TODO</entry>
      </history-search>
      <history-cmd>
        <entry>1290</entry>
        <entry>%/s/long/Long/g</entry>
        <entry>%s/long/Long/g</entry>
        <entry>%s/int/Integer/g</entry>
        <entry>%s/Date/LocalDateTime/g</entry>
        <entry>%s/user/employee/g</entry>
        <entry>%s/,/;/g</entry>
        <entry>%s/localDateTime/startTime/g</entry>
        <entry>330</entry>
        <entry>192</entry>
        <entry>2634</entry>
        <entry>1480</entry>
        <entry>%A,</entry>
        <entry>%normal A,</entry>
        <entry>%normal A;</entry>
        <entry>%snormal A,</entry>
        <entry>%s normal A,</entry>
        <entry>%s normal I&quot;</entry>
        <entry>q!</entry>
        <entry>wq</entry>
      </history-cmd>
      <history-expr />
      <history-input />
    </history>
  </component>
  <component name="VimKeySettings">
    <shortcut-conflicts>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed P</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed E</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed A</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed O</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed R</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed D</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed F</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed I</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed B</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed T</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed G</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed 2</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>shift ctrl pressed 2</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed N</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed V</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed H</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed U</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed Y</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed C</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed M</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed L</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed J</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed K</text>
      </shortcut-conflict>
    </shortcut-conflicts>
  </component>
  <component name="VimMarksSettings">
    <globalmarks />
    <filemarks>
      <file name="$APPLICATION_CONFIG_DIR$/scratches/scratch_20.java" timestamp="1605595794412">
        <mark key="'" line="26" column="51" />
        <mark key="[" line="72" column="0" />
        <mark key="]" line="72" column="0" />
        <mark key="." line="72" column="0" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-mapper/src/main/java/com/cainiao/lms/shardingmapper/DingTalkAttendanceStatisticsShardingMapper.java" timestamp="1605600017268">
        <mark key="'" line="31" column="0" />
        <mark key="[" line="87" column="45" />
        <mark key="]" line="87" column="42" />
        <mark key="^" line="87" column="42" />
        <mark key="." line="87" column="41" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/ScPprHandler.java" timestamp="1605663001596">
        <mark key="'" line="272" column="4" />
        <mark key="[" line="283" column="50" />
        <mark key="]" line="284" column="28" />
        <mark key="." line="284" column="27" />
        <mark key="^" line="284" column="28" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/metaq/WmpTaskBatchEndConsumer.java" timestamp="1605606177451">
        <mark key="'" line="129" column="37" />
        <mark key="[" line="129" column="40" />
        <mark key="]" line="129" column="46" />
        <mark key="^" line="129" column="46" />
        <mark key="." line="129" column="45" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/impl/DingTalkAttendanceStatisticsManagerImpl.java" timestamp="1605664748688">
        <mark key="'" line="95" column="75" />
        <mark key="[" line="53" column="40" />
        <mark key="]" line="53" column="48" />
        <mark key="." line="53" column="47" />
        <mark key="^" line="53" column="48" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/config/SpringCacheConfig.java" timestamp="1605528181731">
        <mark key="[" line="29" column="53" />
        <mark key="]" line="29" column="70" />
        <mark key="^" line="29" column="70" />
        <mark key="." line="29" column="69" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-common/src/main/java/com/cainiao/lms/config/SequenceConfig.java" timestamp="1605664678510">
        <mark key="'" line="80" column="5" />
        <mark key="[" line="133" column="39" />
        <mark key="]" line="133" column="39" />
        <mark key="." line="133" column="38" />
        <mark key="^" line="133" column="39" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/HbaseCompletableFuture.java" timestamp="1605595961051">
        <mark key="'" line="15" column="19" />
        <mark key="[" line="10" column="64" />
        <mark key="]" line="10" column="66" />
        <mark key="^" line="10" column="66" />
        <mark key="." line="10" column="65" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractPprHandler.java" timestamp="1605662854088">
        <mark key="[" line="170" column="88" />
        <mark key="]" line="171" column="8" />
        <mark key="." line="171" column="7" />
        <mark key="^" line="171" column="8" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/FetchHbaseTask.java" timestamp="1605596793003">
        <mark key="[" line="12" column="15" />
        <mark key="]" line="12" column="21" />
        <mark key="." line="12" column="20" />
        <mark key="^" line="12" column="21" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-mapper/src/main/java/com/cainiao/lms/provider/DingTalkAttendanceStatisticsShardingProvider.java" timestamp="1605664863254">
        <mark key="[" line="8" column="80" />
        <mark key="]" line="9" column="4" />
        <mark key="^" line="9" column="4" />
        <mark key="." line="9" column="3" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/impl/HBaseServiceImpl.java" timestamp="1605609217901">
        <mark key="[" line="155" column="46" />
        <mark key="]" line="155" column="56" />
        <mark key="." line="155" column="55" />
        <mark key="^" line="155" column="56" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" timestamp="1605664709831">
        <mark key="'" line="815" column="43" />
        <mark key="[" line="815" column="101" />
        <mark key="]" line="816" column="77" />
        <mark key="." line="816" column="76" />
        <mark key="^" line="816" column="77" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-common/src/main/java/com/cainiao/lms/middleware/diamond/SwitchProperty.java" timestamp="1605598481263">
        <mark key="[" line="747" column="41" />
        <mark key="]" line="747" column="41" />
        <mark key="^" line="747" column="41" />
        <mark key="." line="747" column="40" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/indirectlabour/impl/IndirectLabourManagerImpl.java" timestamp="1605664652821">
        <mark key="'" line="263" column="65" />
        <mark key="[" line="52" column="0" />
        <mark key="]" line="52" column="73" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/impl/DingTalkAttendanceStatisticsManagerLzdImpl.java" timestamp="1605599726685">
        <mark key="'" line="292" column="47" />
        <mark key="[" line="60" column="0" />
        <mark key="]" line="60" column="0" />
        <mark key="." line="60" column="0" />
        <mark key="^" line="49" column="70" />
      </file>
      <file name="$USER_HOME$/cainiao/wmplms/wmplms-mapper/src/main/java/com/cainiao/lms/mapper/DingTalkAttendanceStatisticsMapper.java" timestamp="1605600026301">
        <mark key="'" line="34" column="0" />
        <mark key="[" line="36" column="11" />
        <mark key="]" line="36" column="11" />
        <mark key="^" line="36" column="14" />
        <mark key="." line="36" column="11" />
      </file>
      <file name="/fragment.java" timestamp="1605664801679">
        <mark key="[" line="0" column="0" />
      </file>
    </filemarks>
    <jumps>
      <jump line="108" column="20" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/ScPprHandler.java" />
      <jump line="465" column="29" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/ScPprHandler.java" />
      <jump line="79" column="99" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/impl/LabourPprModuleServiceImpl.java" />
      <jump line="917" column="58" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="34" column="59" filename="$USER_HOME$/cainiao/wmplms/wmplms-common/src/main/java/com/cainiao/lms/middleware/tair/KvStoreCacheManager.java" />
      <jump line="316" column="9" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractPprHandler.java" />
      <jump line="49" column="24" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="75" column="24" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="100" column="20" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="778" column="35" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="785" column="22" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="847" column="35" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="857" column="22" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="77" column="8" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="102" column="26" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="107" column="41" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="616" column="32" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="624" column="22" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="777" column="22" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="789" column="22" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="846" column="22" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="861" column="22" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="64" column="26" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="69" column="41" filename="$USER_HOME$/cainiao/wmplms/wmplms-web/src/main/resources/logback-spring.xml" />
      <jump line="82" column="23" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractPprHandler.java" />
      <jump line="148" column="13" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractPprHandler.java" />
      <jump line="182" column="28" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractPprHandler.java" />
      <jump line="62" column="34" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractPprHandler.java" />
      <jump line="180" column="12" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractPprHandler.java" />
      <jump line="678" column="38" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="139" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1297" column="16" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="103" column="33" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1397" column="20" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1417" column="8" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1377" column="48" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1418" column="4" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1419" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1378" column="58" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1386" column="27" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1384" column="49" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1385" column="63" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1383" column="32" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1394" column="25" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1395" column="93" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1429" column="16" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1381" column="31" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="886" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1376" column="16" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="96" column="37" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="142" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1440" column="16" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1390" column="35" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1388" column="29" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1442" column="16" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="140" column="90" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1391" column="30" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="141" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="104" column="4" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1450" column="63" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="24" column="0" filename="$APPLICATION_CONFIG_DIR$/scratches/scratch_20.java" />
      <jump line="17" column="7" filename="$APPLICATION_CONFIG_DIR$/scratches/scratch_20.java" />
      <jump line="27" column="0" filename="$APPLICATION_CONFIG_DIR$/scratches/scratch_20.java" />
      <jump line="672" column="34" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="675" column="12" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="1399" column="45" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="669" column="29" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="653" column="12" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="713" column="8" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="689" column="4" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="687" column="30" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="690" column="4" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="631" column="77" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="223" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-mapper/src/main/java/com/cainiao/lms/mapper/DingTalkAttendanceStatisticsMapper.java" />
      <jump line="100" column="32" filename="$USER_HOME$/cainiao/wmplms/wmplms-mapper/src/main/java/com/cainiao/lms/provider/DingTalkAttendanceStatisticsProvider.java" />
      <jump line="104" column="75" filename="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/impl/DingTalkAttendanceStatisticsManagerImpl.java" />
      <jump line="184" column="42" filename="$USER_HOME$/cainiao/wmplms/wmplms-mapper/src/main/java/com/cainiao/lms/mapper/DingTalkAttendanceStatisticsMapper.java" />
      <jump line="11" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/DingTalkAttendanceStatisticsManager.java" />
      <jump line="26" column="1" filename="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/DingTalkAttendanceStatisticsManager.java" />
      <jump line="148" column="7" filename="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/DingTalkAttendanceStatisticsManager.java" />
      <jump line="155" column="7" filename="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/DingTalkAttendanceStatisticsManager.java" />
      <jump line="198" column="7" filename="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/DingTalkAttendanceStatisticsManager.java" />
      <jump line="152" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-mapper/src/main/java/com/cainiao/lms/mapper/DingTalkAttendanceStatisticsMapper.java" />
      <jump line="31" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-mapper/src/main/java/com/cainiao/lms/shardingmapper/DingTalkAttendanceStatisticsShardingMapper.java" />
      <jump line="263" column="65" filename="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/indirectlabour/impl/IndirectLabourManagerImpl.java" />
      <jump line="113" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/impl/DingTalkAttendanceStatisticsManagerLzdImpl.java" />
      <jump line="222" column="15" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/ScPprHandler.java" />
      <jump line="102" column="46" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/ScPprHandler.java" />
      <jump line="36" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-mapper/src/main/java/com/cainiao/lms/mapper/DingTalkAttendanceStatisticsMapper.java" />
      <jump line="100" column="37" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/ScPprHandler.java" />
      <jump line="26" column="51" filename="$APPLICATION_CONFIG_DIR$/scratches/scratch_20.java" />
      <jump line="17" column="19" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/HbaseCompletableFuture.java" />
      <jump line="115" column="11" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/ScPprHandler.java" />
      <jump line="117" column="15" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/ScPprHandler.java" />
      <jump line="267" column="4" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/ScPprHandler.java" />
      <jump line="292" column="47" filename="$USER_HOME$/cainiao/wmplms/wmplms-manager/src/main/java/com/cainiao/lms/manager/impl/DingTalkAttendanceStatisticsManagerLzdImpl.java" />
      <jump line="129" column="37" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/metaq/WmpTaskBatchEndConsumer.java" />
      <jump line="80" column="5" filename="$USER_HOME$/cainiao/wmplms/wmplms-common/src/main/java/com/cainiao/lms/config/SequenceConfig.java" />
      <jump line="809" column="43" filename="$USER_HOME$/cainiao/wmplms/wmplms-biz/src/main/java/com/cainiao/lms/service/ppr/handler/AbstractBasePprHandler.java" />
      <jump line="46" column="0" filename="$USER_HOME$/cainiao/wmplms/wmplms-mapper/src/main/java/com/cainiao/lms/provider/DingTalkAttendanceStatisticsShardingProvider.java" />
    </jumps>
  </component>
  <component name="VimRegisterSettings">
    <registers>
      <register name="&quot;" type="4">
        <text encoding="base64">CiAgICBwdWJsaWMgU3RyaW5nIHNlbGVjdEJ5SWRzKEBQYXJhbSgiaWRzIikgTGlzdDxMb25nPiBpZHMpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpIHt7CiAgICAgICAgICAgIFNFTEVDVChTRUxFQ1RfQ09MVU1OKTsKICAgICAgICAgICAgRlJPTShUQUJMRV9OQU1FKTsKICAgICAgICAgICAgV0hFUkUoImlkIGluICgiICsgSk9JTkVSLmpvaW4oaWRzKSArICIpIik7CiAgICAgICAgfX07CiAgICAgICAgcmV0dXJuIHNxbC50b1N0cmluZygpOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBJTlNFUlRfU1FMID0KICAgICAgICAiKG5vdygpLG5vdygpLCMneydsaXN0W3swfV0uYXR0ZW5kYW5jZURhdGV9LCMneydsaXN0W3swfV0uYXR0ZW5kYW5jZVN0YXJ0VGltZX0sIyd7J2xpc3RbezB9XSIKICAgICAgICAgICAgKyAiLmF0dGVuZGFuY2VFbmRUaW1lfSwjJ3snbGlzdFt7MH1dLmF0dGVuZGFuY2VFeGNlcHRpb25Db2RlfSwjJ3snbGlzdFt7MH1dLmVmZmljaWVuY3lBdHRlbmRUaW1lfSwiCiAgICAgICAgICAgICsgIiMneydsaXN0W3swfV0uYXR0ZW5kYW5jZUJhc2VUaW1lfSwjJ3snbGlzdFt7MH1dLmF0dGVuZGFuY2VPdmVydGltZX0sIyd7J2xpc3RbezB9XS51c2VySWR9LCIKICAgICAgICAgICAgKyAiIyd7J2xpc3RbezB9XS5lbXBsb3llZUxvZ0lkfSwjJ3snbGlzdFt7MH1dLmVtcGxveWVlQ3VzdG9tQXR0cmlidXRlc30sIyd7J2xpc3RbezB9XS53b3JrTmF0dXJlfSwiCiAgICAgICAgICAgICsgIiMneydsaXN0W3swfV0ud29ya05hdHVyZU5hbWV9LCMneydsaXN0W3swfV0iCiAgICAgICAgICAgICsgIi53b3JrR3JvdXBDb2RlfSwjJ3snbGlzdFt7MH1dLndvcmtHcm91cE5hbWV9LCMneydsaXN0W3swfV0ud29ya1BsYWNlQ29kZX0sIyd7J2xpc3RbezB9XSIKICAgICAgICAgICAgKyAiLndvcmtQbGFjZU5hbWV9LCMneydsaXN0W3swfV0uY3BDb2RlfSwjJ3snbGlzdFt7MH1dLmNwTmFtZX0sIyd7J2xpc3RbezB9XS5yZWdpb25JZH0sIyd7J2xpc3RbezB9XSIKICAgICAgICAgICAgKyAiLnJlZ2lvbk5hbWV9LCMneydsaXN0W3swfV0ubGFib3VyQ29tcGFueUlkfSwjJ3snbGlzdFt7MH1dLmxhYm91ckNvbXBhbnlDb2RlfSwjJ3snbGlzdFt7MH1dIgogICAgICAgICAgICArICIubGFib3VyQ29tcGFueU5hbWV9LCMneydsaXN0W3swfV0uZW1wbG95ZWVOYW1lfSwjJ3snbGlzdFt7MH1dLmNsYXNzU3RhcnRUaW1lfSwjJ3snbGlzdFt7MH1dIgogICAgICAgICAgICArICIuY2xhc3NFbmRUaW1lfSwjJ3snbGlzdFt7MH1dLmNsYXNzUmVzdFN0YXJ0VGltZX0sIyd7J2xpc3RbezB9XS5jbGFzc1Jlc3RFbmRUaW1lfSwjJ3snbGlzdFt7MH1dIgogICAgICAgICAgICArICIuZW1wbG95ZWVOdW1iZXJ9LCMneydsaXN0W3swfV0uc3RhdHVzfSwjJ3snbGlzdFt7MH1dLnN0YXR1c05hbWV9LCMneydsaXN0W3swfV0iCiAgICAgICAgICAgICsgIi5pbmR1c3RyeUNvbGxlY3Rpb259LCMneydsaXN0W3swfV0uaW5kdXN0cnlDb2xsZWN0aW9uTmFtZX0sIyd7J2xpc3RbezB9XS5jbGFzc05hbWV9LCMneydsaXN0W3swfV0iCiAgICAgICAgICAgICsgIi5wb3NpdGlvbn0sIyd7J2xpc3RbezB9XS5wb3NpdGlvbnN9LCMneydsaXN0W3swfV0uYnVzaW5lc3NUeXBlfSwjJ3snbGlzdFt7MH1dIgogICAgICAgICAgICArICIuaXNGb3JFZmZpY2llbmN5QXR0ZW5kVGltZX0sIyd7J2xpc3RbezB9XS5sZWF2ZVRpbWV9LCAjJ3snbGlzdFt7MH1dLnJlc3RUaW1lfSwgIgogICAgICAgICAgICArICIjJ3snbGlzdFt7MH1dLm9yaWdpbmFsQXR0ZW5kYW5jZUV4Y2VwdGlvbkNvZGV9LCAjJ3snbGlzdFt7MH1dLmN1c3RvbUF0dHJpYnV0ZXN9LCAjJ3snbGlzdFt7MH1dIgogICAgICAgICAgICArICIuc291cmNlVHlwZX0pIjsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgVVBEQVRFX1NRTCA9ICJPTiBEVVBMSUNBVEUgS0VZIFVQREFURSBnbXRfbW9kaWZpZWQgPSBub3coKSwiCiAgICAgICAgKyAiYXR0ZW5kYW5jZV9kYXRlPXZhbHVlcyhhdHRlbmRhbmNlX2RhdGUpLCBhdHRlbmRhbmNlX3N0YXJ0X3RpbWU9dmFsdWVzKGF0dGVuZGFuY2Vfc3RhcnRfdGltZSksICIKICAgICAgICArICJhdHRlbmRhbmNlX2VuZF90aW1lPXZhbHVlcyhhdHRlbmRhbmNlX2VuZF90aW1lKSxhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlPWlmKGFwcHJvdmFsX2RhdGUgaXMgbm90ICIKICAgICAgICArICJudWxsLCBhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlLCB2YWx1ZXMoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSkpLCIKICAgICAgICArICJlZmZpY2llbmN5X2F0dGVuZF90aW1lPXZhbHVlcyhlZmZpY2llbmN5X2F0dGVuZF90aW1lKSwiCiAgICAgICAgKyAiYXR0ZW5kYW5jZV9iYXNlX3RpbWU9dmFsdWVzKGF0dGVuZGFuY2VfYmFzZV90aW1lKSxhdHRlbmRhbmNlX292ZXJ0aW1lPXZhbHVlcyhhdHRlbmRhbmNlX292ZXJ0aW1lKSwiCiAgICAgICAgKyAidXNlcl9pZD12YWx1ZXModXNlcl9pZCksZW1wbG95ZWVfbG9nX2lkPXZhbHVlcyhlbXBsb3llZV9sb2dfaWQpLHdvcmtfbmF0dXJlPXZhbHVlcyh3b3JrX25hdHVyZSksICIKICAgICAgICArICJ3b3JrX25hdHVyZV9uYW1lPXZhbHVlcyh3b3JrX25hdHVyZV9uYW1lKSwgd29ya19ncm91cF9jb2RlPXZhbHVlcyh3b3JrX2dyb3VwX2NvZGUpLCAiCiAgICAgICAgKyAid29ya19ncm91cF9uYW1lPXZhbHVlcyh3b3JrX2dyb3VwX25hbWUpLCB3b3JrX3BsYWNlX2NvZGU9dmFsdWVzKHdvcmtfcGxhY2VfY29kZSksICIKICAgICAgICArICJ3b3JrX3BsYWNlX25hbWU9dmFsdWVzKHdvcmtfcGxhY2VfbmFtZSksIGNwX2NvZGU9dmFsdWVzKGNwX2NvZGUpLCBjcF9uYW1lPXZhbHVlcyhjcF9uYW1lKSwgIgogICAgICAgICsgInJlZ2lvbl9pZD12YWx1ZXMocmVnaW9uX2lkKSwgcmVnaW9uX25hbWU9dmFsdWVzKHJlZ2lvbl9uYW1lKSwgbGFib3VyX2NvbXBhbnlfaWQ9dmFsdWVzIgogICAgICAgICsgIihsYWJvdXJfY29tcGFueV9pZCksIGxhYm91cl9jb21wYW55X2NvZGU9dmFsdWVzKGxhYm91cl9jb21wYW55X2NvZGUpLCBsYWJvdXJfY29tcGFueV9uYW1lPXZhbHVlcyIKICAgICAgICArICIobGFib3VyX2NvbXBhbnlfbmFtZSksIGVtcGxveWVlX25hbWU9dmFsdWVzKGVtcGxveWVlX25hbWUpLCBjbGFzc19zdGFydF90aW1lPXZhbHVlcyhjbGFzc19zdGFydF90aW1lKSwiCiAgICAgICAgKyAiIGNsYXNzX2VuZF90aW1lPXZhbHVlcyhjbGFzc19lbmRfdGltZSksIGNsYXNzX3Jlc3Rfc3RhcnRfdGltZT12YWx1ZXMoY2xhc3NfcmVzdF9zdGFydF90aW1lKSwgIgogICAgICAgICsgImNsYXNzX3Jlc3RfZW5kX3RpbWU9dmFsdWVzKGNsYXNzX3Jlc3RfZW5kX3RpbWUpLCBlbXBsb3llZV9udW1iZXI9dmFsdWVzKGVtcGxveWVlX251bWJlciksc3RhdHVzPXZhbHVlcyIKICAgICAgICArICIoc3RhdHVzKSwgc3RhdHVzX25hbWU9dmFsdWVzKHN0YXR1c19uYW1lKSwgY2xhc3NfbmFtZT12YWx1ZXMoY2xhc3NfbmFtZSksIHBvc2l0aW9uPXZhbHVlcyhwb3NpdGlvbiksICIKICAgICAgICArICJwb3NpdGlvbnM9dmFsdWVzKHBvc2l0aW9ucyksYnVzaW5lc3NfdHlwZT12YWx1ZXMoYnVzaW5lc3NfdHlwZSksaXNfZm9yX2VmZmljaWVuY3lfYXR0ZW5kX3RpbWU9dmFsdWVzIgogICAgICAgICsgIihpc19mb3JfZWZmaWNpZW5jeV9hdHRlbmRfdGltZSksbGVhdmVfdGltZT12YWx1ZXMobGVhdmVfdGltZSksIHJlc3RfdGltZT12YWx1ZXMocmVzdF90aW1lKSwgIgogICAgICAgICsgImVtcGxveWVlX2N1c3RvbV9hdHRyaWJ1dGVzPXZhbHVlcyhlbXBsb3llZV9jdXN0b21fYXR0cmlidXRlcyksICIKICAgICAgICArICJpbmR1c3RyeV9jb2xsZWN0aW9uPXZhbHVlcyhpbmR1c3RyeV9jb2xsZWN0aW9uKSwgaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lPXZhbHVlcyIKICAgICAgICArICIoaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lKSwgb3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZT12YWx1ZXMiCiAgICAgICAgKyAiKG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUpLCAiCiAgICAgICAgKyAiY3VzdG9tX2F0dHJpYnV0ZXM9dmFsdWVzKGN1c3RvbV9hdHRyaWJ1dGVzKSwgc291cmNlX3R5cGU9dmFsdWVzKHNvdXJjZV90eXBlKSI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFVQREFURV9TUUxfV0lUSE9VVF9BVFRFTkRBTkNFX1RJTUUgPSAiT04gRFVQTElDQVRFIEtFWSBVUERBVEUgZ210X21vZGlmaWVkID0gbm93KCksIgogICAgICAgICsgImF0dGVuZGFuY2VfZGF0ZT12YWx1ZXMoYXR0ZW5kYW5jZV9kYXRlKSwgYXR0ZW5kYW5jZV9zdGFydF90aW1lPXZhbHVlcyhhdHRlbmRhbmNlX3N0YXJ0X3RpbWUpLCAiCiAgICAgICAgKyAiYXR0ZW5kYW5jZV9lbmRfdGltZT12YWx1ZXMoYXR0ZW5kYW5jZV9lbmRfdGltZSksYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZT1pZihhcHByb3ZhbF9kYXRlIGlzIG5vdCAiCiAgICAgICAgKyAibnVsbCwgYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSwgdmFsdWVzKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUpKSwiCiAgICAgICAgKyAiYXR0ZW5kYW5jZV9iYXNlX3RpbWU9dmFsdWVzKGF0dGVuZGFuY2VfYmFzZV90aW1lKSxhdHRlbmRhbmNlX292ZXJ0aW1lPXZhbHVlcyhhdHRlbmRhbmNlX292ZXJ0aW1lKSwiCiAgICAgICAgKyAidXNlcl9pZD12YWx1ZXModXNlcl9pZCksZW1wbG95ZWVfbG9nX2lkPXZhbHVlcyhlbXBsb3llZV9sb2dfaWQpLHdvcmtfbmF0dXJlPXZhbHVlcyh3b3JrX25hdHVyZSksICIKICAgICAgICArICJ3b3JrX25hdHVyZV9uYW1lPXZhbHVlcyh3b3JrX25hdHVyZV9uYW1lKSwgd29ya19ncm91cF9jb2RlPXZhbHVlcyh3b3JrX2dyb3VwX2NvZGUpLCAiCiAgICAgICAgKyAid29ya19ncm91cF9uYW1lPXZhbHVlcyh3b3JrX2dyb3VwX25hbWUpLCB3b3JrX3BsYWNlX2NvZGU9dmFsdWVzKHdvcmtfcGxhY2VfY29kZSksICIKICAgICAgICArICJ3b3JrX3BsYWNlX25hbWU9dmFsdWVzKHdvcmtfcGxhY2VfbmFtZSksIGNwX2NvZGU9dmFsdWVzKGNwX2NvZGUpLCBjcF9uYW1lPXZhbHVlcyhjcF9uYW1lKSwgIgogICAgICAgICsgInJlZ2lvbl9pZD12YWx1ZXMocmVnaW9uX2lkKSwgcmVnaW9uX25hbWU9dmFsdWVzKHJlZ2lvbl9uYW1lKSwgbGFib3VyX2NvbXBhbnlfaWQ9dmFsdWVzIgogICAgICAgICsgIihsYWJvdXJfY29tcGFueV9pZCksIGxhYm91cl9jb21wYW55X2NvZGU9dmFsdWVzKGxhYm91cl9jb21wYW55X2NvZGUpLCBsYWJvdXJfY29tcGFueV9uYW1lPXZhbHVlcyIKICAgICAgICArICIobGFib3VyX2NvbXBhbnlfbmFtZSksIGVtcGxveWVlX25hbWU9dmFsdWVzKGVtcGxveWVlX25hbWUpLCBjbGFzc19zdGFydF90aW1lPXZhbHVlcyhjbGFzc19zdGFydF90aW1lKSwiCiAgICAgICAgKyAiIGNsYXNzX2VuZF90aW1lPXZhbHVlcyhjbGFzc19lbmRfdGltZSksIGNsYXNzX3Jlc3Rfc3RhcnRfdGltZT12YWx1ZXMoY2xhc3NfcmVzdF9zdGFydF90aW1lKSwgIgogICAgICAgICsgImNsYXNzX3Jlc3RfZW5kX3RpbWU9dmFsdWVzKGNsYXNzX3Jlc3RfZW5kX3RpbWUpLCBlbXBsb3llZV9udW1iZXI9dmFsdWVzKGVtcGxveWVlX251bWJlciksc3RhdHVzPXZhbHVlcyIKICAgICAgICArICIoc3RhdHVzKSwgc3RhdHVzX25hbWU9dmFsdWVzKHN0YXR1c19uYW1lKSwgY2xhc3NfbmFtZT12YWx1ZXMoY2xhc3NfbmFtZSksIHBvc2l0aW9uPXZhbHVlcyhwb3NpdGlvbiksICIKICAgICAgICArICJwb3NpdGlvbnM9dmFsdWVzKHBvc2l0aW9ucyksYnVzaW5lc3NfdHlwZT12YWx1ZXMoYnVzaW5lc3NfdHlwZSksaXNfZm9yX2VmZmljaWVuY3lfYXR0ZW5kX3RpbWU9dmFsdWVzIgogICAgICAgICsgIihpc19mb3JfZWZmaWNpZW5jeV9hdHRlbmRfdGltZSksbGVhdmVfdGltZT12YWx1ZXMobGVhdmVfdGltZSksIHJlc3RfdGltZT12YWx1ZXMocmVzdF90aW1lKSwgIgogICAgICAgICsgImVtcGxveWVlX2N1c3RvbV9hdHRyaWJ1dGVzPXZhbHVlcyhlbXBsb3llZV9jdXN0b21fYXR0cmlidXRlcyksICIKICAgICAgICArICJpbmR1c3RyeV9jb2xsZWN0aW9uPXZhbHVlcyhpbmR1c3RyeV9jb2xsZWN0aW9uKSwgaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lPXZhbHVlcyIKICAgICAgICArICIoaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lKSwgb3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZT12YWx1ZXMiCiAgICAgICAgKyAiKG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUpLCAiCiAgICAgICAgKyAiY3VzdG9tX2F0dHJpYnV0ZXM9dmFsdWVzKGN1c3RvbV9hdHRyaWJ1dGVzKSwgc291cmNlX3R5cGU9dmFsdWVzKHNvdXJjZV90eXBlKSI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFVQREFURV9TUUxfT05MWV9CQVNFX0lORk8gPSAiT04gRFVQTElDQVRFIEtFWSBVUERBVEUgZ210X21vZGlmaWVkID0gbm93KCksIgogICAgICAgICsgImF0dGVuZGFuY2VfZGF0ZT12YWx1ZXMoYXR0ZW5kYW5jZV9kYXRlKSwiCiAgICAgICAgKyAidXNlcl9pZD12YWx1ZXModXNlcl9pZCksZW1wbG95ZWVfbG9nX2lkPXZhbHVlcyhlbXBsb3llZV9sb2dfaWQpLHdvcmtfbmF0dXJlPXZhbHVlcyh3b3JrX25hdHVyZSksICIKICAgICAgICArICJ3b3JrX25hdHVyZV9uYW1lPXZhbHVlcyh3b3JrX25hdHVyZV9uYW1lKSwgd29ya19ncm91cF9jb2RlPXZhbHVlcyh3b3JrX2dyb3VwX2NvZGUpLCAiCiAgICAgICAgKyAiZWZmaWNpZW5jeV9hdHRlbmRfdGltZT12YWx1ZXMoZWZmaWNpZW5jeV9hdHRlbmRfdGltZSksIgogICAgICAgICsgIndvcmtfZ3JvdXBfbmFtZT12YWx1ZXMod29ya19ncm91cF9uYW1lKSwgd29ya19wbGFjZV9jb2RlPXZhbHVlcyh3b3JrX3BsYWNlX2NvZGUpLCAiCiAgICAgICAgKyAid29ya19wbGFjZV9uYW1lPXZhbHVlcyh3b3JrX3BsYWNlX25hbWUpLCBjcF9jb2RlPXZhbHVlcyhjcF9jb2RlKSwgY3BfbmFtZT12YWx1ZXMoY3BfbmFtZSksICIKICAgICAgICArICJyZWdpb25faWQ9dmFsdWVzKHJlZ2lvbl9pZCksIHJlZ2lvbl9uYW1lPXZhbHVlcyhyZWdpb25fbmFtZSksIGxhYm91cl9jb21wYW55X2lkPXZhbHVlcyIKICAgICAgICArICIobGFib3VyX2NvbXBhbnlfaWQpLCBsYWJvdXJfY29tcGFueV9jb2RlPXZhbHVlcyhsYWJvdXJfY29tcGFueV9jb2RlKSwgbGFib3VyX2NvbXBhbnlfbmFtZT12YWx1ZXMiCiAgICAgICAgKyAiKGxhYm91cl9jb21wYW55X25hbWUpLCBlbXBsb3llZV9uYW1lPXZhbHVlcyhlbXBsb3llZV9uYW1lKSwgZW1wbG95ZWVfbnVtYmVyPXZhbHVlcyhlbXBsb3llZV9udW1iZXIpLCIKICAgICAgICArICJzdGF0dXM9dmFsdWVzIgogICAgICAgICsgIihzdGF0dXMpLCBzdGF0dXNfbmFtZT12YWx1ZXMoc3RhdHVzX25hbWUpLCBwb3NpdGlvbj12YWx1ZXMocG9zaXRpb24pLCAiCiAgICAgICAgKyAicG9zaXRpb25zPXZhbHVlcyhwb3NpdGlvbnMpLGJ1c2luZXNzX3R5cGU9dmFsdWVzKGJ1c2luZXNzX3R5cGUpLGlzX2Zvcl9lZmZpY2llbmN5X2F0dGVuZF90aW1lPXZhbHVlcyIKICAgICAgICArICIoaXNfZm9yX2VmZmljaWVuY3lfYXR0ZW5kX3RpbWUpLCIKICAgICAgICArICJpbmR1c3RyeV9jb2xsZWN0aW9uPXZhbHVlcyhpbmR1c3RyeV9jb2xsZWN0aW9uKSwgaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lPXZhbHVlcyhpbmR1c3RyeV9jb2xsZWN0aW9uX25hbWUpLCIKICAgICAgICArICJzb3VyY2VfdHlwZT12YWx1ZXMoc291cmNlX3R5cGUpIjsKCiAgICBwdWJsaWMgU3RyaW5nIGJhdGNoSW5zZXJ0T3JVcGRhdGVXaXRob3V0QXR0ZW5kYW5jZVRpbWUoTWFwIG1hcCkgewogICAgICAgIExpc3Q8RGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc0RPPiBkaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE9zCiAgICAgICAgICAgID0gKExpc3Q8RGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc0RPPiltYXAuZ2V0KCJsaXN0Iik7CgogICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAgIHNiLmFwcGVuZCgiSU5TRVJUIElOVE8gIikuYXBwZW5kKFRBQkxFX05BTUUpLmFwcGVuZCgiKCIgKyBJTlNFUlRfQ09MVU1OICsgIikiKS5hcHBlbmQoIiBWQUxVRVMgIik7CiAgICAgICAgTWVzc2FnZUZvcm1hdCBtZiA9IG5ldyBNZXNzYWdlRm9ybWF0KAogICAgICAgICAgICBJTlNFUlRfU1FMKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGRpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NET3Muc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgc2IuYXBwZW5kKG1mLmZvcm1hdChuZXcgT2JqZWN0W10ge2kgKyAiIn0pKTsKICAgICAgICAgICAgaWYgKGkgPCBkaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE9zLnNpemUoKSAtIDEpIHsKICAgICAgICAgICAgICAgIHNiLmFwcGVuZCgiLCIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNiLmFwcGVuZChVUERBVEVfU1FMX1dJVEhPVVRfQVRURU5EQU5DRV9USU1FKTsKCiAgICAgICAgcmV0dXJuIHNiLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBiYXRjaEluc2VydE9yVXBkYXRlKE1hcCBtYXApIHsKICAgICAgICBMaXN0PERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NETz4gZGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc0RPcwogICAgICAgICAgICA9IChMaXN0PERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NETz4pbWFwLmdldCgibGlzdCIpOwoKICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBzYi5hcHBlbmQoIklOU0VSVCBJTlRPICIpLmFwcGVuZChUQUJMRV9OQU1FKS5hcHBlbmQoIigiICsgSU5TRVJUX0NPTFVNTiArICIpIikuYXBwZW5kKCIgVkFMVUVTICIpOwogICAgICAgIE1lc3NhZ2VGb3JtYXQgbWYgPSBuZXcgTWVzc2FnZUZvcm1hdCgKICAgICAgICAgICAgSU5TRVJUX1NRTCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBkaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE9zLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIHNiLmFwcGVuZChtZi5mb3JtYXQobmV3IE9iamVjdFtdIHtpICsgIiJ9KSk7CiAgICAgICAgICAgIGlmIChpIDwgZGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc0RPcy5zaXplKCkgLSAxKSB7CiAgICAgICAgICAgICAgICBzYi5hcHBlbmQoIiwiKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzYi5hcHBlbmQoVVBEQVRFX1NRTCk7CgogICAgICAgIHJldHVybiBzYi50b1N0cmluZygpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgYmF0Y2hJbnNlcnRPclVwZGF0ZU9ubHlCYXNlSW5mbyhNYXAgbWFwKSB7CiAgICAgICAgTGlzdDxEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE8+IGRpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NET3MKICAgICAgICAgICAgPSAoTGlzdDxEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE8+KW1hcC5nZXQoImxpc3QiKTsKCiAgICAgICAgU3RyaW5nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgc2IuYXBwZW5kKCJJTlNFUlQgSU5UTyAiKS5hcHBlbmQoVEFCTEVfTkFNRSkuYXBwZW5kKCIoIiArIElOU0VSVF9DT0xVTU4gKyAiKSIpLmFwcGVuZCgiIFZBTFVFUyAiKTsKICAgICAgICBNZXNzYWdlRm9ybWF0IG1mID0gbmV3IE1lc3NhZ2VGb3JtYXQoSU5TRVJUX1NRTCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBkaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE9zLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIHNiLmFwcGVuZChtZi5mb3JtYXQobmV3IE9iamVjdFtdIHtpICsgIiJ9KSk7CiAgICAgICAgICAgIGlmIChpIDwgZGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc0RPcy5zaXplKCkgLSAxKSB7CiAgICAgICAgICAgICAgICBzYi5hcHBlbmQoIiwiKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzYi5hcHBlbmQoVVBEQVRFX1NRTF9PTkxZX0JBU0VfSU5GTyk7CgogICAgICAgIHJldHVybiBzYi50b1N0cmluZygpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZGVsZXRlQnlVc2VySWRzQW5kV29ya0RhdGUoQFBhcmFtKCJ1c2VySWRzIikgTGlzdDxTdHJpbmc+IHVzZXJJZHMsIEBQYXJhbSgid29ya0RhdGUiKSBEYXRlIHdvcmtEYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oIndvcmtwbGFjZUNvZGUiKSBTdHJpbmcgd29ya3BsYWNlQ29kZSkgewogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCkge3sKICAgICAgICAgICAgREVMRVRFX0ZST00oVEFCTEVfTkFNRSk7CiAgICAgICAgICAgIFdIRVJFKCJhdHRlbmRhbmNlX2RhdGU9JyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihEQVRFX0ZPUk1BVF9ZWVlZTU1ERCwgd29ya0RhdGUpICsgIiciKTsKICAgICAgICAgICAgV0hFUkUoIndvcmtfcGxhY2VfY29kZSA9ICciICsgd29ya3BsYWNlQ29kZSArICInIik7CiAgICAgICAgICAgIFdIRVJFKCJ1c2VyX2lkIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZSh1c2VySWRzKSk7CiAgICAgICAgfX07CiAgICAgICAgcmV0dXJuIHNxbC50b1N0cmluZygpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZGVsZXRlQnlEaW5nVXNlcklkc0FuZEF0dGVuZGFuY2VEYXRlcyhAUGFyYW0oIndvcmtwbGFjZUNvZGUiKSBTdHJpbmcgd29ya3BsYWNlQ29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oImRpbmdVc2VySWRzIikgTGlzdDxTdHJpbmc+IGRpbmdVc2VySWRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgiYXR0ZW5kYW5jZURhdGVzIikgTGlzdDxMb2NhbERhdGU+IGF0dGVuZGFuY2VEYXRlcykgewogICAgICAgIExpc3Q8U3RyaW5nPiBhdHRlbmRhbmNlRGF0ZVN0cnMgPSBhdHRlbmRhbmNlRGF0ZXMuc3RyZWFtKCkKICAgICAgICAgICAgLm1hcChMb2NhbERhdGVVdGlsOjpmb3JtYXREYXRlKQogICAgICAgICAgICAuY29sbGVjdChDb2xsZWN0b3JzLnRvTGlzdCgpKTsKCiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKSB7ewogICAgICAgICAgICBERUxFVEVfRlJPTShUQUJMRV9OQU1FKTsKICAgICAgICAgICAgV0hFUkUoIndvcmtfcGxhY2VfY29kZSA9ICN7d29ya3BsYWNlQ29kZX0iKTsKICAgICAgICAgICAgV0hFUkUoImF0dGVuZGFuY2VfZGF0ZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUoYXR0ZW5kYW5jZURhdGVTdHJzKSk7CiAgICAgICAgICAgIFdIRVJFKCJ1c2VyX2lkIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZShkaW5nVXNlcklkcykpOwogICAgICAgIH19OwogICAgICAgIHJldHVybiBzcWwudG9TdHJpbmcoKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGNvdW50SW5kaXZpZHVhbEF0dGVuZGFuY2VTdGF0aXN0aWNzKEluZGl2aWR1YWxEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzUXVlcnkgcXVlcnkpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpOwoKICAgICAgICBzcWwuU0VMRUNUKCJDT1VOVChESVNUSU5DVChlbXBsb3llZV9udW1iZXIpKSIpOwogICAgICAgIHNxbC5GUk9NKEFEQl9UQUJMRV9OQU1FKTsKCiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPj0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlU3RhcnREYXRlKCkpICsgIiciKTsKICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2VfZGF0ZSA8PSAnIiArIERhdGVVdGlsLmdldERhdGUyU3RyKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmREYXRlKCkpICsgIiciKTsKCiAgICAgICAgaWYgKG51bGwgIT0gcXVlcnkuZ2V0UmVnaW9uSWQoKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoInJlZ2lvbl9pZCA9ICIgKyBxdWVyeS5nZXRSZWdpb25JZCgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0V29ya1BsYWNlQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAobnVsbCAhPSBxdWVyeS5nZXRMYWJvdXJDb21wYW55SWQoKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkID0gIiArIHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZCgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtHcm91cENvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX2dyb3VwX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0V29ya0dyb3VwQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXRFbXBsb3llZU5hbWUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJlbXBsb3llZV9uYW1lID0gI3tlbXBsb3llZU5hbWV9Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXRFbXBsb3llZU51bWJlcigpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImVtcGxveWVlX251bWJlciA9ICN7ZW1wbG95ZWVOdW1iZXJ9Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0V29ya3BsYWNlQ29kZXMoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgaW4gIiArIGNvbW1hSm9pblN0cmluZ1ZhbHVlKHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgibGFib3VyX2NvbXBhbnlfaWQgaW4gIiArIGNvbW1hSm9pbkludFZhbHVlKHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpOwogICAgICAgIH0KICAgICAgICBTdHJpbmcgcmF3U3FsID0gc3FsLnRvU3RyaW5nKCk7CiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLnJlcGxhY2UoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChyYXdTcWwpLCAiXFwiLCAiIik7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBsaXN0SW5kaXZpZHVhbERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY0J5TGltaXQoSW5kaXZpZHVhbERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NRdWVyeSBxdWVyeSkgewogICAgICAgIHF1ZXJ5LnNldFF1ZXJ5RnJvbUFuZExpbWl0KCk7CgogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCk7CgogICAgICAgIHNxbC5TRUxFQ1QoCiAgICAgICAgICAgICJkaXN0aW5jdChlbXBsb3llZV9sb2dfaWQpIGFzIGVtcGxveWVlTG9nSWQiKTsKCiAgICAgICAgc3FsLkZST00oVEFCTEVfTkFNRSk7CgogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlID49ICciICsgRGF0ZVV0aWwuZ2V0RGF0ZTJTdHIocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0RGF0ZSgpKSArICInIik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlRW5kRGF0ZSgpKSArICInIik7CgogICAgICAgIGlmIChudWxsICE9IHF1ZXJ5LmdldFJlZ2lvbklkKCkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJyZWdpb25faWQgPSAiICsgcXVlcnkuZ2V0UmVnaW9uSWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrUGxhY2VDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG51bGwgIT0gcXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkKCkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJsYWJvdXJfY29tcGFueV9pZCA9ICIgKyBxdWVyeS5nZXRMYWJvdXJDb21wYW55SWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrR3JvdXBDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19ncm91cF9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtHcm91cENvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0RW1wbG95ZWVOYW1lKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbmFtZSA9ICN7ZW1wbG95ZWVOYW1lfSIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0RW1wbG95ZWVOdW1iZXIoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJlbXBsb3llZV9udW1iZXIgPSAje2VtcGxveWVlTnVtYmVyfSIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZShxdWVyeS5nZXRXb3JrcGxhY2VDb2RlcygpKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKTsKICAgICAgICB9CgogICAgICAgIHNxbC5HUk9VUF9CWShTZWN1cml0eVV0aWwuZXNjYXBlU3FsKFN0cmluZy5qb2luKCIsIiwgcXVlcnkuZ2V0RGltZW5zaW9uKCkpKSk7CgogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgIiArIHF1ZXJ5LmdldFF1ZXJ5RnJvbSgpICsgIiwiICsgcXVlcnkuZ2V0UXVlcnlMaW1pdCgpOwogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5yZXBsYWNlKFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocmF3U3FsKSwgIlxcIiwgIiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgbGlzdEluZGl2aWR1YWxEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWMoSW5kaXZpZHVhbERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NRdWVyeSBxdWVyeSkgewogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCk7CgogICAgICAgIHNxbC5TRUxFQ1QoCiAgICAgICAgICAgICJlbXBsb3llZV9sb2dfaWQgYXMgZW1wbG95ZWVMb2dJZCwgZW1wbG95ZWVfY3VzdG9tX2F0dHJpYnV0ZXMsIHJlZ2lvbl9uYW1lIGFzIHJlZ2lvbk5hbWUsIHdvcmtfcGxhY2VfY29kZSIKICAgICAgICAgICAgICAgICsgIiBhcyB3b3JrcGxhY2VDb2RlLCAiCiAgICAgICAgICAgICAgICArICJ3b3JrX3BsYWNlX25hbWUgYXMgd29ya1BsYWNlTmFtZSwgZW1wbG95ZWVfbmFtZSBhcyBlbXBsb3llZU5hbWUsIHdvcmtfbmF0dXJlX25hbWUgYXMgIgogICAgICAgICAgICAgICAgKyAid29ya05hdHVyZU5hbWUsIGVtcGxveWVlX251bWJlciBhcyBlbXBsb3llZU51bWJlciwgIgogICAgICAgICAgICAgICAgKyAiY291bnQoYXR0ZW5kYW5jZV9kYXRlKSBhcyBhdHRlbmRhbmNlRGF5cywgc3VtKGVmZmljaWVuY3lfYXR0ZW5kX3RpbWUpIGFzIGVmZmljaWVuY3lUaW1lLCIKICAgICAgICAgICAgICAgICsgInN1bShyZXN0X3RpbWUpIGFzIHJlc3RUaW1lLCBzdW0oYXR0ZW5kYW5jZV9iYXNlX3RpbWUpIGFzIGF0dGVuZGFuY2VCYXNlVGltZSwgIgogICAgICAgICAgICAgICAgKyAic3VtKGZsb29yKGF0dGVuZGFuY2Vfb3ZlcnRpbWUvMzYwMC4wKStjYXNlIHdoZW4gYXR0ZW5kYW5jZV9vdmVydGltZS8zNjAwLjAtZmxvb3IiCiAgICAgICAgICAgICAgICArICIoYXR0ZW5kYW5jZV9vdmVydGltZS8zNjAwLjApPj0wLjUgdGhlbiAwLjUgZWxzZSAwIGVuZCkgYXMgYXR0ZW5kYW5jZU92ZXJ0aW1lLCAiCiAgICAgICAgICAgICAgICArICJjb3VudChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJyxpZCxudWxsKSkgYXMgYWJzZW50ZWVpc21EYXlzLCAiCiAgICAgICAgICAgICAgICArICJjb3VudChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ01JU1NfQVRURU5EQU5DRScsaWQsbnVsbCkpIGFzIG1pc3NBdHRlbmRhbmNlRGF5cywgIgogICAgICAgICAgICAgICAgKyAiY291bnQoaWYoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdNSVNTX0lOX09VVF9BVFRFTkRBTkNFJywgaWQsIG51bGwpKSBhcyAiCiAgICAgICAgICAgICAgICArICJtaXNzSW5PdXRBdHRlbmRhbmNlRGF5cywgIgogICAgICAgICAgICAgICAgKyAiY291bnQoaWYoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdPVkVSX0FUVEVOREFOQ0UnLGlkLG51bGwpKSBhcyBvdmVyQXR0ZW5kYW5jZURheXMsICIKICAgICAgICAgICAgICAgICsgImNvdW50KGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnTEFURV9BUlJJVkVEX0FUVEVOREFOQ0UnLGlkLG51bGwpKSBhcyAiCiAgICAgICAgICAgICAgICArICJsYXRlQXJyaXZlZEF0dGVuZGFuY2VEYXlzLCAiCiAgICAgICAgICAgICAgICArICJjb3VudChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0VBUkxZX0xFRlRfQVRURU5EQU5DRScsaWQsbnVsbCkpIGFzIGVhcmx5TGVmdEF0dGVuZGFuY2VEYXlzLCIKICAgICAgICAgICAgICAgICsgImNvdW50KGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnTEFURV9BUlJJVkVEX0VBUkxZX0xFRlRfQVRURU5EQU5DRScsaWQsbnVsbCkpIGFzICIKICAgICAgICAgICAgICAgICsgImxhdGVBcnJpdmVkRWFybHlMZWZ0QXR0ZW5kYW5jZURheXMsICIKICAgICAgICAgICAgICAgICsgInN1bShpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJyxlZmZpY2llbmN5X2F0dGVuZF90aW1lLDApKSBhcyBhYnNlbnRlZWlzbVRpbWUsICIKICAgICAgICAgICAgICAgICsgInN1bShpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ01JU1NfQVRURU5EQU5DRScsZWZmaWNpZW5jeV9hdHRlbmRfdGltZSwwKSkgYXMgIgogICAgICAgICAgICAgICAgKyAibWlzc0F0dGVuZGFuY2VUaW1lLCBzdW0oaWYoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdPVkVSX0FUVEVOREFOQ0UnLGVmZmljaWVuY3lfYXR0ZW5kX3RpbWUsMCkiCiAgICAgICAgICAgICAgICArICIpIGFzIG92ZXJBdHRlbmRhbmNlVGltZSwgY291bnQoaWYobGVhdmVfdGltZSBpcyBub3QgbnVsbCxpZCxudWxsKSkgYXMgbGVhdmVEYXlzLCBzdW0obGVhdmVfdGltZSkgIgogICAgICAgICAgICAgICAgKyAiYXMgbGVhdmVUaW1lIik7CgogICAgICAgIHNxbC5GUk9NKEFEQl9UQUJMRV9OQU1FKTsKCiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPj0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlU3RhcnREYXRlKCkpICsgIiciKTsKICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2VfZGF0ZSA8PSAnIiArIERhdGVVdGlsLmdldERhdGUyU3RyKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmREYXRlKCkpICsgIiciKTsKCiAgICAgICAgaWYgKG51bGwgIT0gcXVlcnkuZ2V0UmVnaW9uSWQoKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoInJlZ2lvbl9pZCA9ICIgKyBxdWVyeS5nZXRSZWdpb25JZCgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0V29ya1BsYWNlQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAobnVsbCAhPSBxdWVyeS5nZXRMYWJvdXJDb21wYW55SWQoKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkID0gIiArIHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZCgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtHcm91cENvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX2dyb3VwX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0V29ya0dyb3VwQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXRFbXBsb3llZU5hbWUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJlbXBsb3llZV9uYW1lID0gI3tlbXBsb3llZU5hbWV9Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXRFbXBsb3llZU51bWJlcigpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImVtcGxveWVlX251bWJlciA9ICN7ZW1wbG95ZWVOdW1iZXJ9Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0V29ya3BsYWNlQ29kZXMoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgaW4gIiArIGNvbW1hSm9pblN0cmluZ1ZhbHVlKHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgibGFib3VyX2NvbXBhbnlfaWQgaW4gIiArIGNvbW1hSm9pbkludFZhbHVlKHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldEVtcGxveWVlTG9nSWRzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbG9nX2lkIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShxdWVyeS5nZXRFbXBsb3llZUxvZ0lkcygpKSk7CiAgICAgICAgfQoKICAgICAgICBzcWwuR1JPVVBfQlkoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChTdHJpbmcuam9pbigiLCIsIHF1ZXJ5LmdldERpbWVuc2lvbigpKSkpOwoKICAgICAgICBTdHJpbmcgcmF3U3FsID0gc3FsLnRvU3RyaW5nKCk7CiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLnJlcGxhY2UoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChyYXdTcWwpLCAiXFwiLCAiIik7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRJbmRpdmlkdWFsRGFpbHlBdHRlbmRhbmNlKEBQYXJhbSgiZW1wbG95ZWVMb2dJZCIpIExvbmcgZW1wbG95ZWVMb2dJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oInF1ZXJ5IikgSW5kaXZpZHVhbERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NRdWVyeSBxdWVyeSkgewogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCk7CiAgICAgICAgc3FsLlNFTEVDVChTRUxFQ1RfQ09MVU1OKTsKICAgICAgICBzcWwuRlJPTShBREJfVEFCTEVfTkFNRSk7CgogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlID49ICciICsgRGF0ZVV0aWwuZ2V0RGF0ZTJTdHIocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0RGF0ZSgpKSArICInIik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlRW5kRGF0ZSgpKSArICInIik7CgogICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbG9nX2lkID0gIiArIGVtcGxveWVlTG9nSWQpOwogICAgICAgIGlmIChudWxsICE9IHF1ZXJ5LmdldFJlZ2lvbklkKCkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJyZWdpb25faWQgPSAiICsgcXVlcnkuZ2V0UmVnaW9uSWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrUGxhY2VDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG51bGwgIT0gcXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkKCkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJsYWJvdXJfY29tcGFueV9pZCA9ICIgKyBxdWVyeS5nZXRMYWJvdXJDb21wYW55SWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrR3JvdXBDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19ncm91cF9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtHcm91cENvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlIGluICIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKGNvbW1hSm9pblN0cmluZ1ZhbHVlKHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkIGluICIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKGNvbW1hSm9pbkludFZhbHVlKHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpKTsKICAgICAgICB9CgogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKTsKICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMucmVwbGFjZShTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHJhd1NxbCksICJcXCIsICIiKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGNvdW50RW50aXJlQXR0ZW5kYW5jZVN0YXRpc3RpY3MoRW50aXJlRGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc1F1ZXJ5IHF1ZXJ5KSB7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKTsKCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkocXVlcnkuZ2V0RGltZW5zaW9uKCkpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBXbXBMbXNFeGNlcHRpb24oQmFzaWMuUEFSQU1fTlVMTCk7CiAgICAgICAgfQoKICAgICAgICBzcWwuU0VMRUNUKCJDT1VOVChESVNUSU5DVCgiICsgU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChxdWVyeS5nZXREaW1lbnNpb24oKSkgKyAiKSkiKTsKICAgICAgICBzcWwuRlJPTShBREJfVEFCTEVfTkFNRSk7CgogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlID49ICciICsgRGF0ZVV0aWwuZ2V0RGF0ZTJTdHIocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0RGF0ZSgpKSArICInIik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlRW5kRGF0ZSgpKSArICInIik7CgogICAgICAgIGlmIChudWxsICE9IHF1ZXJ5LmdldFJlZ2lvbklkKCkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJyZWdpb25faWQgPSAiICsgcXVlcnkuZ2V0UmVnaW9uSWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrUGxhY2VDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0Q3BDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiY3BfY29kZSA9ICciICsgU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChxdWVyeS5nZXRDcENvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZShxdWVyeS5nZXRXb3JrcGxhY2VDb2RlcygpKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKTsKICAgICAgICB9CgogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKTsKICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMucmVwbGFjZShTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHJhd1NxbCksICJcXCIsICIiKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGxpc3RFbnRpcmVEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWMoRW50aXJlRGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc1F1ZXJ5IHF1ZXJ5KSB7CiAgICAgICAgcXVlcnkuc2V0UXVlcnlGcm9tQW5kTGltaXQoKTsKCiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKTsKICAgICAgICBTdHJpbmcgZGltZW5zaW9uID0gcXVlcnkuZ2V0RGltZW5zaW9uKCk7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsoZGltZW5zaW9uKSkgewogICAgICAgICAgICAvLyDlt6XkvZzngrnnu7TluqbkvJrmnInlpJrkuKrlsZXnpLrkv6Hmga8KICAgICAgICAgICAgaWYgKE9iamVjdHMuZXF1YWxzKGRpbWVuc2lvbiwgV09SS19QTEFDRV9DT0RFKSkgewogICAgICAgICAgICAgICAgc3FsLlNFTEVDVCgid29ya19wbGFjZV9jb2RlIGFzIHdvcmtQbGFjZUNvZGUiKTsKICAgICAgICAgICAgICAgIHNxbC5TRUxFQ1QoIndvcmtfcGxhY2VfbmFtZSBhcyB3b3JrUGxhY2VOYW1lIik7CiAgICAgICAgICAgICAgICBzcWwuU0VMRUNUKCJjcF9jb2RlIGFzIGNwQ29kZSIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNxbC5TRUxFQ1QoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChkaW1lbnNpb24pICsgIiBhcyBkaW1lbnNpb25JZCIpOwogICAgICAgIH0KICAgICAgICBzcWwuU0VMRUNUKCJjb3VudChESVNUSU5DVCh3b3JrX3BsYWNlX2NvZGUpKSBhcyB3b3JrUGxhY2VDb3VudCIKICAgICAgICAgICAgKyAiLCAoY291bnQoRElTVElOQ1QoZW1wbG95ZWVfbnVtYmVyKSkgLSBjb3VudChESVNUSU5DVChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJywiCiAgICAgICAgICAgICsgImVtcGxveWVlX251bWJlcixudWxsKSkpKSBhcyBhdHRlbmRhbmNlUGVvcGxlQ291bnQiCiAgICAgICAgICAgICsgIiwgY291bnQoRElTVElOQ1QoYXR0ZW5kYW5jZV9kYXRlKSkgYXMgYXR0ZW5kYW5jZURheXMiCiAgICAgICAgICAgICsgIiwgc3VtKGVmZmljaWVuY3lfYXR0ZW5kX3RpbWUpIGFzIGVmZmljaWVuY3lUaW1lLCBzdW0ocmVzdF90aW1lKSBhcyByZXN0VGltZSIKICAgICAgICAgICAgKyAiLCBzdW0oYXR0ZW5kYW5jZV9iYXNlX3RpbWUpIGFzIGF0dGVuZGFuY2VCYXNlVGltZSIKICAgICAgICAgICAgKyAiLHN1bShmbG9vcihhdHRlbmRhbmNlX292ZXJ0aW1lLzM2MDAuMCkrY2FzZSB3aGVuIGF0dGVuZGFuY2Vfb3ZlcnRpbWUvMzYwMC4wLWZsb29yIgogICAgICAgICAgICArICIoYXR0ZW5kYW5jZV9vdmVydGltZS8zNjAwLjApPj0wLjUgdGhlbiAwLjUgZWxzZSAwIGVuZCkgYXMgYXR0ZW5kYW5jZU92ZXJ0aW1lIgogICAgICAgICAgICArICIsIHN1bShpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJyxlZmZpY2llbmN5X2F0dGVuZF90aW1lLDApKSBhcyBhYnNlbnRlZWlzbVRpbWUiCiAgICAgICAgICAgICsgIiwgc3VtKGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnTUlTU19BVFRFTkRBTkNFJyxlZmZpY2llbmN5X2F0dGVuZF90aW1lLDApKSBhcyBtaXNzQXR0ZW5kYW5jZVRpbWUiCiAgICAgICAgICAgICsgIiwgc3VtKGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnT1ZFUl9BVFRFTkRBTkNFJyxlZmZpY2llbmN5X2F0dGVuZF90aW1lLDApKSBhcyBvdmVyQXR0ZW5kYW5jZVRpbWUiCiAgICAgICAgICAgICsgIiwgc3VtKGxlYXZlX3RpbWUpIGFzIGxlYXZlVGltZSIKICAgICAgICAgICAgKyAiLCBjb3VudChESVNUSU5DVChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ05PUk1BTCcgb3IgYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSBJUyBudWxsIG9yICIKICAgICAgICAgICAgKyAiYXBwcm92YWxfZGF0ZSBpcyBub3QgbnVsbCxlbXBsb3llZV9udW1iZXIsbnVsbCkpKSBhcyBub3JtYWxQZW9wbGVDb3VudCIKICAgICAgICAgICAgKyAiLCBjb3VudChESVNUSU5DVChpZihyZXN0X3RpbWUgaXMgbm90IG51bGwgYW5kIHJlc3RfdGltZSA8PiAwLGVtcGxveWVlX251bWJlcixudWxsKSkpIGFzICIKICAgICAgICAgICAgKyAicmVzdFBlb3BsZUNvdW50IgogICAgICAgICAgICArICIsIGNvdW50KERJU1RJTkNUKGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnQUJTRU5URUVJU00nLGVtcGxveWVlX251bWJlcixudWxsKSkpIGFzICIKICAgICAgICAgICAgKyAiYWJzZW50ZWVpc21QZW9wbGVDb3VudCIKICAgICAgICAgICAgKyAiLCBjb3VudChESVNUSU5DVChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ01JU1NfQVRURU5EQU5DRScsZW1wbG95ZWVfbnVtYmVyLG51bGwpKSkgYXMgIgogICAgICAgICAgICArICJtaXNzQXR0ZW5kYW5jZVBlb3BsZUNvdW50IgogICAgICAgICAgICArICIsIGNvdW50KERJU1RJTkNUKGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnTUlTU19JTl9PVVRfQVRURU5EQU5DRScsZW1wbG95ZWVfbnVtYmVyLG51bGwpKSkgYXMgIgogICAgICAgICAgICArICJtaXNzSW5PdXRBdHRlbmRhbmNlUGVvcGxlQ291bnQiCiAgICAgICAgICAgICsgIiwgY291bnQoRElTVElOQ1QoaWYoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdPVkVSX0FUVEVOREFOQ0UnLGVtcGxveWVlX251bWJlcixudWxsKSkpIGFzICIKICAgICAgICAgICAgKyAib3ZlckF0dGVuZGFuY2VQZW9wbGVDb3VudCIKICAgICAgICAgICAgKyAiLCBjb3VudChESVNUSU5DVChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0xBVEVfQVJSSVZFRF9BVFRFTkRBTkNFJyxlbXBsb3llZV9udW1iZXIsbnVsbCkpKSBhcyAiCiAgICAgICAgICAgICsgImxhdGVBcnJpdmVkQXR0ZW5kYW5jZVBlb3BsZUNvdW50IgogICAgICAgICAgICArICIsIGNvdW50KERJU1RJTkNUKGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnRUFSTFlfTEVGVF9BVFRFTkRBTkNFJyxlbXBsb3llZV9udW1iZXIsbnVsbCkpKSBhcyAiCiAgICAgICAgICAgICsgImVhcmx5TGVmdEF0dGVuZGFuY2VQZW9wbGVDb3VudCIKICAgICAgICAgICAgKyAiLCBjb3VudChESVNUSU5DVChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0xBVEVfQVJSSVZFRF9FQVJMWV9MRUZUX0FUVEVOREFOQ0UnLGVtcGxveWVlX251bWJlciwiCiAgICAgICAgICAgICsgIm51bGwpKSkgYXMgbGF0ZUFycml2ZWRFYXJseUxlZnRBdHRlbmRhbmNlUGVvcGxlQ291bnQsIGNvdW50KERJU1RJTkNUKGlmKGxlYXZlX3RpbWUgaXMgbm90IG51bGwgYW5kICIKICAgICAgICAgICAgKyAibGVhdmVfdGltZSA8PiAwLCBlbXBsb3llZV9udW1iZXIsIG51bGwpKSkgYXMgbGVhdmVQZW9wbGVDb3VudCwiCiAgICAgICAgICAgICsgInN1bShsZWF2ZV90aW1lKSBhcyBsZWF2ZVRpbWUiKTsKCiAgICAgICAgc3FsLkZST00oVEFCTEVfTkFNRSk7CgogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlID49ICciICsgRGF0ZVV0aWwuZ2V0RGF0ZTJTdHIocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0RGF0ZSgpKSArICInIik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlRW5kRGF0ZSgpKSArICInIik7CgogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0UmVnaW9uSWQoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJyZWdpb25faWQgPSAiICsgcXVlcnkuZ2V0UmVnaW9uSWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRDcENvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJjcF9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldENwQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrUGxhY2VDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZShxdWVyeS5nZXRXb3JrcGxhY2VDb2RlcygpKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEJsYW5rKHF1ZXJ5LmdldERpbWVuc2lvbigpKSkgewogICAgICAgICAgICBzcWwuR1JPVVBfQlkoU3RyaW5nLmpvaW4oIiwiLCBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldERpbWVuc2lvbigpKSkpOwogICAgICAgIH0KCiAgICAgICAgc3FsLk9SREVSX0JZKCJhdHRlbmRhbmNlX2RhdGUiKTsKCiAgICAgICAgU3RyaW5nIHJhd1NxbCA9IHNxbC50b1N0cmluZygpICsgIiBsaW1pdCAiICsgcXVlcnkuZ2V0UXVlcnlGcm9tKCkgKyAiLCIgKyBxdWVyeS5nZXRRdWVyeUxpbWl0KCk7CiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLnJlcGxhY2UoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChyYXdTcWwpLCAiXFwiLCAiIik7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRFbnRpcmVEYWlseUF0dGVuZGFuY2UoQFBhcmFtKCJkaW1lbnNpb25JZCIpIFN0cmluZyBkaW1lbnNpb25JZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgicXVlcnkiKSBFbnRpcmVEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzUXVlcnkgcXVlcnkpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpOwogICAgICAgIHNxbC5TRUxFQ1QoImF0dGVuZGFuY2VfZGF0ZSBhcyBhdHRlbmRhbmNlU2ltcGxlRGF0ZSIKICAgICAgICAgICAgKyAiLHN1bShlZmZpY2llbmN5X2F0dGVuZF90aW1lKSBhcyBlZmZpY2llbmN5VGltZSIKICAgICAgICAgICAgKyAiLHN1bShhdHRlbmRhbmNlX2Jhc2VfdGltZSkgYXMgYXR0ZW5kYW5jZUJhc2VUaW1lIgogICAgICAgICAgICArICIsc3VtKGZsb29yKGF0dGVuZGFuY2Vfb3ZlcnRpbWUvMzYwMC4wKStjYXNlIHdoZW4gYXR0ZW5kYW5jZV9vdmVydGltZS8zNjAwLjAtZmxvb3IiCiAgICAgICAgICAgICsgIihhdHRlbmRhbmNlX292ZXJ0aW1lLzM2MDAuMCk+PTAuNSB0aGVuIDAuNSBlbHNlIDAgZW5kKSBhcyBhdHRlbmRhbmNlT3ZlcnRpbWUiCiAgICAgICAgICAgICsgIixpZihjb3VudChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJyxlbXBsb3llZV9udW1iZXIsbnVsbCkpID4wLCdBQlNFTlRFRUlTTSciCiAgICAgICAgICAgICsgIixpZihjb3VudChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ01JU1NfQVRURU5EQU5DRScsZW1wbG95ZWVfbnVtYmVyLG51bGwpKSA+MCwnTUlTU19BVFRFTkRBTkNFJyIKICAgICAgICAgICAgKyAiLGlmKGNvdW50KGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnT1ZFUl9BVFRFTkRBTkNFJyxlbXBsb3llZV9udW1iZXIsbnVsbCkpID4wICwiCiAgICAgICAgICAgICsgIidPVkVSX0FUVEVOREFOQ0UnLG51bGwpKSkgYXMgYXR0ZW5kYW5jZUV4Y2VwdGlvbkNvZGUiKTsKICAgICAgICBzcWwuRlJPTShUQUJMRV9OQU1FKTsKCiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPj0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlU3RhcnREYXRlKCkpICsgIiciKTsKICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2VfZGF0ZSA8PSAnIiArIERhdGVVdGlsLmdldERhdGUyU3RyKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmREYXRlKCkpICsgIiciKTsKCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0RGltZW5zaW9uKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRShTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldERpbWVuc2lvbigpICsgIj0gJyIgKyBkaW1lbnNpb25JZCArICInIikpOwogICAgICAgIH0KCiAgICAgICAgaWYgKE9iamVjdHMubm9uTnVsbChxdWVyeS5nZXRSZWdpb25JZCgpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoInJlZ2lvbl9pZCA9ICIgKyBxdWVyeS5nZXRSZWdpb25JZCgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldENwQ29kZSgpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImNwX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0Q3BDb2RlKCkpICsgIiciKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0V29ya1BsYWNlQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0V29ya3BsYWNlQ29kZXMoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgaW4gIiArIGNvbW1hSm9pblN0cmluZ1ZhbHVlKHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgibGFib3VyX2NvbXBhbnlfaWQgaW4gIiArIGNvbW1hSm9pbkludFZhbHVlKHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpOwogICAgICAgIH0KCiAgICAgICAgc3FsLkdST1VQX0JZKCJhdHRlbmRhbmNlX2RhdGUiKTsKCiAgICAgICAgU3RyaW5nIHJhd1NxbCA9IHNxbC50b1N0cmluZygpOwogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5yZXBsYWNlKFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocmF3U3FsKSwgIlxcIiwgIiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgY291bnRBdHRlbmRhbmNlU3VtbWFyeUxpc3QoRW1wbG95ZWVBdHRlbmRhbmNlU3VtbWFyeUxpc3RRdWVyeSBxdWVyeSkgewogICAgICAgIHF1ZXJ5LnNldFF1ZXJ5RnJvbUFuZExpbWl0KCk7CgogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCkgewogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBTRUxFQ1QoImNvdW50KCopIik7CiAgICAgICAgICAgICAgICBGUk9NKFRBQkxFX05BTUUpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBTdHJpbmcgcmF3U3FsID0gY29uY2F0ZW5hdGVXaXRoV2hlcmVDb25kaXRpb24oc3FsLCBxdWVyeSk7CiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLnJlcGxhY2UoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChyYXdTcWwpLCAiXFwiLCAiIik7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBsaXN0QXR0ZW5kYW5jZVN1bW1hcnlMaXN0KEVtcGxveWVlQXR0ZW5kYW5jZVN1bW1hcnlMaXN0UXVlcnkgcXVlcnkpIHsKICAgICAgICBxdWVyeS5zZXRRdWVyeUZyb21BbmRMaW1pdCgpOwoKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpIHsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgU0VMRUNUKFNFTEVDVF9DT0xVTU4pOwogICAgICAgICAgICAgICAgRlJPTShUQUJMRV9OQU1FKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgU3RyaW5nIGVmZmVjdGl2ZVNxbCA9IGNvbmNhdGVuYXRlV2l0aFdoZXJlQ29uZGl0aW9uKHNxbCwgcXVlcnkpOwoKICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMucmVwbGFjZShTZWN1cml0eVV0aWwKICAgICAgICAgICAgICAgIC5lc2NhcGVTcWwoZWZmZWN0aXZlU3FsICsgIiBvcmRlciBieSBhdHRlbmRhbmNlX2RhdGUsIGVtcGxveWVlX251bWJlciBsaW1pdCAje3F1ZXJ5RnJvbX0sICIKICAgICAgICAgICAgICAgICAgICArICIje3F1ZXJ5TGltaXR9IiksCiAgICAgICAgICAgICJcXCIsICIiKTsKICAgIH0KCiAgICBwcml2YXRlIFN0cmluZyBjb25jYXRlbmF0ZVdpdGhXaGVyZUNvbmRpdGlvbihTUUwgc3FsLCBFbXBsb3llZUF0dGVuZGFuY2VTdW1tYXJ5TGlzdFF1ZXJ5IHF1ZXJ5KSB7CgogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0U3RhcnREYXRlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlID49ICN7c3RhcnREYXRlfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldEVuZERhdGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gI3tlbmREYXRlfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXROYW1lKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbmFtZSBsaWtlIENPTkNBVCgnJScsICN7bmFtZX0sJyUnKSIpOwogICAgICAgIH0KICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXROdW1iZXIoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJlbXBsb3llZV9udW1iZXI9I3tudW1iZXJ9ICIpOwogICAgICAgIH0KICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldEF0dGVuZGFuY2VFeGNlcHRpb25Db2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZT0je2F0dGVuZGFuY2VFeGNlcHRpb25Db2RlfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldFN0YXR1cygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoInN0YXR1cz0je3N0YXR1c30iKTsKICAgICAgICB9CiAgICAgICAgaWYgKE9iamVjdHMubm9uTnVsbChxdWVyeS5nZXRXb3JrTmF0dXJlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19uYXR1cmU9I3t3b3JrTmF0dXJlfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRCdXNpbmVzc1R5cGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJidXNpbmVzc190eXBlPSN7YnVzaW5lc3NUeXBlfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0V29ya1BsYWNlQ29kZXMoKSkpIHsKICAgICAgICAgICAgU3RyaW5nIHZhbHVlcyA9IHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGVzKCkKICAgICAgICAgICAgICAgIC5zdHJlYW0oKQogICAgICAgICAgICAgICAgLm1hcChzIC0+ICInIiArIHMgKyAiJyIpCiAgICAgICAgICAgICAgICAucmVkdWNlKChzMSwgczIpIC0+IHMxICsgIiwiICsgczIpCiAgICAgICAgICAgICAgICAuZ2V0KCk7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlIGluICgiICsgU2VjdXJpdHlVdGlsLmVzY2FwZVNxbCh2YWx1ZXMpICsgIikiKTsKICAgICAgICB9CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0V29ya1BsYWNlQ29kZSgpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoIndvcmtfcGxhY2VfY29kZSA9ICN7d29ya1BsYWNlQ29kZX0iKTsKICAgICAgICB9CiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJsYWJvdXJfY29tcGFueV9pZCBpbiAiICsgY29tbWFKb2luSW50VmFsdWUocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkcygpKSk7CiAgICAgICAgfQogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgibGFib3VyX2NvbXBhbnlfaWQ9I3tsYWJvdXJDb21wYW55SWR9Iik7CiAgICAgICAgfQogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEJsYW5rKHF1ZXJ5LmdldENwQ29kZSgpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoIndvcmtfcGxhY2VfY29kZSBpbiAoc2VsZWN0IGNvZGUgZnJvbSBsbXNfd29ya19wbGFjZSB3aGVyZSBjcF9jb2RlID0gI3tjcENvZGV9KSIpOwogICAgICAgIH0KICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldFJlZ2lvbklkKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgicmVnaW9uX2lkPSN7cmVnaW9uSWR9Iik7CiAgICAgICAgfQogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEJsYW5rKHF1ZXJ5LmdldEFwcHJvdmFsVXNlcigpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImFwcHJvdmFsX3VzZXI9I3thcHByb3ZhbFVzZXJ9Iik7CiAgICAgICAgfQogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEJsYW5rKHF1ZXJ5LmdldEFwcHJvdmFsUmVhc29uKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXBwcm92YWxfcmVhc29uPSN7YXBwcm92YWxSZWFzb259Iik7CiAgICAgICAgfQogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0QXBwcm92YWxEYXRlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXBwcm92YWxfZGF0ZT0je2FwcHJvdmFsRGF0ZX0iKTsKICAgICAgICB9CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0QXBwcm92YWxSZW1hcmsoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJhcHByb3ZhbF9yZW1hcms9bGlrZSBDT05DQVQoJyUnLCAje2FwcHJvdmFsUmVtYXJrfSwnJScpIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0QXR0ZW5kYW5jZUV4Y2VwdGlvbkNvZGVzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUocXVlcnkuZ2V0QXR0ZW5kYW5jZUV4Y2VwdGlvbkNvZGVzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0UygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2Vfc3RhcnRfdGltZSA+PSAje2F0dGVuZGFuY2VTdGFydFN9Iik7CiAgICAgICAgfQogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0RSgpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2Vfc3RhcnRfdGltZSA8PSAje2F0dGVuZGFuY2VTdGFydEV9Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmRTKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9lbmRfdGltZSA+PSAje2F0dGVuZGFuY2VFbmRTfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmRFKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9lbmRfdGltZSA8PSAje2F0dGVuZGFuY2VFbmRFfSIpOwogICAgICAgIH0KCiAgICAgICAgU3RyaW5nQnVpbGRlciBzcWxCdWlsZGVyID0gbmV3IFN0cmluZ0J1aWxkZXIoc3FsLnRvU3RyaW5nKCkpOwogICAgICAgIEludGVnZXJbXSBwb3NpdGlvbnMgPSBxdWVyeS5nZXRQb3NpdGlvbnMoKTsKICAgICAgICBpZiAocG9zaXRpb25zICE9IG51bGwgJiYgcG9zaXRpb25zLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgICAgIHNldFBvc2l0aW9uc1doZXJlQ29uZGl0aW9uKHNxbEJ1aWxkZXIsIHBvc2l0aW9ucyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc3FsQnVpbGRlci50b1N0cmluZygpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzZXRQb3NpdGlvbnNXaGVyZUNvbmRpdGlvbihTdHJpbmdCdWlsZGVyIHNxbEJ1aWxkZXIsIEludGVnZXJbXSBwb3NpdGlvbnMpIHsKICAgICAgICBzcWxCdWlsZGVyLmFwcGVuZCgiIEFORCAoIik7CiAgICAgICAgaW50IGkgPSAwOwogICAgICAgIGZvciAoSW50ZWdlciBwb3NpdGlvbiA6IHBvc2l0aW9ucykgewogICAgICAgICAgICBpZiAoT2JqZWN0cy5pc051bGwocG9zaXRpb24pKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoaSAhPSAwKSB7CiAgICAgICAgICAgICAgICBzcWxCdWlsZGVyLmFwcGVuZCgiIE9SICIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIOaehOmAoFNRTO+8mm9yIHBvc2l0aW9ucyBsaWtlICclfDM4fCUnCiAgICAgICAgICAgIHNxbEJ1aWxkZXIuYXBwZW5kKCJwb3NpdGlvbnMgbGlrZSBDT05DQVQoJyUnLCAnfCIpLmFwcGVuZChwb3NpdGlvbikuYXBwZW5kKCJ8JyAsJyUnKSAiKTsKICAgICAgICAgICAgaSsrOwogICAgICAgIH0KICAgICAgICBzcWxCdWlsZGVyLmFwcGVuZCgiKSIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgYmF0Y2hVcGRhdGVCeUlkcyhFbXBsb3llZUF0dGVuZFN0YXRzQmF0Y2hVcGRhdGVRdWVyeSBiYXRjaFVwZGF0ZVF1ZXJ5KSB7CiAgICAgICAgU3RyaW5nIHNxbCA9IG5ldyBTUUwoKSB7CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFVQREFURShUQUJMRV9OQU1FKTsKCiAgICAgICAgICAgICAgICBTRVQoImdtdF9tb2RpZmllZD1ub3coKSIpOwoKICAgICAgICAgICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwoYmF0Y2hVcGRhdGVRdWVyeS5nZXRBdHRlbmRhbmNlRXhjZXB0aW9uQ29kZSgpKSkgewogICAgICAgICAgICAgICAgICAgIFNFVCgiYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZT0je2F0dGVuZGFuY2VFeGNlcHRpb25Db2RlfSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKE9iamVjdHMubm9uTnVsbChiYXRjaFVwZGF0ZVF1ZXJ5LmdldEFwcHJvdmFsVXNlcigpKSkgewogICAgICAgICAgICAgICAgICAgIFNFVCgiYXBwcm92YWxfdXNlcj0je2FwcHJvdmFsVXNlcn0iKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwoYmF0Y2hVcGRhdGVRdWVyeS5nZXRBcHByb3ZhbERhdGUoKSkpIHsKICAgICAgICAgICAgICAgICAgICBTRVQoImFwcHJvdmFsX2RhdGU9I3thcHByb3ZhbERhdGV9Iik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKGJhdGNoVXBkYXRlUXVlcnkuZ2V0QXBwcm92YWxSZWFzb24oKSkpIHsKICAgICAgICAgICAgICAgICAgICBTRVQoImFwcHJvdmFsX3JlYXNvbj0je2FwcHJvdmFsUmVhc29ufSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKE9iamVjdHMubm9uTnVsbChiYXRjaFVwZGF0ZVF1ZXJ5LmdldEFwcHJvdmFsUmVtYXJrKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgU0VUKCJhcHByb3ZhbF9yZW1hcms9I3thcHByb3ZhbFJlbWFya30iKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFdIRVJFKCJpZCBpbiAoIiArIEpPSU5FUi5qb2luKGJhdGNoVXBkYXRlUXVlcnkuZ2V0SWRzKCkpICsgIikiKTsKICAgICAgICAgICAgfQogICAgICAgIH0udG9TdHJpbmcoKTsKICAgICAgICByZXR1cm4gc3FsOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nIGJhdGNoVXBkYXRlSXNEZWxldGUoQFBhcmFtKCJ3b3JrcGxhY2VDb2RlIikgU3RyaW5nIHdvcmtwbGFjZUNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgiaWRzIikgTGlzdDxMb25nPiBpZHMpIHsKICAgICAgICBTdHJpbmcgc3FsID0gbmV3IFNRTCgpIHsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgVVBEQVRFKFRBQkxFX05BTUUpOwoKICAgICAgICAgICAgICAgIFNFVCgiZ210X21vZGlmaWVkPW5vdygpIik7CgogICAgICAgICAgICAgICAgU0VUKCJpc19kZWxldGU9MSIpOwoKICAgICAgICAgICAgICAgIFdIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgPSAje3dvcmtwbGFjZUNvZGV9Iik7CiAgICAgICAgICAgICAgICBXSEVSRSgiaWQgaW4gKCIgKyBKT0lORVIuam9pbihpZHMpICsgIikiKTsKICAgICAgICAgICAgfQogICAgICAgIH0udG9TdHJpbmcoKTsKICAgICAgICByZXR1cm4gc3FsOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgcXVlcnlFZmZpY2llbmN5KEVmZmljaWVuY3lEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzUXVlcnkgcXVlcnkpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpOwogICAgICAgIHNxbC5TRUxFQ1QoImF0dGVuZGFuY2VfZGF0ZSwgd29ya19wbGFjZV9jb2RlIik7CiAgICAgICAgLy8g57y65YukICsg6K+35YWo5aSp5YGHCiAgICAgICAgc3FsLlNFTEVDVCgiQ09VTlQoRElTVElOQ1QoIgogICAgICAgICAgICArICJJRihvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJyBvciAobGVhdmVfdGltZSA+IDAgYW5kIGVmZmljaWVuY3lfYXR0ZW5kX3RpbWUgPSAiCiAgICAgICAgICAgICsgIjApLCBudWxsLCBlbXBsb3llZV9udW1iZXIpKSkgQVMgcGVvcGxlQ291bnQiKTsKICAgICAgICBzcWwuU0VMRUNUKCJDT1VOVChESVNUSU5DVCgiCiAgICAgICAgICAgICsgIklGKGxlYXZlX3RpbWUgaXMgbm90IG51bGwgYW5kIGxlYXZlX3RpbWUgPD4gMCwgZW1wbG95ZWVfbnVtYmVyLCBudWxsKSkpIEFTIGxlYXZlUGVvcGxlQ291bnQiKTsKICAgICAgICBzcWwuU0VMRUNUKCJDT1VOVChESVNUSU5DVCgiCiAgICAgICAgICAgICsgIklGKGlzX2Zvcl9lZmZpY2llbmN5X2F0dGVuZF90aW1lID0gMCwgZW1wbG95ZWVfbnVtYmVyLCBudWxsKSkpIGFzIG1hbmFnZXJDb3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoIkNPVU5UKERJU1RJTkNUKCIKICAgICAgICAgICAgKyAiSUYoKG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCBPUiBvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlICE9ICdBQlNFTlRFRUlTTScpICIKICAgICAgICAgICAgKyAiQU5EIGNsYXNzX25hbWUgaXMgbm90IG51bGwsIGVtcGxveWVlX251bWJlciwgbnVsbCkpKSBhcyBzaGlmdFBlb3BsZUNvdW50Iik7CiAgICAgICAgc3FsLlNFTEVDVCgiQ09VTlQoRElTVElOQ1QoIgogICAgICAgICAgICArICJJRigob3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSBpcyBudWxsIE9SIChvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlICE9ICdBQlNFTlRFRUlTTScgIgogICAgICAgICAgICArICJBTkQgb3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSAhPSAnT1ZFUl9BVFRFTkRBTkNFJykpICIKICAgICAgICAgICAgKyAiQU5EIGNsYXNzX25hbWUgaXMgbnVsbCwgZW1wbG95ZWVfbnVtYmVyLCBudWxsKSkpIEFTIGZyZWVQZW9wbGVDb3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoIkNPVU5UKERJU1RJTkNUKCIKICAgICAgICAgICAgKyAiSUYob3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdPVkVSX0FUVEVOREFOQ0UnLCBlbXBsb3llZV9udW1iZXIsIG51bGwpKSkgQVMgb3ZlclBlb3BsZUNvdW50Iik7CiAgICAgICAgc3FsLlNFTEVDVCgiQ09VTlQoRElTVElOQ1QoIgogICAgICAgICAgICArICJJRihvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ01JU1NfQVRURU5EQU5DRScsIGVtcGxveWVlX251bWJlciwgbnVsbCkpKSBBUyAiCiAgICAgICAgICAgICsgIm1pc3NBdHRlbmRhbmNlQ291bnQiKTsKICAgICAgICBzcWwuU0VMRUNUKCJDT1VOVChESVNUSU5DVCgiCiAgICAgICAgICAgICsgIklGKG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnQUJTRU5URUVJU00nLCBlbXBsb3llZV9udW1iZXIsIG51bGwpKSkgQVMgYWJzZW50ZWVpc21Db3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoIkNPVU5UKERJU1RJTkNUKCIKICAgICAgICAgICAgKyAiSUYocmVzdF90aW1lIGlzIG5vdCBudWxsIEFORCByZXN0X3RpbWUgPD4gMCwgZW1wbG95ZWVfbnVtYmVyLCBudWxsKSkpIEFTIHJlc3RQZW9wbGVDb3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoIkNPVU5UKERJU1RJTkNUKCIKICAgICAgICAgICAgKyAiSUYob3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSBpcyBub3QgbnVsbCBhbmQgb3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSAhPSAnTk9STUFMJywgIgogICAgICAgICAgICArICJlbXBsb3llZV9udW1iZXIsIG51bGwpKSkgQVMgYWJub3JtYWxQZW9wbGVDb3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoCiAgICAgICAgICAgICJDT1VOVChESVNUSU5DVChJRigoc291cmNlX3R5cGU9ICdBVE0nIGFuZCAob3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA8PiAnQUJTRU5URUVJU00nIG9yICIKICAgICAgICAgICAgICAgICsgIm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCkgYW5kIGVmZmljaWVuY3lfYXR0ZW5kX3RpbWUgPiAwKSwgZW1wbG95ZWVfbnVtYmVyLCAiCiAgICAgICAgICAgICAgICArICJudWxsKSkpIEFTIGZhY2VQZW9wbGVDb3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoIlNVTShlZmZpY2llbmN5X2F0dGVuZF90aW1lKSBBUyBlZmZpY2llbmN5VGltZSIpOwogICAgICAgIHNxbC5TRUxFQ1QoIlNVTShyZXN0X3RpbWUpIEFTIHJlc3RUaW1lIik7CiAgICAgICAgc3FsLlNFTEVDVCgiU1VNKGxlYXZlX3RpbWUpIEFTIGxlYXZlVGltZSIpOwogICAgICAgIHNxbC5TRUxFQ1QoIlNVTShjYXNlIHdoZW4gc291cmNlX3R5cGUgPSAnQUNST1NTX1dBUkVIT1VTRScgdGhlbiAxIGVsc2UgMCBlbmQpIGFzIGhlbHBBdHRlbmRhbmNlUGVvcGxlQ291bnQiKTsKICAgICAgICBzcWwuRlJPTShBREJfVEFCTEVfTkFNRSk7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPj0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlU3RhcnREYXRlKCkpICsgIiciKTsKICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2VfZGF0ZSA8PSAnIiArIERhdGVVdGlsLmdldERhdGUyU3RyKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmREYXRlKCkpICsgIiciKTsKCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFJlZ2lvbklkcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoInJlZ2lvbl9pZCBpbiAiICsgY29tbWFKb2luSW50VmFsdWUocXVlcnkuZ2V0UmVnaW9uSWRzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrUGxhY2VDb2RlcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoIndvcmtfcGxhY2VfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUocXVlcnkuZ2V0V29ya1BsYWNlQ29kZXMoKSkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldEluZHVzdHJ5Q29sbGVjdGlvbnMoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJpbmR1c3RyeV9jb2xsZWN0aW9uIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZShxdWVyeS5nZXRJbmR1c3RyeUNvbGxlY3Rpb25zKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgibGFib3VyX2NvbXBhbnlfaWQgaW4gIiArIGNvbW1hSm9pbkludFZhbHVlKHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpOwogICAgICAgIH0KCiAgICAgICAgc3FsLkdST1VQX0JZKCJhdHRlbmRhbmNlX2RhdGUsIHdvcmtfcGxhY2VfY29kZSwgd29ya19wbGFjZV9uYW1lLCBpbmR1c3RyeV9jb2xsZWN0aW9uX25hbWUsIHJlZ2lvbl9uYW1lIik7CiAgICAgICAgc3FsLk9SREVSX0JZKCJhdHRlbmRhbmNlX2RhdGUsIHJlZ2lvbl9uYW1lLCB3b3JrX3BsYWNlX2NvZGUiKTsKICAgICAgICBxdWVyeS5zZXRRdWVyeUZyb21BbmRMaW1pdCgpOwogICAgICAgIHJldHVybiBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgIiArIHF1ZXJ5LmdldFF1ZXJ5RnJvbSgpICsgIiwiICsgcXVlcnkuZ2V0UXVlcnlMaW1pdCgpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0RWZmaWNpZW5jeVJhbmsoRGluZ1RhbGtFZmZpY2llbmN5UmFua1F1ZXJ5IHF1ZXJ5KSB7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKSB7ewogICAgICAgICAgICBTRUxFQ1QoIndvcmtfcGxhY2VfY29kZSB3b3JrUGxhY2VDb2RlLCIKICAgICAgICAgICAgICAgICsgImNwX2NvZGUgY3BDb2RlLCBjcF9uYW1lICIKICAgICAgICAgICAgICAgICsgImNwTmFtZSwgY291bnQoRElTVElOQ1QoaWYiCiAgICAgICAgICAgICAgICArICIoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdBQlNFTlRFRUlTTScsIG51bGwsIGNvbmNhdChlbXBsb3llZV9udW1iZXIsIGF0dGVuZGFuY2VfZGF0ZSkpKSkgYXMgIgogICAgICAgICAgICAgICAgKyAicGVvcGxlQ291bnQsICIKICAgICAgICAgICAgICAgICsgImNvdW50KERJU1RJTkNUKGlmKGxlYXZlX3RpbWUgaXMgbm90IG51bGwgYW5kIGxlYXZlX3RpbWUgPD4gMCwgY29uY2F0KGVtcGxveWVlX251bWJlciwgIgogICAgICAgICAgICAgICAgKyAiYXR0ZW5kYW5jZV9kYXRlKSwgbnVsbCkpKSBhcyAiCiAgICAgICAgICAgICAgICArICJsZWF2ZVBlb3BsZUNvdW50LCAiCiAgICAgICAgICAgICAgICArICJjb3VudChESVNUSU5DVChpZihpc19mb3JfZWZmaWNpZW5jeV9hdHRlbmRfdGltZSA9IDAsIGNvbmNhdChlbXBsb3llZV9udW1iZXIsIGF0dGVuZGFuY2VfZGF0ZSksICIKICAgICAgICAgICAgICAgICsgIm51bGwpKSkgYXMgbWFuYWdlckNvdW50LCAiCiAgICAgICAgICAgICAgICArICJjb3VudChESVNUSU5DVChpZihyZXN0X3RpbWUgaXMgbm90IG51bGwgYW5kIHJlc3RfdGltZSA8PiAwLCBjb25jYXQoZW1wbG95ZWVfbnVtYmVyLCAiCiAgICAgICAgICAgICAgICArICJhdHRlbmRhbmNlX2RhdGUpLCBudWxsKSkpIGFzICIKICAgICAgICAgICAgICAgICsgInJlc3RQZW9wbGVDb3VudCwiCiAgICAgICAgICAgICAgICArICJzdW0oZWZmaWNpZW5jeV9hdHRlbmRfdGltZSkgYXMgZWZmaWNpZW5jeVRpbWUsIHN1bShyZXN0X3RpbWUpIGFzIHJlc3RUaW1lLCBzdW0obGVhdmVfdGltZSkgYXMgIgogICAgICAgICAgICAgICAgKyAibGVhdmVUaW1lLCIKICAgICAgICAgICAgICAgICsgIkNPVU5UKERJU1RJTkNUKElGKHNvdXJjZV90eXBlID0gJ0FUTScsIGVtcGxveWVlX251bWJlciwgbnVsbCkpKSBBUyBmYWNlUGVvcGxlQ291bnQiKTsKICAgICAgICAgICAgaWYgKHF1ZXJ5LmdldFRpbWVEaW1lbnNpb24oKSA9PSBUaW1lRGltZW5zaW9uRW51bS5EQVRFKSB7CiAgICAgICAgICAgICAgICBTRUxFQ1QoImF0dGVuZGFuY2VfZGF0ZSwgYXR0ZW5kYW5jZV9kYXRlIGN5Y2xlIik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocXVlcnkuZ2V0VGltZURpbWVuc2lvbigpID09IFRpbWVEaW1lbnNpb25FbnVtLldFRUspIHsKICAgICAgICAgICAgICAgIC8vIOavj+W5tOeahOacgOWQjuWHoOWkqeeul+S9nOS4i+S4gOW5tOeahOesrOS4gOWRqAogICAgICAgICAgICAgICAgU0VMRUNUKAogICAgICAgICAgICAgICAgICAgICJXRUVLKGF0dGVuZGFuY2VfZGF0ZSwgMykgd2VlaywgaWYoTU9OVEgoYXR0ZW5kYW5jZV9kYXRlKSA9IDEyIGFuZCBXRUVLKGF0dGVuZGFuY2VfZGF0ZSwgMykgPSAxLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgIllFQVIoYXR0ZW5kYW5jZV9kYXRlKSArIDEsIFlFQVIoYXR0ZW5kYW5jZV9kYXRlKSkgeWVhciwgY29uY2F0KFdFRUsoYXR0ZW5kYW5jZV9kYXRlLCAzKSwgIgogICAgICAgICAgICAgICAgICAgICAgICArICIndy0nLCBpZihNT05USChhdHRlbmRhbmNlX2RhdGUpID0gMTIgYW5kIFdFRUsoYXR0ZW5kYW5jZV9kYXRlLCAzKSA9IDEsIFlFQVIiCiAgICAgICAgICAgICAgICAgICAgICAgICsgIihhdHRlbmRhbmNlX2RhdGUpICsgMSwgWUVBUihhdHRlbmRhbmNlX2RhdGUpKSkgY3ljbGUiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFNFTEVDVCgKICAgICAgICAgICAgICAgICAgICAiTU9OVEgoYXR0ZW5kYW5jZV9kYXRlKSBtb250aCwgWUVBUihhdHRlbmRhbmNlX2RhdGUpIHllYXIsIGNvbmNhdChNT05USChhdHRlbmRhbmNlX2RhdGUpLCAnbS0nLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgIllFQVIoYXR0ZW5kYW5jZV9kYXRlKSkgY3ljbGUiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBGUk9NKEFEQl9UQUJMRV9OQU1FKTsKICAgICAgICAgICAgV0hFUkUoCiAgICAgICAgICAgICAgICAiYXR0ZW5kYW5jZV9kYXRlID49ICciICsgU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChMb2NhbERhdGVVdGlsLmZvcm1hdERhdGUocXVlcnkuZ2V0U3RhcnREYXRlKCkpKSArICInIik7CiAgICAgICAgICAgIFdIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKExvY2FsRGF0ZVV0aWwuZm9ybWF0RGF0ZShxdWVyeS5nZXRFbmREYXRlKCkpKSArICInIik7CiAgICAgICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRDcENvZGVzKCkpKSB7CiAgICAgICAgICAgICAgICBXSEVSRSgiY3BfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUocXVlcnkuZ2V0Q3BDb2RlcygpKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFJlZ2lvbklkcygpKSkgewogICAgICAgICAgICAgICAgV0hFUkUoInJlZ2lvbl9pZCBpbiAiICsgY29tbWFKb2luSW50VmFsdWUocXVlcnkuZ2V0UmVnaW9uSWRzKCkpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXRJbmR1c3RyeUNvbGxlY3Rpb24oKSkpIHsKICAgICAgICAgICAgICAgIFdIRVJFKCJpbmR1c3RyeV9jb2xsZWN0aW9uID0gI3tpbmR1c3RyeUNvbGxlY3Rpb259Iik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgR1JPVVBfQlkoIndvcmtfcGxhY2VfY29kZSwgaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lLCByZWdpb25fbmFtZSwgY3BfbmFtZSwgY3ljbGUiKTsKICAgICAgICAgICAgT1JERVJfQlkoImF0dGVuZGFuY2VfZGF0ZSwgcmVnaW9uX25hbWUsIHdvcmtfcGxhY2VfY29kZSIpOwogICAgICAgIH19OwoKICAgICAgICBTdHJpbmcgcmF3U3FsID0gc3FsLnRvU3RyaW5nKCk7CiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLnJlcGxhY2UoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChyYXdTcWwpLCAiXFwiLCAiIik7CgogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgcXVlcnlBdHRlbmRXaXRoSWROdW0oQFBhcmFtKCJkYXRlIikgRGF0ZSBkYXRlLCBAUGFyYW0oIndvcmtQbGFjZUNvZGVzIikgTGlzdDxTdHJpbmc+IHdvcmtQbGFjZUNvZGVzKSB7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKSB7ewogICAgICAgICAgICBTRUxFQ1QoCiAgICAgICAgICAgICAgICAiYS5hdHRlbmRhbmNlX2RhdGUsIGEuZW1wbG95ZWVfbmFtZSwgYS5lbXBsb3llZV9udW1iZXIsZS5pZF9udW0sIGEud29ya19wbGFjZV9uYW1lLCBhLmNwX2NvZGUsIGUiCiAgICAgICAgICAgICAgICAgICAgKyAiLmNvb3BlcmF0aW9uX3N0YXJ0X2RhdGUiKTsKICAgICAgICAgICAgRlJPTSgiZGluZ3RhbGtfYXR0ZW5kYW5jZV9zdGF0aXN0aWNzIGEiKTsKICAgICAgICAgICAgSU5ORVJfSk9JTigiZW1wbG95ZWUgZSBvbiBlLm51bWJlciA9IGEuZW1wbG95ZWVfbnVtYmVyIik7CiAgICAgICAgICAgIFdIRVJFKAogICAgICAgICAgICAgICAgIihhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCBvciBhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgIT0gIgogICAgICAgICAgICAgICAgICAgICsgIidBQlNFTlRFRUlTTScpIik7CiAgICAgICAgICAgIFdIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPSAje2RhdGV9Iik7CiAgICAgICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eSh3b3JrUGxhY2VDb2RlcykpIHsKICAgICAgICAgICAgICAgIFdIRVJFKCJhLndvcmtfcGxhY2VfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUod29ya1BsYWNlQ29kZXMpKTsKICAgICAgICAgICAgfQogICAgICAgIH19OwogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgMjAwMDAiOwogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5yZXBsYWNlKFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocmF3U3FsKSwgIlxcIiwgIiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgcXVlcnlXZWVrQXR0ZW5kV2l0aElkTnVtKEBQYXJhbSgiZGF0ZSIpIERhdGUgZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgid29ya1BsYWNlQ29kZXMiKSBMaXN0PFN0cmluZz4gd29ya1BsYWNlQ29kZXMpIHsKICAgICAgICBEYXRlIGRhdGU3QWdvID0gRGF0ZVV0aWxzLmFkZERheXMoZGF0ZSwgLTcpOwogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCkge3sKICAgICAgICAgICAgU0VMRUNUKAogICAgICAgICAgICAgICAgImRpc3RpbmN0IGEuZW1wbG95ZWVfbmFtZSwgYS5lbXBsb3llZV9udW1iZXIsZS5pZF9udW0sIGEud29ya19wbGFjZV9uYW1lLCBhLmNwX2NvZGUsIGUiCiAgICAgICAgICAgICAgICAgICAgKyAiLmNvb3BlcmF0aW9uX3N0YXJ0X2RhdGUiKTsKICAgICAgICAgICAgRlJPTSgiZGluZ3RhbGtfYXR0ZW5kYW5jZV9zdGF0aXN0aWNzIGEiKTsKICAgICAgICAgICAgSU5ORVJfSk9JTigiZW1wbG95ZWUgZSBvbiBlLm51bWJlciA9IGEuZW1wbG95ZWVfbnVtYmVyIik7CiAgICAgICAgICAgIFdIRVJFKAogICAgICAgICAgICAgICAgIihhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCBvciBhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgIT0gIgogICAgICAgICAgICAgICAgICAgICsgIidBQlNFTlRFRUlTTScpIik7CiAgICAgICAgICAgIFdIRVJFKCJhLmF0dGVuZGFuY2VfZGF0ZSA+PSAnIiArIERhdGVVdGlsLmdldERhdGUyU3RyKGRhdGU3QWdvKSArICInIGFuZCBhLmF0dGVuZGFuY2VfZGF0ZSA8PSAje2RhdGV9Iik7CiAgICAgICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eSh3b3JrUGxhY2VDb2RlcykpIHsKICAgICAgICAgICAgICAgIFdIRVJFKCJhLndvcmtfcGxhY2VfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUod29ya1BsYWNlQ29kZXMpKTsKICAgICAgICAgICAgfQogICAgICAgIH19OwogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgMjAwMDAiOwogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5yZXBsYWNlKFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocmF3U3FsKSwgIlxcIiwgIiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgcXVlcnlUd29XZWVrQXR0ZW5kV2l0aElkTnVtKEBQYXJhbSgiZGF0ZSIpIERhdGUgZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgid29ya1BsYWNlQ29kZXMiKSBMaXN0PFN0cmluZz4gd29ya1BsYWNlQ29kZXMpIHsKICAgICAgICBEYXRlIGRhdGUxNEFnbyA9IERhdGVVdGlscy5hZGREYXlzKGRhdGUsIC0xNCk7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKSB7ewogICAgICAgICAgICBTRUxFQ1QoCiAgICAgICAgICAgICAgICAiZGlzdGluY3QgYS5lbXBsb3llZV9uYW1lLCBhLmVtcGxveWVlX251bWJlcixlLmlkX251bSwgYS53b3JrX3BsYWNlX25hbWUsIGEuY3BfY29kZSwgZSIKICAgICAgICAgICAgICAgICAgICArICIuY29vcGVyYXRpb25fc3RhcnRfZGF0ZSIpOwogICAgICAgICAgICBGUk9NKCJkaW5ndGFsa19hdHRlbmRhbmNlX3N0YXRpc3RpY3MgYSIpOwogICAgICAgICAgICBJTk5FUl9KT0lOKCJlbXBsb3llZSBlIG9uIGUubnVtYmVyID0gYS5lbXBsb3llZV9udW1iZXIiKTsKICAgICAgICAgICAgV0hFUkUoCiAgICAgICAgICAgICAgICAiKGEub3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSBpcyBudWxsIG9yIGEub3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSAhPSAiCiAgICAgICAgICAgICAgICAgICAgKyAiJ0FCU0VOVEVFSVNNJykiKTsKICAgICAgICAgICAgV0hFUkUoImEuYXR0ZW5kYW5jZV9kYXRlID49ICciICsgRGF0ZVV0aWwuZ2V0RGF0ZTJTdHIoZGF0ZTE0QWdvKSArICInIGFuZCBhLmF0dGVuZGFuY2VfZGF0ZSA8PSAje2RhdGV9Iik7CiAgICAgICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eSh3b3JrUGxhY2VDb2RlcykpIHsKICAgICAgICAgICAgICAgIFdIRVJFKCJhLndvcmtfcGxhY2VfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUod29ya1BsYWNlQ29kZXMpKTsKICAgICAgICAgICAgfQogICAgICAgIH19OwogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgMjAwMDAiOwogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5yZXBsYWNlKFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocmF3U3FsKSwgIlxcIiwgIiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0QXR0ZW5kSWROdW1QcmVmaXgoQFBhcmFtKCJkYXRlIikgRGF0ZSBkYXRlLCBAUGFyYW0oIndvcmtQbGFjZUNvZGVzIikgTGlzdDxTdHJpbmc+IHdvcmtQbGFjZUNvZGVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oInNwZWNpYWxJZE51bVByZWZpeCIpIExpc3Q8U3RyaW5nPiBzcGVjaWFsSWROdW1QcmVmaXgpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpIHt7CiAgICAgICAgICAgIFNFTEVDVCgiY291bnQoMSkiKTsKICAgICAgICAgICAgRlJPTSgiZGluZ3RhbGtfYXR0ZW5kYW5jZV9zdGF0aXN0aWNzIGEiKTsKICAgICAgICAgICAgSU5ORVJfSk9JTigiZW1wbG95ZWUgZSBvbiBlLm51bWJlciA9IGEuZW1wbG95ZWVfbnVtYmVyIik7CiAgICAgICAgICAgIFdIRVJFKAogICAgICAgICAgICAgICAgIihhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCBvciBhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgIT0gIgogICAgICAgICAgICAgICAgICAgICsgIidBQlNFTlRFRUlTTScpIik7CiAgICAgICAgICAgIFdIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPSAje2RhdGV9Iik7CiAgICAgICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eSh3b3JrUGxhY2VDb2RlcykpIHsKICAgICAgICAgICAgICAgIFdIRVJFKCJhLndvcmtfcGxhY2VfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUod29ya1BsYWNlQ29kZXMpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkoc3BlY2lhbElkTnVtUHJlZml4KSkgewogICAgICAgICAgICAgICAgTGlzdDxTdHJpbmc+IHdoZXJlcyA9IHNwZWNpYWxJZE51bVByZWZpeC5zdHJlYW0oKQogICAgICAgICAgICAgICAgICAgIC5tYXAoaWROdW1QcmVmaXggLT4gIiBpZF9udW0gbGlrZSAnIiArIGlkTnVtUHJlZml4ICsgIiUnICIpCiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3QoQ29sbGVjdG9ycy50b0xpc3QoKSk7CiAgICAgICAgICAgICAgICBXSEVSRSgiKCIgKyBPUl9KT0lORVIuam9pbih3aGVyZXMpICsgIikiKTsKICAgICAgICAgICAgfQogICAgICAgIH19OwogICAgICAgIHJldHVybiBzcWwudG9TdHJpbmcoKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldEF0dGVuZGFuY2VCeUVtcGxveWVlTnVtYmVyQW5kV29ya0RhdGUoKSB7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKTsKICAgICAgICBzcWwuU0VMRUNUKFNFTEVDVF9DT0xVTU4pOwogICAgICAgIHNxbC5GUk9NKFRBQkxFX05BTUUpOwogICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gI3t3b3JrcGxhY2VDb2RlfSIpOwogICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbnVtYmVyPSN7ZW1wbG95ZWVOdW1iZXJ9Iik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGU9I3t3b3JrRGF0ZX0iKTsKICAgICAgICBzcWwuV0hFUkUoInNvdXJjZV90eXBlPD4nUFBSJyIpOwogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgMSI7CiAgICAgICAgcmV0dXJuIHJhd1NxbDsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldEZpcnN0QnlBdHRlbmRhbmNlRGF0ZShAUGFyYW0oImF0dGVuZGFuY2VEYXRlIikgTG9jYWxEYXRlVGltZSBhdHRlbmRhbmNlRGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgid29ya3BsYWNlQ29kZSIpIFN0cmluZyB3b3JrcGxhY2VDb2RlKSB7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKTsKICAgICAgICBzcWwuU0VMRUNUKFNFTEVDVF9DT0xVTU4pOwogICAgICAgIHNxbC5GUk9NKFRBQkxFX05BTUUgKyAiIGZvcmNlIGluZGV4KGlkeF9hdHRlbmRhbmNlX2RhdGUpICIpOwogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlPSN7YXR0ZW5kYW5jZURhdGV9Iik7CiAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGU9I3t3b3JrcGxhY2VDb2RlfSIpOwogICAgICAgIHNxbC5XSEVSRSgic291cmNlX3R5cGU8PidQUFInIik7CiAgICAgICAgc3FsLk9SREVSX0JZKCJpZCIpOwogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgMSI7CiAgICAgICAgcmV0dXJuIHJhd1NxbDsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIHNlbGVjdEF0dGVuZGFuY2VzKEBQYXJhbSgic3RhcnRUaW1lIikgTG9jYWxEYXRlVGltZSBzdGFydFRpbWUpIHsKICAgICAgICBMb2NhbERhdGUgc3RhcnREYXRlID0gc3RhcnRUaW1lLnRvTG9jYWxEYXRlKCk7CiAgICAgICAgTGlzdDxTdHJpbmc+IGF0dGVuZGFuY2VEYXRlID0gTGlzdHMubmV3QXJyYXlMaXN0KExvY2FsRGF0ZVV0aWwuZm9ybWF0RGF0ZShzdGFydERhdGUubWludXNEYXlzKDEpKSwKICAgICAgICAgICAgTG9jYWxEYXRlVXRpbC5mb3JtYXREYXRlKHN0YXJ0RGF0ZSksIExvY2FsRGF0ZVV0aWwuZm9ybWF0RGF0ZShzdGFydERhdGUubWludXNEYXlzKDEpKSk7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKTsKICAgICAgICBzcWwuU0VMRUNUKFNFTEVDVF9DT0xVTU4pOwogICAgICAgIHNxbC5GUk9NKFRBQkxFX05BTUUpOwogICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gI3t3b3JrcGxhY2VDb2RlfSIpOwogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlIElOIiArIGNvbW1hSm9pblN0cmluZ1ZhbHVlKGF0dGVuZGFuY2VEYXRlKSk7CiAgICAgICAgc3FsLldIRVJFKCJvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlIDw+ICdBQlNFTlRFRUlTTSciKTsKICAgICAgICBzcWwuV0hFUkUoIigoYXR0ZW5kYW5jZV9zdGFydF90aW1lID49ICN7c3RhcnRUaW1lfSBBTkQgYXR0ZW5kYW5jZV9zdGFydF90aW1lIDw9ICN7ZW5kVGltZX0pIE9SICIKICAgICAgICAgICAgKyAiKGF0dGVuZGFuY2Vfc3RhcnRfdGltZSA8ICN7c3RhcnRUaW1lfSBBTkQgIgogICAgICAgICAgICArICIoYXR0ZW5kYW5jZV9lbmRfdGltZSBJUyBOVUxMIE9SIGF0dGVuZGFuY2VfZW5kX3RpbWUgPiAje3N0YXJ0VGltZX0pKSkiKTsKCiAgICAgICAgcmV0dXJuIHNxbC50b1N0cmluZygpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgc2VsZWN0SW43ZChAUGFyYW0oIndvcmtwbGFjZUNvZGUiKSBTdHJpbmcgd29ya3BsYWNlQ29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oImF0dGVuZGFuY2VEYXRlIikgTG9jYWxEYXRlIGF0dGVuZGFuY2VEYXRlLCBMaXN0PExvbmc+IGVtcGxveWVlTnVtYmVycykgewogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCk7CiAgICAgICAgc3FsLlNFTEVDVCgKICAgICAgICAgICAgImVtcGxveWVlX251bWJlciwgY291bnQoKikgY291bnREYXlzLCBzdW0oY2FzZSB3aGVuIGF0dGVuZGFuY2VfZGF0ZSA9ICN7YXR0ZW5kYW5jZURhdGV9IHRoZW4gMSBlbHNlIDAgIgogICAgICAgICAgICAgICAgKyAiZW5kKSBpc0F0dGVuZGFuY2UiKTsKICAgICAgICBzcWwuRlJPTShUQUJMRV9OQU1FKTsKICAgICAgICBzcWwuV0hFUkUoIndvcmtfcGxhY2VfY29kZSA9ICN7d29ya3BsYWNlQ29kZX0iKTsKICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2VfZGF0ZT49IGRhdGVfYWRkKCN7YXR0ZW5kYW5jZURhdGV9LCBpbnRlcnZhbCAtNyBkYXkpIik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGU8PSAje2F0dGVuZGFuY2VEYXRlfSIpOwogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShlbXBsb3llZU51bWJlcnMpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbnVtYmVyIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShlbXBsb3llZU51bWJlcnMpKTsKICAgICAgICB9CiAgICAgICAgc3FsLldIRVJFKAogICAgICAgICAgICAiKG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgIT0gJ0FCU0VOVEVFSVNNJyBvciBvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlIGlzIG51bGwpIik7CiAgICAgICAgc3FsLkdST1VQX0JZKCJlbXBsb3llZV9udW1iZXIiKTsKICAgICAgICByZXR1cm4gc3FsLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBsaXN0QXR0ZW5kYW5jZUluZm8oQFBhcmFtKCJ3b3JrcGxhY2VDb2RlIikgU3RyaW5nIHdvcmtwbGFjZUNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oIndvcmtEYXRlIikgTG9jYWxEYXRlIHdvcmtEYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdDxMb25nPiBlbXBsb3llZU51bWJlcnMpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpOwogICAgICAgIHNxbC5TRUxFQ1QoU0VMRUNUX0NPTFVNTik7CiAgICAgICAgc3FsLkZST00oVEFCTEVfTkFNRSk7CiAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgPSAje3dvcmtwbGFjZUNvZGV9Iik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPSAje3dvcmtEYXRlfSIpOwogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShlbXBsb3llZU51bWJlcnMpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbnVtYmVyIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShlbXBsb3llZU51bWJlcnMpKTsKICAgICAgICB9CiAgICAgICAgc3FsLldIRVJFKAogICAgICAgICAgICAiKChvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlICE9ICdBQlNFTlRFRUlTTScpIG9yIG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCkiKTsKICAgICAgICByZXR1cm4gc3FsLnRvU3RyaW5nKCk7CiAgICB9</text>
      </register>
      <register name="-" type="4">
        <text>）</text>
      </register>
      <register name="/" type="4">
        <text>TODO</text>
      </register>
      <register name="0" type="2">
        <text encoding="base64">ICAgICAgICB3b3JrUXVldWUucHV0KG5ldyBNeUZ1dHVyZTxTdHJpbmc+KCIyMDAiKSk7Cg==</text>
      </register>
      <register name="1" type="4">
        <text encoding="base64">CiAgICBwdWJsaWMgU3RyaW5nIHNlbGVjdEJ5SWRzKEBQYXJhbSgiaWRzIikgTGlzdDxMb25nPiBpZHMpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpIHt7CiAgICAgICAgICAgIFNFTEVDVChTRUxFQ1RfQ09MVU1OKTsKICAgICAgICAgICAgRlJPTShUQUJMRV9OQU1FKTsKICAgICAgICAgICAgV0hFUkUoImlkIGluICgiICsgSk9JTkVSLmpvaW4oaWRzKSArICIpIik7CiAgICAgICAgfX07CiAgICAgICAgcmV0dXJuIHNxbC50b1N0cmluZygpOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBJTlNFUlRfU1FMID0KICAgICAgICAiKG5vdygpLG5vdygpLCMneydsaXN0W3swfV0uYXR0ZW5kYW5jZURhdGV9LCMneydsaXN0W3swfV0uYXR0ZW5kYW5jZVN0YXJ0VGltZX0sIyd7J2xpc3RbezB9XSIKICAgICAgICAgICAgKyAiLmF0dGVuZGFuY2VFbmRUaW1lfSwjJ3snbGlzdFt7MH1dLmF0dGVuZGFuY2VFeGNlcHRpb25Db2RlfSwjJ3snbGlzdFt7MH1dLmVmZmljaWVuY3lBdHRlbmRUaW1lfSwiCiAgICAgICAgICAgICsgIiMneydsaXN0W3swfV0uYXR0ZW5kYW5jZUJhc2VUaW1lfSwjJ3snbGlzdFt7MH1dLmF0dGVuZGFuY2VPdmVydGltZX0sIyd7J2xpc3RbezB9XS51c2VySWR9LCIKICAgICAgICAgICAgKyAiIyd7J2xpc3RbezB9XS5lbXBsb3llZUxvZ0lkfSwjJ3snbGlzdFt7MH1dLmVtcGxveWVlQ3VzdG9tQXR0cmlidXRlc30sIyd7J2xpc3RbezB9XS53b3JrTmF0dXJlfSwiCiAgICAgICAgICAgICsgIiMneydsaXN0W3swfV0ud29ya05hdHVyZU5hbWV9LCMneydsaXN0W3swfV0iCiAgICAgICAgICAgICsgIi53b3JrR3JvdXBDb2RlfSwjJ3snbGlzdFt7MH1dLndvcmtHcm91cE5hbWV9LCMneydsaXN0W3swfV0ud29ya1BsYWNlQ29kZX0sIyd7J2xpc3RbezB9XSIKICAgICAgICAgICAgKyAiLndvcmtQbGFjZU5hbWV9LCMneydsaXN0W3swfV0uY3BDb2RlfSwjJ3snbGlzdFt7MH1dLmNwTmFtZX0sIyd7J2xpc3RbezB9XS5yZWdpb25JZH0sIyd7J2xpc3RbezB9XSIKICAgICAgICAgICAgKyAiLnJlZ2lvbk5hbWV9LCMneydsaXN0W3swfV0ubGFib3VyQ29tcGFueUlkfSwjJ3snbGlzdFt7MH1dLmxhYm91ckNvbXBhbnlDb2RlfSwjJ3snbGlzdFt7MH1dIgogICAgICAgICAgICArICIubGFib3VyQ29tcGFueU5hbWV9LCMneydsaXN0W3swfV0uZW1wbG95ZWVOYW1lfSwjJ3snbGlzdFt7MH1dLmNsYXNzU3RhcnRUaW1lfSwjJ3snbGlzdFt7MH1dIgogICAgICAgICAgICArICIuY2xhc3NFbmRUaW1lfSwjJ3snbGlzdFt7MH1dLmNsYXNzUmVzdFN0YXJ0VGltZX0sIyd7J2xpc3RbezB9XS5jbGFzc1Jlc3RFbmRUaW1lfSwjJ3snbGlzdFt7MH1dIgogICAgICAgICAgICArICIuZW1wbG95ZWVOdW1iZXJ9LCMneydsaXN0W3swfV0uc3RhdHVzfSwjJ3snbGlzdFt7MH1dLnN0YXR1c05hbWV9LCMneydsaXN0W3swfV0iCiAgICAgICAgICAgICsgIi5pbmR1c3RyeUNvbGxlY3Rpb259LCMneydsaXN0W3swfV0uaW5kdXN0cnlDb2xsZWN0aW9uTmFtZX0sIyd7J2xpc3RbezB9XS5jbGFzc05hbWV9LCMneydsaXN0W3swfV0iCiAgICAgICAgICAgICsgIi5wb3NpdGlvbn0sIyd7J2xpc3RbezB9XS5wb3NpdGlvbnN9LCMneydsaXN0W3swfV0uYnVzaW5lc3NUeXBlfSwjJ3snbGlzdFt7MH1dIgogICAgICAgICAgICArICIuaXNGb3JFZmZpY2llbmN5QXR0ZW5kVGltZX0sIyd7J2xpc3RbezB9XS5sZWF2ZVRpbWV9LCAjJ3snbGlzdFt7MH1dLnJlc3RUaW1lfSwgIgogICAgICAgICAgICArICIjJ3snbGlzdFt7MH1dLm9yaWdpbmFsQXR0ZW5kYW5jZUV4Y2VwdGlvbkNvZGV9LCAjJ3snbGlzdFt7MH1dLmN1c3RvbUF0dHJpYnV0ZXN9LCAjJ3snbGlzdFt7MH1dIgogICAgICAgICAgICArICIuc291cmNlVHlwZX0pIjsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgVVBEQVRFX1NRTCA9ICJPTiBEVVBMSUNBVEUgS0VZIFVQREFURSBnbXRfbW9kaWZpZWQgPSBub3coKSwiCiAgICAgICAgKyAiYXR0ZW5kYW5jZV9kYXRlPXZhbHVlcyhhdHRlbmRhbmNlX2RhdGUpLCBhdHRlbmRhbmNlX3N0YXJ0X3RpbWU9dmFsdWVzKGF0dGVuZGFuY2Vfc3RhcnRfdGltZSksICIKICAgICAgICArICJhdHRlbmRhbmNlX2VuZF90aW1lPXZhbHVlcyhhdHRlbmRhbmNlX2VuZF90aW1lKSxhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlPWlmKGFwcHJvdmFsX2RhdGUgaXMgbm90ICIKICAgICAgICArICJudWxsLCBhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlLCB2YWx1ZXMoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSkpLCIKICAgICAgICArICJlZmZpY2llbmN5X2F0dGVuZF90aW1lPXZhbHVlcyhlZmZpY2llbmN5X2F0dGVuZF90aW1lKSwiCiAgICAgICAgKyAiYXR0ZW5kYW5jZV9iYXNlX3RpbWU9dmFsdWVzKGF0dGVuZGFuY2VfYmFzZV90aW1lKSxhdHRlbmRhbmNlX292ZXJ0aW1lPXZhbHVlcyhhdHRlbmRhbmNlX292ZXJ0aW1lKSwiCiAgICAgICAgKyAidXNlcl9pZD12YWx1ZXModXNlcl9pZCksZW1wbG95ZWVfbG9nX2lkPXZhbHVlcyhlbXBsb3llZV9sb2dfaWQpLHdvcmtfbmF0dXJlPXZhbHVlcyh3b3JrX25hdHVyZSksICIKICAgICAgICArICJ3b3JrX25hdHVyZV9uYW1lPXZhbHVlcyh3b3JrX25hdHVyZV9uYW1lKSwgd29ya19ncm91cF9jb2RlPXZhbHVlcyh3b3JrX2dyb3VwX2NvZGUpLCAiCiAgICAgICAgKyAid29ya19ncm91cF9uYW1lPXZhbHVlcyh3b3JrX2dyb3VwX25hbWUpLCB3b3JrX3BsYWNlX2NvZGU9dmFsdWVzKHdvcmtfcGxhY2VfY29kZSksICIKICAgICAgICArICJ3b3JrX3BsYWNlX25hbWU9dmFsdWVzKHdvcmtfcGxhY2VfbmFtZSksIGNwX2NvZGU9dmFsdWVzKGNwX2NvZGUpLCBjcF9uYW1lPXZhbHVlcyhjcF9uYW1lKSwgIgogICAgICAgICsgInJlZ2lvbl9pZD12YWx1ZXMocmVnaW9uX2lkKSwgcmVnaW9uX25hbWU9dmFsdWVzKHJlZ2lvbl9uYW1lKSwgbGFib3VyX2NvbXBhbnlfaWQ9dmFsdWVzIgogICAgICAgICsgIihsYWJvdXJfY29tcGFueV9pZCksIGxhYm91cl9jb21wYW55X2NvZGU9dmFsdWVzKGxhYm91cl9jb21wYW55X2NvZGUpLCBsYWJvdXJfY29tcGFueV9uYW1lPXZhbHVlcyIKICAgICAgICArICIobGFib3VyX2NvbXBhbnlfbmFtZSksIGVtcGxveWVlX25hbWU9dmFsdWVzKGVtcGxveWVlX25hbWUpLCBjbGFzc19zdGFydF90aW1lPXZhbHVlcyhjbGFzc19zdGFydF90aW1lKSwiCiAgICAgICAgKyAiIGNsYXNzX2VuZF90aW1lPXZhbHVlcyhjbGFzc19lbmRfdGltZSksIGNsYXNzX3Jlc3Rfc3RhcnRfdGltZT12YWx1ZXMoY2xhc3NfcmVzdF9zdGFydF90aW1lKSwgIgogICAgICAgICsgImNsYXNzX3Jlc3RfZW5kX3RpbWU9dmFsdWVzKGNsYXNzX3Jlc3RfZW5kX3RpbWUpLCBlbXBsb3llZV9udW1iZXI9dmFsdWVzKGVtcGxveWVlX251bWJlciksc3RhdHVzPXZhbHVlcyIKICAgICAgICArICIoc3RhdHVzKSwgc3RhdHVzX25hbWU9dmFsdWVzKHN0YXR1c19uYW1lKSwgY2xhc3NfbmFtZT12YWx1ZXMoY2xhc3NfbmFtZSksIHBvc2l0aW9uPXZhbHVlcyhwb3NpdGlvbiksICIKICAgICAgICArICJwb3NpdGlvbnM9dmFsdWVzKHBvc2l0aW9ucyksYnVzaW5lc3NfdHlwZT12YWx1ZXMoYnVzaW5lc3NfdHlwZSksaXNfZm9yX2VmZmljaWVuY3lfYXR0ZW5kX3RpbWU9dmFsdWVzIgogICAgICAgICsgIihpc19mb3JfZWZmaWNpZW5jeV9hdHRlbmRfdGltZSksbGVhdmVfdGltZT12YWx1ZXMobGVhdmVfdGltZSksIHJlc3RfdGltZT12YWx1ZXMocmVzdF90aW1lKSwgIgogICAgICAgICsgImVtcGxveWVlX2N1c3RvbV9hdHRyaWJ1dGVzPXZhbHVlcyhlbXBsb3llZV9jdXN0b21fYXR0cmlidXRlcyksICIKICAgICAgICArICJpbmR1c3RyeV9jb2xsZWN0aW9uPXZhbHVlcyhpbmR1c3RyeV9jb2xsZWN0aW9uKSwgaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lPXZhbHVlcyIKICAgICAgICArICIoaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lKSwgb3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZT12YWx1ZXMiCiAgICAgICAgKyAiKG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUpLCAiCiAgICAgICAgKyAiY3VzdG9tX2F0dHJpYnV0ZXM9dmFsdWVzKGN1c3RvbV9hdHRyaWJ1dGVzKSwgc291cmNlX3R5cGU9dmFsdWVzKHNvdXJjZV90eXBlKSI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFVQREFURV9TUUxfV0lUSE9VVF9BVFRFTkRBTkNFX1RJTUUgPSAiT04gRFVQTElDQVRFIEtFWSBVUERBVEUgZ210X21vZGlmaWVkID0gbm93KCksIgogICAgICAgICsgImF0dGVuZGFuY2VfZGF0ZT12YWx1ZXMoYXR0ZW5kYW5jZV9kYXRlKSwgYXR0ZW5kYW5jZV9zdGFydF90aW1lPXZhbHVlcyhhdHRlbmRhbmNlX3N0YXJ0X3RpbWUpLCAiCiAgICAgICAgKyAiYXR0ZW5kYW5jZV9lbmRfdGltZT12YWx1ZXMoYXR0ZW5kYW5jZV9lbmRfdGltZSksYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZT1pZihhcHByb3ZhbF9kYXRlIGlzIG5vdCAiCiAgICAgICAgKyAibnVsbCwgYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSwgdmFsdWVzKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUpKSwiCiAgICAgICAgKyAiYXR0ZW5kYW5jZV9iYXNlX3RpbWU9dmFsdWVzKGF0dGVuZGFuY2VfYmFzZV90aW1lKSxhdHRlbmRhbmNlX292ZXJ0aW1lPXZhbHVlcyhhdHRlbmRhbmNlX292ZXJ0aW1lKSwiCiAgICAgICAgKyAidXNlcl9pZD12YWx1ZXModXNlcl9pZCksZW1wbG95ZWVfbG9nX2lkPXZhbHVlcyhlbXBsb3llZV9sb2dfaWQpLHdvcmtfbmF0dXJlPXZhbHVlcyh3b3JrX25hdHVyZSksICIKICAgICAgICArICJ3b3JrX25hdHVyZV9uYW1lPXZhbHVlcyh3b3JrX25hdHVyZV9uYW1lKSwgd29ya19ncm91cF9jb2RlPXZhbHVlcyh3b3JrX2dyb3VwX2NvZGUpLCAiCiAgICAgICAgKyAid29ya19ncm91cF9uYW1lPXZhbHVlcyh3b3JrX2dyb3VwX25hbWUpLCB3b3JrX3BsYWNlX2NvZGU9dmFsdWVzKHdvcmtfcGxhY2VfY29kZSksICIKICAgICAgICArICJ3b3JrX3BsYWNlX25hbWU9dmFsdWVzKHdvcmtfcGxhY2VfbmFtZSksIGNwX2NvZGU9dmFsdWVzKGNwX2NvZGUpLCBjcF9uYW1lPXZhbHVlcyhjcF9uYW1lKSwgIgogICAgICAgICsgInJlZ2lvbl9pZD12YWx1ZXMocmVnaW9uX2lkKSwgcmVnaW9uX25hbWU9dmFsdWVzKHJlZ2lvbl9uYW1lKSwgbGFib3VyX2NvbXBhbnlfaWQ9dmFsdWVzIgogICAgICAgICsgIihsYWJvdXJfY29tcGFueV9pZCksIGxhYm91cl9jb21wYW55X2NvZGU9dmFsdWVzKGxhYm91cl9jb21wYW55X2NvZGUpLCBsYWJvdXJfY29tcGFueV9uYW1lPXZhbHVlcyIKICAgICAgICArICIobGFib3VyX2NvbXBhbnlfbmFtZSksIGVtcGxveWVlX25hbWU9dmFsdWVzKGVtcGxveWVlX25hbWUpLCBjbGFzc19zdGFydF90aW1lPXZhbHVlcyhjbGFzc19zdGFydF90aW1lKSwiCiAgICAgICAgKyAiIGNsYXNzX2VuZF90aW1lPXZhbHVlcyhjbGFzc19lbmRfdGltZSksIGNsYXNzX3Jlc3Rfc3RhcnRfdGltZT12YWx1ZXMoY2xhc3NfcmVzdF9zdGFydF90aW1lKSwgIgogICAgICAgICsgImNsYXNzX3Jlc3RfZW5kX3RpbWU9dmFsdWVzKGNsYXNzX3Jlc3RfZW5kX3RpbWUpLCBlbXBsb3llZV9udW1iZXI9dmFsdWVzKGVtcGxveWVlX251bWJlciksc3RhdHVzPXZhbHVlcyIKICAgICAgICArICIoc3RhdHVzKSwgc3RhdHVzX25hbWU9dmFsdWVzKHN0YXR1c19uYW1lKSwgY2xhc3NfbmFtZT12YWx1ZXMoY2xhc3NfbmFtZSksIHBvc2l0aW9uPXZhbHVlcyhwb3NpdGlvbiksICIKICAgICAgICArICJwb3NpdGlvbnM9dmFsdWVzKHBvc2l0aW9ucyksYnVzaW5lc3NfdHlwZT12YWx1ZXMoYnVzaW5lc3NfdHlwZSksaXNfZm9yX2VmZmljaWVuY3lfYXR0ZW5kX3RpbWU9dmFsdWVzIgogICAgICAgICsgIihpc19mb3JfZWZmaWNpZW5jeV9hdHRlbmRfdGltZSksbGVhdmVfdGltZT12YWx1ZXMobGVhdmVfdGltZSksIHJlc3RfdGltZT12YWx1ZXMocmVzdF90aW1lKSwgIgogICAgICAgICsgImVtcGxveWVlX2N1c3RvbV9hdHRyaWJ1dGVzPXZhbHVlcyhlbXBsb3llZV9jdXN0b21fYXR0cmlidXRlcyksICIKICAgICAgICArICJpbmR1c3RyeV9jb2xsZWN0aW9uPXZhbHVlcyhpbmR1c3RyeV9jb2xsZWN0aW9uKSwgaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lPXZhbHVlcyIKICAgICAgICArICIoaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lKSwgb3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZT12YWx1ZXMiCiAgICAgICAgKyAiKG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUpLCAiCiAgICAgICAgKyAiY3VzdG9tX2F0dHJpYnV0ZXM9dmFsdWVzKGN1c3RvbV9hdHRyaWJ1dGVzKSwgc291cmNlX3R5cGU9dmFsdWVzKHNvdXJjZV90eXBlKSI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFVQREFURV9TUUxfT05MWV9CQVNFX0lORk8gPSAiT04gRFVQTElDQVRFIEtFWSBVUERBVEUgZ210X21vZGlmaWVkID0gbm93KCksIgogICAgICAgICsgImF0dGVuZGFuY2VfZGF0ZT12YWx1ZXMoYXR0ZW5kYW5jZV9kYXRlKSwiCiAgICAgICAgKyAidXNlcl9pZD12YWx1ZXModXNlcl9pZCksZW1wbG95ZWVfbG9nX2lkPXZhbHVlcyhlbXBsb3llZV9sb2dfaWQpLHdvcmtfbmF0dXJlPXZhbHVlcyh3b3JrX25hdHVyZSksICIKICAgICAgICArICJ3b3JrX25hdHVyZV9uYW1lPXZhbHVlcyh3b3JrX25hdHVyZV9uYW1lKSwgd29ya19ncm91cF9jb2RlPXZhbHVlcyh3b3JrX2dyb3VwX2NvZGUpLCAiCiAgICAgICAgKyAiZWZmaWNpZW5jeV9hdHRlbmRfdGltZT12YWx1ZXMoZWZmaWNpZW5jeV9hdHRlbmRfdGltZSksIgogICAgICAgICsgIndvcmtfZ3JvdXBfbmFtZT12YWx1ZXMod29ya19ncm91cF9uYW1lKSwgd29ya19wbGFjZV9jb2RlPXZhbHVlcyh3b3JrX3BsYWNlX2NvZGUpLCAiCiAgICAgICAgKyAid29ya19wbGFjZV9uYW1lPXZhbHVlcyh3b3JrX3BsYWNlX25hbWUpLCBjcF9jb2RlPXZhbHVlcyhjcF9jb2RlKSwgY3BfbmFtZT12YWx1ZXMoY3BfbmFtZSksICIKICAgICAgICArICJyZWdpb25faWQ9dmFsdWVzKHJlZ2lvbl9pZCksIHJlZ2lvbl9uYW1lPXZhbHVlcyhyZWdpb25fbmFtZSksIGxhYm91cl9jb21wYW55X2lkPXZhbHVlcyIKICAgICAgICArICIobGFib3VyX2NvbXBhbnlfaWQpLCBsYWJvdXJfY29tcGFueV9jb2RlPXZhbHVlcyhsYWJvdXJfY29tcGFueV9jb2RlKSwgbGFib3VyX2NvbXBhbnlfbmFtZT12YWx1ZXMiCiAgICAgICAgKyAiKGxhYm91cl9jb21wYW55X25hbWUpLCBlbXBsb3llZV9uYW1lPXZhbHVlcyhlbXBsb3llZV9uYW1lKSwgZW1wbG95ZWVfbnVtYmVyPXZhbHVlcyhlbXBsb3llZV9udW1iZXIpLCIKICAgICAgICArICJzdGF0dXM9dmFsdWVzIgogICAgICAgICsgIihzdGF0dXMpLCBzdGF0dXNfbmFtZT12YWx1ZXMoc3RhdHVzX25hbWUpLCBwb3NpdGlvbj12YWx1ZXMocG9zaXRpb24pLCAiCiAgICAgICAgKyAicG9zaXRpb25zPXZhbHVlcyhwb3NpdGlvbnMpLGJ1c2luZXNzX3R5cGU9dmFsdWVzKGJ1c2luZXNzX3R5cGUpLGlzX2Zvcl9lZmZpY2llbmN5X2F0dGVuZF90aW1lPXZhbHVlcyIKICAgICAgICArICIoaXNfZm9yX2VmZmljaWVuY3lfYXR0ZW5kX3RpbWUpLCIKICAgICAgICArICJpbmR1c3RyeV9jb2xsZWN0aW9uPXZhbHVlcyhpbmR1c3RyeV9jb2xsZWN0aW9uKSwgaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lPXZhbHVlcyhpbmR1c3RyeV9jb2xsZWN0aW9uX25hbWUpLCIKICAgICAgICArICJzb3VyY2VfdHlwZT12YWx1ZXMoc291cmNlX3R5cGUpIjsKCiAgICBwdWJsaWMgU3RyaW5nIGJhdGNoSW5zZXJ0T3JVcGRhdGVXaXRob3V0QXR0ZW5kYW5jZVRpbWUoTWFwIG1hcCkgewogICAgICAgIExpc3Q8RGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc0RPPiBkaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE9zCiAgICAgICAgICAgID0gKExpc3Q8RGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc0RPPiltYXAuZ2V0KCJsaXN0Iik7CgogICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAgIHNiLmFwcGVuZCgiSU5TRVJUIElOVE8gIikuYXBwZW5kKFRBQkxFX05BTUUpLmFwcGVuZCgiKCIgKyBJTlNFUlRfQ09MVU1OICsgIikiKS5hcHBlbmQoIiBWQUxVRVMgIik7CiAgICAgICAgTWVzc2FnZUZvcm1hdCBtZiA9IG5ldyBNZXNzYWdlRm9ybWF0KAogICAgICAgICAgICBJTlNFUlRfU1FMKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGRpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NET3Muc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgc2IuYXBwZW5kKG1mLmZvcm1hdChuZXcgT2JqZWN0W10ge2kgKyAiIn0pKTsKICAgICAgICAgICAgaWYgKGkgPCBkaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE9zLnNpemUoKSAtIDEpIHsKICAgICAgICAgICAgICAgIHNiLmFwcGVuZCgiLCIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNiLmFwcGVuZChVUERBVEVfU1FMX1dJVEhPVVRfQVRURU5EQU5DRV9USU1FKTsKCiAgICAgICAgcmV0dXJuIHNiLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBiYXRjaEluc2VydE9yVXBkYXRlKE1hcCBtYXApIHsKICAgICAgICBMaXN0PERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NETz4gZGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc0RPcwogICAgICAgICAgICA9IChMaXN0PERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NETz4pbWFwLmdldCgibGlzdCIpOwoKICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBzYi5hcHBlbmQoIklOU0VSVCBJTlRPICIpLmFwcGVuZChUQUJMRV9OQU1FKS5hcHBlbmQoIigiICsgSU5TRVJUX0NPTFVNTiArICIpIikuYXBwZW5kKCIgVkFMVUVTICIpOwogICAgICAgIE1lc3NhZ2VGb3JtYXQgbWYgPSBuZXcgTWVzc2FnZUZvcm1hdCgKICAgICAgICAgICAgSU5TRVJUX1NRTCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBkaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE9zLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIHNiLmFwcGVuZChtZi5mb3JtYXQobmV3IE9iamVjdFtdIHtpICsgIiJ9KSk7CiAgICAgICAgICAgIGlmIChpIDwgZGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc0RPcy5zaXplKCkgLSAxKSB7CiAgICAgICAgICAgICAgICBzYi5hcHBlbmQoIiwiKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzYi5hcHBlbmQoVVBEQVRFX1NRTCk7CgogICAgICAgIHJldHVybiBzYi50b1N0cmluZygpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgYmF0Y2hJbnNlcnRPclVwZGF0ZU9ubHlCYXNlSW5mbyhNYXAgbWFwKSB7CiAgICAgICAgTGlzdDxEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE8+IGRpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NET3MKICAgICAgICAgICAgPSAoTGlzdDxEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE8+KW1hcC5nZXQoImxpc3QiKTsKCiAgICAgICAgU3RyaW5nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgc2IuYXBwZW5kKCJJTlNFUlQgSU5UTyAiKS5hcHBlbmQoVEFCTEVfTkFNRSkuYXBwZW5kKCIoIiArIElOU0VSVF9DT0xVTU4gKyAiKSIpLmFwcGVuZCgiIFZBTFVFUyAiKTsKICAgICAgICBNZXNzYWdlRm9ybWF0IG1mID0gbmV3IE1lc3NhZ2VGb3JtYXQoSU5TRVJUX1NRTCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBkaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzRE9zLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIHNiLmFwcGVuZChtZi5mb3JtYXQobmV3IE9iamVjdFtdIHtpICsgIiJ9KSk7CiAgICAgICAgICAgIGlmIChpIDwgZGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc0RPcy5zaXplKCkgLSAxKSB7CiAgICAgICAgICAgICAgICBzYi5hcHBlbmQoIiwiKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzYi5hcHBlbmQoVVBEQVRFX1NRTF9PTkxZX0JBU0VfSU5GTyk7CgogICAgICAgIHJldHVybiBzYi50b1N0cmluZygpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZGVsZXRlQnlVc2VySWRzQW5kV29ya0RhdGUoQFBhcmFtKCJ1c2VySWRzIikgTGlzdDxTdHJpbmc+IHVzZXJJZHMsIEBQYXJhbSgid29ya0RhdGUiKSBEYXRlIHdvcmtEYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oIndvcmtwbGFjZUNvZGUiKSBTdHJpbmcgd29ya3BsYWNlQ29kZSkgewogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCkge3sKICAgICAgICAgICAgREVMRVRFX0ZST00oVEFCTEVfTkFNRSk7CiAgICAgICAgICAgIFdIRVJFKCJhdHRlbmRhbmNlX2RhdGU9JyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihEQVRFX0ZPUk1BVF9ZWVlZTU1ERCwgd29ya0RhdGUpICsgIiciKTsKICAgICAgICAgICAgV0hFUkUoIndvcmtfcGxhY2VfY29kZSA9ICciICsgd29ya3BsYWNlQ29kZSArICInIik7CiAgICAgICAgICAgIFdIRVJFKCJ1c2VyX2lkIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZSh1c2VySWRzKSk7CiAgICAgICAgfX07CiAgICAgICAgcmV0dXJuIHNxbC50b1N0cmluZygpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZGVsZXRlQnlEaW5nVXNlcklkc0FuZEF0dGVuZGFuY2VEYXRlcyhAUGFyYW0oIndvcmtwbGFjZUNvZGUiKSBTdHJpbmcgd29ya3BsYWNlQ29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oImRpbmdVc2VySWRzIikgTGlzdDxTdHJpbmc+IGRpbmdVc2VySWRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgiYXR0ZW5kYW5jZURhdGVzIikgTGlzdDxMb2NhbERhdGU+IGF0dGVuZGFuY2VEYXRlcykgewogICAgICAgIExpc3Q8U3RyaW5nPiBhdHRlbmRhbmNlRGF0ZVN0cnMgPSBhdHRlbmRhbmNlRGF0ZXMuc3RyZWFtKCkKICAgICAgICAgICAgLm1hcChMb2NhbERhdGVVdGlsOjpmb3JtYXREYXRlKQogICAgICAgICAgICAuY29sbGVjdChDb2xsZWN0b3JzLnRvTGlzdCgpKTsKCiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKSB7ewogICAgICAgICAgICBERUxFVEVfRlJPTShUQUJMRV9OQU1FKTsKICAgICAgICAgICAgV0hFUkUoIndvcmtfcGxhY2VfY29kZSA9ICN7d29ya3BsYWNlQ29kZX0iKTsKICAgICAgICAgICAgV0hFUkUoImF0dGVuZGFuY2VfZGF0ZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUoYXR0ZW5kYW5jZURhdGVTdHJzKSk7CiAgICAgICAgICAgIFdIRVJFKCJ1c2VyX2lkIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZShkaW5nVXNlcklkcykpOwogICAgICAgIH19OwogICAgICAgIHJldHVybiBzcWwudG9TdHJpbmcoKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGNvdW50SW5kaXZpZHVhbEF0dGVuZGFuY2VTdGF0aXN0aWNzKEluZGl2aWR1YWxEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzUXVlcnkgcXVlcnkpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpOwoKICAgICAgICBzcWwuU0VMRUNUKCJDT1VOVChESVNUSU5DVChlbXBsb3llZV9udW1iZXIpKSIpOwogICAgICAgIHNxbC5GUk9NKEFEQl9UQUJMRV9OQU1FKTsKCiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPj0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlU3RhcnREYXRlKCkpICsgIiciKTsKICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2VfZGF0ZSA8PSAnIiArIERhdGVVdGlsLmdldERhdGUyU3RyKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmREYXRlKCkpICsgIiciKTsKCiAgICAgICAgaWYgKG51bGwgIT0gcXVlcnkuZ2V0UmVnaW9uSWQoKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoInJlZ2lvbl9pZCA9ICIgKyBxdWVyeS5nZXRSZWdpb25JZCgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0V29ya1BsYWNlQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAobnVsbCAhPSBxdWVyeS5nZXRMYWJvdXJDb21wYW55SWQoKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkID0gIiArIHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZCgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtHcm91cENvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX2dyb3VwX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0V29ya0dyb3VwQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXRFbXBsb3llZU5hbWUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJlbXBsb3llZV9uYW1lID0gI3tlbXBsb3llZU5hbWV9Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXRFbXBsb3llZU51bWJlcigpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImVtcGxveWVlX251bWJlciA9ICN7ZW1wbG95ZWVOdW1iZXJ9Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0V29ya3BsYWNlQ29kZXMoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgaW4gIiArIGNvbW1hSm9pblN0cmluZ1ZhbHVlKHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgibGFib3VyX2NvbXBhbnlfaWQgaW4gIiArIGNvbW1hSm9pbkludFZhbHVlKHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpOwogICAgICAgIH0KICAgICAgICBTdHJpbmcgcmF3U3FsID0gc3FsLnRvU3RyaW5nKCk7CiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLnJlcGxhY2UoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChyYXdTcWwpLCAiXFwiLCAiIik7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBsaXN0SW5kaXZpZHVhbERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY0J5TGltaXQoSW5kaXZpZHVhbERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NRdWVyeSBxdWVyeSkgewogICAgICAgIHF1ZXJ5LnNldFF1ZXJ5RnJvbUFuZExpbWl0KCk7CgogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCk7CgogICAgICAgIHNxbC5TRUxFQ1QoCiAgICAgICAgICAgICJkaXN0aW5jdChlbXBsb3llZV9sb2dfaWQpIGFzIGVtcGxveWVlTG9nSWQiKTsKCiAgICAgICAgc3FsLkZST00oVEFCTEVfTkFNRSk7CgogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlID49ICciICsgRGF0ZVV0aWwuZ2V0RGF0ZTJTdHIocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0RGF0ZSgpKSArICInIik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlRW5kRGF0ZSgpKSArICInIik7CgogICAgICAgIGlmIChudWxsICE9IHF1ZXJ5LmdldFJlZ2lvbklkKCkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJyZWdpb25faWQgPSAiICsgcXVlcnkuZ2V0UmVnaW9uSWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrUGxhY2VDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG51bGwgIT0gcXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkKCkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJsYWJvdXJfY29tcGFueV9pZCA9ICIgKyBxdWVyeS5nZXRMYWJvdXJDb21wYW55SWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrR3JvdXBDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19ncm91cF9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtHcm91cENvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0RW1wbG95ZWVOYW1lKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbmFtZSA9ICN7ZW1wbG95ZWVOYW1lfSIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0RW1wbG95ZWVOdW1iZXIoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJlbXBsb3llZV9udW1iZXIgPSAje2VtcGxveWVlTnVtYmVyfSIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZShxdWVyeS5nZXRXb3JrcGxhY2VDb2RlcygpKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKTsKICAgICAgICB9CgogICAgICAgIHNxbC5HUk9VUF9CWShTZWN1cml0eVV0aWwuZXNjYXBlU3FsKFN0cmluZy5qb2luKCIsIiwgcXVlcnkuZ2V0RGltZW5zaW9uKCkpKSk7CgogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgIiArIHF1ZXJ5LmdldFF1ZXJ5RnJvbSgpICsgIiwiICsgcXVlcnkuZ2V0UXVlcnlMaW1pdCgpOwogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5yZXBsYWNlKFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocmF3U3FsKSwgIlxcIiwgIiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgbGlzdEluZGl2aWR1YWxEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWMoSW5kaXZpZHVhbERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NRdWVyeSBxdWVyeSkgewogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCk7CgogICAgICAgIHNxbC5TRUxFQ1QoCiAgICAgICAgICAgICJlbXBsb3llZV9sb2dfaWQgYXMgZW1wbG95ZWVMb2dJZCwgZW1wbG95ZWVfY3VzdG9tX2F0dHJpYnV0ZXMsIHJlZ2lvbl9uYW1lIGFzIHJlZ2lvbk5hbWUsIHdvcmtfcGxhY2VfY29kZSIKICAgICAgICAgICAgICAgICsgIiBhcyB3b3JrcGxhY2VDb2RlLCAiCiAgICAgICAgICAgICAgICArICJ3b3JrX3BsYWNlX25hbWUgYXMgd29ya1BsYWNlTmFtZSwgZW1wbG95ZWVfbmFtZSBhcyBlbXBsb3llZU5hbWUsIHdvcmtfbmF0dXJlX25hbWUgYXMgIgogICAgICAgICAgICAgICAgKyAid29ya05hdHVyZU5hbWUsIGVtcGxveWVlX251bWJlciBhcyBlbXBsb3llZU51bWJlciwgIgogICAgICAgICAgICAgICAgKyAiY291bnQoYXR0ZW5kYW5jZV9kYXRlKSBhcyBhdHRlbmRhbmNlRGF5cywgc3VtKGVmZmljaWVuY3lfYXR0ZW5kX3RpbWUpIGFzIGVmZmljaWVuY3lUaW1lLCIKICAgICAgICAgICAgICAgICsgInN1bShyZXN0X3RpbWUpIGFzIHJlc3RUaW1lLCBzdW0oYXR0ZW5kYW5jZV9iYXNlX3RpbWUpIGFzIGF0dGVuZGFuY2VCYXNlVGltZSwgIgogICAgICAgICAgICAgICAgKyAic3VtKGZsb29yKGF0dGVuZGFuY2Vfb3ZlcnRpbWUvMzYwMC4wKStjYXNlIHdoZW4gYXR0ZW5kYW5jZV9vdmVydGltZS8zNjAwLjAtZmxvb3IiCiAgICAgICAgICAgICAgICArICIoYXR0ZW5kYW5jZV9vdmVydGltZS8zNjAwLjApPj0wLjUgdGhlbiAwLjUgZWxzZSAwIGVuZCkgYXMgYXR0ZW5kYW5jZU92ZXJ0aW1lLCAiCiAgICAgICAgICAgICAgICArICJjb3VudChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJyxpZCxudWxsKSkgYXMgYWJzZW50ZWVpc21EYXlzLCAiCiAgICAgICAgICAgICAgICArICJjb3VudChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ01JU1NfQVRURU5EQU5DRScsaWQsbnVsbCkpIGFzIG1pc3NBdHRlbmRhbmNlRGF5cywgIgogICAgICAgICAgICAgICAgKyAiY291bnQoaWYoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdNSVNTX0lOX09VVF9BVFRFTkRBTkNFJywgaWQsIG51bGwpKSBhcyAiCiAgICAgICAgICAgICAgICArICJtaXNzSW5PdXRBdHRlbmRhbmNlRGF5cywgIgogICAgICAgICAgICAgICAgKyAiY291bnQoaWYoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdPVkVSX0FUVEVOREFOQ0UnLGlkLG51bGwpKSBhcyBvdmVyQXR0ZW5kYW5jZURheXMsICIKICAgICAgICAgICAgICAgICsgImNvdW50KGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnTEFURV9BUlJJVkVEX0FUVEVOREFOQ0UnLGlkLG51bGwpKSBhcyAiCiAgICAgICAgICAgICAgICArICJsYXRlQXJyaXZlZEF0dGVuZGFuY2VEYXlzLCAiCiAgICAgICAgICAgICAgICArICJjb3VudChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0VBUkxZX0xFRlRfQVRURU5EQU5DRScsaWQsbnVsbCkpIGFzIGVhcmx5TGVmdEF0dGVuZGFuY2VEYXlzLCIKICAgICAgICAgICAgICAgICsgImNvdW50KGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnTEFURV9BUlJJVkVEX0VBUkxZX0xFRlRfQVRURU5EQU5DRScsaWQsbnVsbCkpIGFzICIKICAgICAgICAgICAgICAgICsgImxhdGVBcnJpdmVkRWFybHlMZWZ0QXR0ZW5kYW5jZURheXMsICIKICAgICAgICAgICAgICAgICsgInN1bShpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJyxlZmZpY2llbmN5X2F0dGVuZF90aW1lLDApKSBhcyBhYnNlbnRlZWlzbVRpbWUsICIKICAgICAgICAgICAgICAgICsgInN1bShpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ01JU1NfQVRURU5EQU5DRScsZWZmaWNpZW5jeV9hdHRlbmRfdGltZSwwKSkgYXMgIgogICAgICAgICAgICAgICAgKyAibWlzc0F0dGVuZGFuY2VUaW1lLCBzdW0oaWYoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdPVkVSX0FUVEVOREFOQ0UnLGVmZmljaWVuY3lfYXR0ZW5kX3RpbWUsMCkiCiAgICAgICAgICAgICAgICArICIpIGFzIG92ZXJBdHRlbmRhbmNlVGltZSwgY291bnQoaWYobGVhdmVfdGltZSBpcyBub3QgbnVsbCxpZCxudWxsKSkgYXMgbGVhdmVEYXlzLCBzdW0obGVhdmVfdGltZSkgIgogICAgICAgICAgICAgICAgKyAiYXMgbGVhdmVUaW1lIik7CgogICAgICAgIHNxbC5GUk9NKEFEQl9UQUJMRV9OQU1FKTsKCiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPj0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlU3RhcnREYXRlKCkpICsgIiciKTsKICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2VfZGF0ZSA8PSAnIiArIERhdGVVdGlsLmdldERhdGUyU3RyKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmREYXRlKCkpICsgIiciKTsKCiAgICAgICAgaWYgKG51bGwgIT0gcXVlcnkuZ2V0UmVnaW9uSWQoKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoInJlZ2lvbl9pZCA9ICIgKyBxdWVyeS5nZXRSZWdpb25JZCgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0V29ya1BsYWNlQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAobnVsbCAhPSBxdWVyeS5nZXRMYWJvdXJDb21wYW55SWQoKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkID0gIiArIHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZCgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtHcm91cENvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX2dyb3VwX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0V29ya0dyb3VwQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXRFbXBsb3llZU5hbWUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJlbXBsb3llZV9uYW1lID0gI3tlbXBsb3llZU5hbWV9Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXRFbXBsb3llZU51bWJlcigpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImVtcGxveWVlX251bWJlciA9ICN7ZW1wbG95ZWVOdW1iZXJ9Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0V29ya3BsYWNlQ29kZXMoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgaW4gIiArIGNvbW1hSm9pblN0cmluZ1ZhbHVlKHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgibGFib3VyX2NvbXBhbnlfaWQgaW4gIiArIGNvbW1hSm9pbkludFZhbHVlKHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldEVtcGxveWVlTG9nSWRzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbG9nX2lkIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShxdWVyeS5nZXRFbXBsb3llZUxvZ0lkcygpKSk7CiAgICAgICAgfQoKICAgICAgICBzcWwuR1JPVVBfQlkoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChTdHJpbmcuam9pbigiLCIsIHF1ZXJ5LmdldERpbWVuc2lvbigpKSkpOwoKICAgICAgICBTdHJpbmcgcmF3U3FsID0gc3FsLnRvU3RyaW5nKCk7CiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLnJlcGxhY2UoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChyYXdTcWwpLCAiXFwiLCAiIik7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRJbmRpdmlkdWFsRGFpbHlBdHRlbmRhbmNlKEBQYXJhbSgiZW1wbG95ZWVMb2dJZCIpIExvbmcgZW1wbG95ZWVMb2dJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oInF1ZXJ5IikgSW5kaXZpZHVhbERpbmdUYWxrQXR0ZW5kYW5jZVN0YXRpc3RpY3NRdWVyeSBxdWVyeSkgewogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCk7CiAgICAgICAgc3FsLlNFTEVDVChTRUxFQ1RfQ09MVU1OKTsKICAgICAgICBzcWwuRlJPTShBREJfVEFCTEVfTkFNRSk7CgogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlID49ICciICsgRGF0ZVV0aWwuZ2V0RGF0ZTJTdHIocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0RGF0ZSgpKSArICInIik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlRW5kRGF0ZSgpKSArICInIik7CgogICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbG9nX2lkID0gIiArIGVtcGxveWVlTG9nSWQpOwogICAgICAgIGlmIChudWxsICE9IHF1ZXJ5LmdldFJlZ2lvbklkKCkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJyZWdpb25faWQgPSAiICsgcXVlcnkuZ2V0UmVnaW9uSWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrUGxhY2VDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG51bGwgIT0gcXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkKCkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJsYWJvdXJfY29tcGFueV9pZCA9ICIgKyBxdWVyeS5nZXRMYWJvdXJDb21wYW55SWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrR3JvdXBDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19ncm91cF9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtHcm91cENvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlIGluICIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKGNvbW1hSm9pblN0cmluZ1ZhbHVlKHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkIGluICIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKGNvbW1hSm9pbkludFZhbHVlKHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpKTsKICAgICAgICB9CgogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKTsKICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMucmVwbGFjZShTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHJhd1NxbCksICJcXCIsICIiKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGNvdW50RW50aXJlQXR0ZW5kYW5jZVN0YXRpc3RpY3MoRW50aXJlRGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc1F1ZXJ5IHF1ZXJ5KSB7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKTsKCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkocXVlcnkuZ2V0RGltZW5zaW9uKCkpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBXbXBMbXNFeGNlcHRpb24oQmFzaWMuUEFSQU1fTlVMTCk7CiAgICAgICAgfQoKICAgICAgICBzcWwuU0VMRUNUKCJDT1VOVChESVNUSU5DVCgiICsgU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChxdWVyeS5nZXREaW1lbnNpb24oKSkgKyAiKSkiKTsKICAgICAgICBzcWwuRlJPTShBREJfVEFCTEVfTkFNRSk7CgogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlID49ICciICsgRGF0ZVV0aWwuZ2V0RGF0ZTJTdHIocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0RGF0ZSgpKSArICInIik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlRW5kRGF0ZSgpKSArICInIik7CgogICAgICAgIGlmIChudWxsICE9IHF1ZXJ5LmdldFJlZ2lvbklkKCkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJyZWdpb25faWQgPSAiICsgcXVlcnkuZ2V0UmVnaW9uSWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrUGxhY2VDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0Q3BDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiY3BfY29kZSA9ICciICsgU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChxdWVyeS5nZXRDcENvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZShxdWVyeS5nZXRXb3JrcGxhY2VDb2RlcygpKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKTsKICAgICAgICB9CgogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKTsKICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMucmVwbGFjZShTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHJhd1NxbCksICJcXCIsICIiKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGxpc3RFbnRpcmVEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWMoRW50aXJlRGluZ1RhbGtBdHRlbmRhbmNlU3RhdGlzdGljc1F1ZXJ5IHF1ZXJ5KSB7CiAgICAgICAgcXVlcnkuc2V0UXVlcnlGcm9tQW5kTGltaXQoKTsKCiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKTsKICAgICAgICBTdHJpbmcgZGltZW5zaW9uID0gcXVlcnkuZ2V0RGltZW5zaW9uKCk7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsoZGltZW5zaW9uKSkgewogICAgICAgICAgICAvLyDlt6XkvZzngrnnu7TluqbkvJrmnInlpJrkuKrlsZXnpLrkv6Hmga8KICAgICAgICAgICAgaWYgKE9iamVjdHMuZXF1YWxzKGRpbWVuc2lvbiwgV09SS19QTEFDRV9DT0RFKSkgewogICAgICAgICAgICAgICAgc3FsLlNFTEVDVCgid29ya19wbGFjZV9jb2RlIGFzIHdvcmtQbGFjZUNvZGUiKTsKICAgICAgICAgICAgICAgIHNxbC5TRUxFQ1QoIndvcmtfcGxhY2VfbmFtZSBhcyB3b3JrUGxhY2VOYW1lIik7CiAgICAgICAgICAgICAgICBzcWwuU0VMRUNUKCJjcF9jb2RlIGFzIGNwQ29kZSIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNxbC5TRUxFQ1QoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChkaW1lbnNpb24pICsgIiBhcyBkaW1lbnNpb25JZCIpOwogICAgICAgIH0KICAgICAgICBzcWwuU0VMRUNUKCJjb3VudChESVNUSU5DVCh3b3JrX3BsYWNlX2NvZGUpKSBhcyB3b3JrUGxhY2VDb3VudCIKICAgICAgICAgICAgKyAiLCAoY291bnQoRElTVElOQ1QoZW1wbG95ZWVfbnVtYmVyKSkgLSBjb3VudChESVNUSU5DVChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJywiCiAgICAgICAgICAgICsgImVtcGxveWVlX251bWJlcixudWxsKSkpKSBhcyBhdHRlbmRhbmNlUGVvcGxlQ291bnQiCiAgICAgICAgICAgICsgIiwgY291bnQoRElTVElOQ1QoYXR0ZW5kYW5jZV9kYXRlKSkgYXMgYXR0ZW5kYW5jZURheXMiCiAgICAgICAgICAgICsgIiwgc3VtKGVmZmljaWVuY3lfYXR0ZW5kX3RpbWUpIGFzIGVmZmljaWVuY3lUaW1lLCBzdW0ocmVzdF90aW1lKSBhcyByZXN0VGltZSIKICAgICAgICAgICAgKyAiLCBzdW0oYXR0ZW5kYW5jZV9iYXNlX3RpbWUpIGFzIGF0dGVuZGFuY2VCYXNlVGltZSIKICAgICAgICAgICAgKyAiLHN1bShmbG9vcihhdHRlbmRhbmNlX292ZXJ0aW1lLzM2MDAuMCkrY2FzZSB3aGVuIGF0dGVuZGFuY2Vfb3ZlcnRpbWUvMzYwMC4wLWZsb29yIgogICAgICAgICAgICArICIoYXR0ZW5kYW5jZV9vdmVydGltZS8zNjAwLjApPj0wLjUgdGhlbiAwLjUgZWxzZSAwIGVuZCkgYXMgYXR0ZW5kYW5jZU92ZXJ0aW1lIgogICAgICAgICAgICArICIsIHN1bShpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJyxlZmZpY2llbmN5X2F0dGVuZF90aW1lLDApKSBhcyBhYnNlbnRlZWlzbVRpbWUiCiAgICAgICAgICAgICsgIiwgc3VtKGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnTUlTU19BVFRFTkRBTkNFJyxlZmZpY2llbmN5X2F0dGVuZF90aW1lLDApKSBhcyBtaXNzQXR0ZW5kYW5jZVRpbWUiCiAgICAgICAgICAgICsgIiwgc3VtKGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnT1ZFUl9BVFRFTkRBTkNFJyxlZmZpY2llbmN5X2F0dGVuZF90aW1lLDApKSBhcyBvdmVyQXR0ZW5kYW5jZVRpbWUiCiAgICAgICAgICAgICsgIiwgc3VtKGxlYXZlX3RpbWUpIGFzIGxlYXZlVGltZSIKICAgICAgICAgICAgKyAiLCBjb3VudChESVNUSU5DVChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ05PUk1BTCcgb3IgYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSBJUyBudWxsIG9yICIKICAgICAgICAgICAgKyAiYXBwcm92YWxfZGF0ZSBpcyBub3QgbnVsbCxlbXBsb3llZV9udW1iZXIsbnVsbCkpKSBhcyBub3JtYWxQZW9wbGVDb3VudCIKICAgICAgICAgICAgKyAiLCBjb3VudChESVNUSU5DVChpZihyZXN0X3RpbWUgaXMgbm90IG51bGwgYW5kIHJlc3RfdGltZSA8PiAwLGVtcGxveWVlX251bWJlcixudWxsKSkpIGFzICIKICAgICAgICAgICAgKyAicmVzdFBlb3BsZUNvdW50IgogICAgICAgICAgICArICIsIGNvdW50KERJU1RJTkNUKGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnQUJTRU5URUVJU00nLGVtcGxveWVlX251bWJlcixudWxsKSkpIGFzICIKICAgICAgICAgICAgKyAiYWJzZW50ZWVpc21QZW9wbGVDb3VudCIKICAgICAgICAgICAgKyAiLCBjb3VudChESVNUSU5DVChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ01JU1NfQVRURU5EQU5DRScsZW1wbG95ZWVfbnVtYmVyLG51bGwpKSkgYXMgIgogICAgICAgICAgICArICJtaXNzQXR0ZW5kYW5jZVBlb3BsZUNvdW50IgogICAgICAgICAgICArICIsIGNvdW50KERJU1RJTkNUKGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnTUlTU19JTl9PVVRfQVRURU5EQU5DRScsZW1wbG95ZWVfbnVtYmVyLG51bGwpKSkgYXMgIgogICAgICAgICAgICArICJtaXNzSW5PdXRBdHRlbmRhbmNlUGVvcGxlQ291bnQiCiAgICAgICAgICAgICsgIiwgY291bnQoRElTVElOQ1QoaWYoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdPVkVSX0FUVEVOREFOQ0UnLGVtcGxveWVlX251bWJlcixudWxsKSkpIGFzICIKICAgICAgICAgICAgKyAib3ZlckF0dGVuZGFuY2VQZW9wbGVDb3VudCIKICAgICAgICAgICAgKyAiLCBjb3VudChESVNUSU5DVChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0xBVEVfQVJSSVZFRF9BVFRFTkRBTkNFJyxlbXBsb3llZV9udW1iZXIsbnVsbCkpKSBhcyAiCiAgICAgICAgICAgICsgImxhdGVBcnJpdmVkQXR0ZW5kYW5jZVBlb3BsZUNvdW50IgogICAgICAgICAgICArICIsIGNvdW50KERJU1RJTkNUKGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnRUFSTFlfTEVGVF9BVFRFTkRBTkNFJyxlbXBsb3llZV9udW1iZXIsbnVsbCkpKSBhcyAiCiAgICAgICAgICAgICsgImVhcmx5TGVmdEF0dGVuZGFuY2VQZW9wbGVDb3VudCIKICAgICAgICAgICAgKyAiLCBjb3VudChESVNUSU5DVChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0xBVEVfQVJSSVZFRF9FQVJMWV9MRUZUX0FUVEVOREFOQ0UnLGVtcGxveWVlX251bWJlciwiCiAgICAgICAgICAgICsgIm51bGwpKSkgYXMgbGF0ZUFycml2ZWRFYXJseUxlZnRBdHRlbmRhbmNlUGVvcGxlQ291bnQsIGNvdW50KERJU1RJTkNUKGlmKGxlYXZlX3RpbWUgaXMgbm90IG51bGwgYW5kICIKICAgICAgICAgICAgKyAibGVhdmVfdGltZSA8PiAwLCBlbXBsb3llZV9udW1iZXIsIG51bGwpKSkgYXMgbGVhdmVQZW9wbGVDb3VudCwiCiAgICAgICAgICAgICsgInN1bShsZWF2ZV90aW1lKSBhcyBsZWF2ZVRpbWUiKTsKCiAgICAgICAgc3FsLkZST00oVEFCTEVfTkFNRSk7CgogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlID49ICciICsgRGF0ZVV0aWwuZ2V0RGF0ZTJTdHIocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0RGF0ZSgpKSArICInIik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlRW5kRGF0ZSgpKSArICInIik7CgogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0UmVnaW9uSWQoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJyZWdpb25faWQgPSAiICsgcXVlcnkuZ2V0UmVnaW9uSWQoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRDcENvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJjcF9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldENwQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrUGxhY2VDb2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkgKyAiJyIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZShxdWVyeS5nZXRXb3JrcGxhY2VDb2RlcygpKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImxhYm91cl9jb21wYW55X2lkIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEJsYW5rKHF1ZXJ5LmdldERpbWVuc2lvbigpKSkgewogICAgICAgICAgICBzcWwuR1JPVVBfQlkoU3RyaW5nLmpvaW4oIiwiLCBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldERpbWVuc2lvbigpKSkpOwogICAgICAgIH0KCiAgICAgICAgc3FsLk9SREVSX0JZKCJhdHRlbmRhbmNlX2RhdGUiKTsKCiAgICAgICAgU3RyaW5nIHJhd1NxbCA9IHNxbC50b1N0cmluZygpICsgIiBsaW1pdCAiICsgcXVlcnkuZ2V0UXVlcnlGcm9tKCkgKyAiLCIgKyBxdWVyeS5nZXRRdWVyeUxpbWl0KCk7CiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLnJlcGxhY2UoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChyYXdTcWwpLCAiXFwiLCAiIik7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRFbnRpcmVEYWlseUF0dGVuZGFuY2UoQFBhcmFtKCJkaW1lbnNpb25JZCIpIFN0cmluZyBkaW1lbnNpb25JZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgicXVlcnkiKSBFbnRpcmVEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzUXVlcnkgcXVlcnkpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpOwogICAgICAgIHNxbC5TRUxFQ1QoImF0dGVuZGFuY2VfZGF0ZSBhcyBhdHRlbmRhbmNlU2ltcGxlRGF0ZSIKICAgICAgICAgICAgKyAiLHN1bShlZmZpY2llbmN5X2F0dGVuZF90aW1lKSBhcyBlZmZpY2llbmN5VGltZSIKICAgICAgICAgICAgKyAiLHN1bShhdHRlbmRhbmNlX2Jhc2VfdGltZSkgYXMgYXR0ZW5kYW5jZUJhc2VUaW1lIgogICAgICAgICAgICArICIsc3VtKGZsb29yKGF0dGVuZGFuY2Vfb3ZlcnRpbWUvMzYwMC4wKStjYXNlIHdoZW4gYXR0ZW5kYW5jZV9vdmVydGltZS8zNjAwLjAtZmxvb3IiCiAgICAgICAgICAgICsgIihhdHRlbmRhbmNlX292ZXJ0aW1lLzM2MDAuMCk+PTAuNSB0aGVuIDAuNSBlbHNlIDAgZW5kKSBhcyBhdHRlbmRhbmNlT3ZlcnRpbWUiCiAgICAgICAgICAgICsgIixpZihjb3VudChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJyxlbXBsb3llZV9udW1iZXIsbnVsbCkpID4wLCdBQlNFTlRFRUlTTSciCiAgICAgICAgICAgICsgIixpZihjb3VudChpZihhdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ01JU1NfQVRURU5EQU5DRScsZW1wbG95ZWVfbnVtYmVyLG51bGwpKSA+MCwnTUlTU19BVFRFTkRBTkNFJyIKICAgICAgICAgICAgKyAiLGlmKGNvdW50KGlmKGF0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnT1ZFUl9BVFRFTkRBTkNFJyxlbXBsb3llZV9udW1iZXIsbnVsbCkpID4wICwiCiAgICAgICAgICAgICsgIidPVkVSX0FUVEVOREFOQ0UnLG51bGwpKSkgYXMgYXR0ZW5kYW5jZUV4Y2VwdGlvbkNvZGUiKTsKICAgICAgICBzcWwuRlJPTShUQUJMRV9OQU1FKTsKCiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPj0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlU3RhcnREYXRlKCkpICsgIiciKTsKICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2VfZGF0ZSA8PSAnIiArIERhdGVVdGlsLmdldERhdGUyU3RyKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmREYXRlKCkpICsgIiciKTsKCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0RGltZW5zaW9uKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRShTZWN1cml0eVV0aWwuZXNjYXBlU3FsKHF1ZXJ5LmdldERpbWVuc2lvbigpICsgIj0gJyIgKyBkaW1lbnNpb25JZCArICInIikpOwogICAgICAgIH0KCiAgICAgICAgaWYgKE9iamVjdHMubm9uTnVsbChxdWVyeS5nZXRSZWdpb25JZCgpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoInJlZ2lvbl9pZCA9ICIgKyBxdWVyeS5nZXRSZWdpb25JZCgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldENwQ29kZSgpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImNwX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0Q3BDb2RlKCkpICsgIiciKTsKICAgICAgICB9CgogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgPSAnIiArIFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocXVlcnkuZ2V0V29ya1BsYWNlQ29kZSgpKSArICInIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0V29ya3BsYWNlQ29kZXMoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgaW4gIiArIGNvbW1hSm9pblN0cmluZ1ZhbHVlKHF1ZXJ5LmdldFdvcmtwbGFjZUNvZGVzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgibGFib3VyX2NvbXBhbnlfaWQgaW4gIiArIGNvbW1hSm9pbkludFZhbHVlKHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpOwogICAgICAgIH0KCiAgICAgICAgc3FsLkdST1VQX0JZKCJhdHRlbmRhbmNlX2RhdGUiKTsKCiAgICAgICAgU3RyaW5nIHJhd1NxbCA9IHNxbC50b1N0cmluZygpOwogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5yZXBsYWNlKFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocmF3U3FsKSwgIlxcIiwgIiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgY291bnRBdHRlbmRhbmNlU3VtbWFyeUxpc3QoRW1wbG95ZWVBdHRlbmRhbmNlU3VtbWFyeUxpc3RRdWVyeSBxdWVyeSkgewogICAgICAgIHF1ZXJ5LnNldFF1ZXJ5RnJvbUFuZExpbWl0KCk7CgogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCkgewogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBTRUxFQ1QoImNvdW50KCopIik7CiAgICAgICAgICAgICAgICBGUk9NKFRBQkxFX05BTUUpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBTdHJpbmcgcmF3U3FsID0gY29uY2F0ZW5hdGVXaXRoV2hlcmVDb25kaXRpb24oc3FsLCBxdWVyeSk7CiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLnJlcGxhY2UoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChyYXdTcWwpLCAiXFwiLCAiIik7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBsaXN0QXR0ZW5kYW5jZVN1bW1hcnlMaXN0KEVtcGxveWVlQXR0ZW5kYW5jZVN1bW1hcnlMaXN0UXVlcnkgcXVlcnkpIHsKICAgICAgICBxdWVyeS5zZXRRdWVyeUZyb21BbmRMaW1pdCgpOwoKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpIHsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgU0VMRUNUKFNFTEVDVF9DT0xVTU4pOwogICAgICAgICAgICAgICAgRlJPTShUQUJMRV9OQU1FKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgU3RyaW5nIGVmZmVjdGl2ZVNxbCA9IGNvbmNhdGVuYXRlV2l0aFdoZXJlQ29uZGl0aW9uKHNxbCwgcXVlcnkpOwoKICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMucmVwbGFjZShTZWN1cml0eVV0aWwKICAgICAgICAgICAgICAgIC5lc2NhcGVTcWwoZWZmZWN0aXZlU3FsICsgIiBvcmRlciBieSBhdHRlbmRhbmNlX2RhdGUsIGVtcGxveWVlX251bWJlciBsaW1pdCAje3F1ZXJ5RnJvbX0sICIKICAgICAgICAgICAgICAgICAgICArICIje3F1ZXJ5TGltaXR9IiksCiAgICAgICAgICAgICJcXCIsICIiKTsKICAgIH0KCiAgICBwcml2YXRlIFN0cmluZyBjb25jYXRlbmF0ZVdpdGhXaGVyZUNvbmRpdGlvbihTUUwgc3FsLCBFbXBsb3llZUF0dGVuZGFuY2VTdW1tYXJ5TGlzdFF1ZXJ5IHF1ZXJ5KSB7CgogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0U3RhcnREYXRlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlID49ICN7c3RhcnREYXRlfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldEVuZERhdGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gI3tlbmREYXRlfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXROYW1lKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbmFtZSBsaWtlIENPTkNBVCgnJScsICN7bmFtZX0sJyUnKSIpOwogICAgICAgIH0KICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXROdW1iZXIoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJlbXBsb3llZV9udW1iZXI9I3tudW1iZXJ9ICIpOwogICAgICAgIH0KICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldEF0dGVuZGFuY2VFeGNlcHRpb25Db2RlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZT0je2F0dGVuZGFuY2VFeGNlcHRpb25Db2RlfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldFN0YXR1cygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoInN0YXR1cz0je3N0YXR1c30iKTsKICAgICAgICB9CiAgICAgICAgaWYgKE9iamVjdHMubm9uTnVsbChxdWVyeS5nZXRXb3JrTmF0dXJlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19uYXR1cmU9I3t3b3JrTmF0dXJlfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRCdXNpbmVzc1R5cGUoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJidXNpbmVzc190eXBlPSN7YnVzaW5lc3NUeXBlfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0V29ya1BsYWNlQ29kZXMoKSkpIHsKICAgICAgICAgICAgU3RyaW5nIHZhbHVlcyA9IHF1ZXJ5LmdldFdvcmtQbGFjZUNvZGVzKCkKICAgICAgICAgICAgICAgIC5zdHJlYW0oKQogICAgICAgICAgICAgICAgLm1hcChzIC0+ICInIiArIHMgKyAiJyIpCiAgICAgICAgICAgICAgICAucmVkdWNlKChzMSwgczIpIC0+IHMxICsgIiwiICsgczIpCiAgICAgICAgICAgICAgICAuZ2V0KCk7CiAgICAgICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlIGluICgiICsgU2VjdXJpdHlVdGlsLmVzY2FwZVNxbCh2YWx1ZXMpICsgIikiKTsKICAgICAgICB9CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0V29ya1BsYWNlQ29kZSgpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoIndvcmtfcGxhY2VfY29kZSA9ICN7d29ya1BsYWNlQ29kZX0iKTsKICAgICAgICB9CiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJsYWJvdXJfY29tcGFueV9pZCBpbiAiICsgY29tbWFKb2luSW50VmFsdWUocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkcygpKSk7CiAgICAgICAgfQogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0TGFib3VyQ29tcGFueUlkKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgibGFib3VyX2NvbXBhbnlfaWQ9I3tsYWJvdXJDb21wYW55SWR9Iik7CiAgICAgICAgfQogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEJsYW5rKHF1ZXJ5LmdldENwQ29kZSgpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoIndvcmtfcGxhY2VfY29kZSBpbiAoc2VsZWN0IGNvZGUgZnJvbSBsbXNfd29ya19wbGFjZSB3aGVyZSBjcF9jb2RlID0gI3tjcENvZGV9KSIpOwogICAgICAgIH0KICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldFJlZ2lvbklkKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgicmVnaW9uX2lkPSN7cmVnaW9uSWR9Iik7CiAgICAgICAgfQogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEJsYW5rKHF1ZXJ5LmdldEFwcHJvdmFsVXNlcigpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImFwcHJvdmFsX3VzZXI9I3thcHByb3ZhbFVzZXJ9Iik7CiAgICAgICAgfQogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc05vdEJsYW5rKHF1ZXJ5LmdldEFwcHJvdmFsUmVhc29uKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXBwcm92YWxfcmVhc29uPSN7YXBwcm92YWxSZWFzb259Iik7CiAgICAgICAgfQogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0QXBwcm92YWxEYXRlKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXBwcm92YWxfZGF0ZT0je2FwcHJvdmFsRGF0ZX0iKTsKICAgICAgICB9CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzTm90QmxhbmsocXVlcnkuZ2V0QXBwcm92YWxSZW1hcmsoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJhcHByb3ZhbF9yZW1hcms9bGlrZSBDT05DQVQoJyUnLCAje2FwcHJvdmFsUmVtYXJrfSwnJScpIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkocXVlcnkuZ2V0QXR0ZW5kYW5jZUV4Y2VwdGlvbkNvZGVzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUocXVlcnkuZ2V0QXR0ZW5kYW5jZUV4Y2VwdGlvbkNvZGVzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0UygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2Vfc3RhcnRfdGltZSA+PSAje2F0dGVuZGFuY2VTdGFydFN9Iik7CiAgICAgICAgfQogICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwocXVlcnkuZ2V0QXR0ZW5kYW5jZVN0YXJ0RSgpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2Vfc3RhcnRfdGltZSA8PSAje2F0dGVuZGFuY2VTdGFydEV9Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmRTKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9lbmRfdGltZSA+PSAje2F0dGVuZGFuY2VFbmRTfSIpOwogICAgICAgIH0KICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmRFKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9lbmRfdGltZSA8PSAje2F0dGVuZGFuY2VFbmRFfSIpOwogICAgICAgIH0KCiAgICAgICAgU3RyaW5nQnVpbGRlciBzcWxCdWlsZGVyID0gbmV3IFN0cmluZ0J1aWxkZXIoc3FsLnRvU3RyaW5nKCkpOwogICAgICAgIEludGVnZXJbXSBwb3NpdGlvbnMgPSBxdWVyeS5nZXRQb3NpdGlvbnMoKTsKICAgICAgICBpZiAocG9zaXRpb25zICE9IG51bGwgJiYgcG9zaXRpb25zLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgICAgIHNldFBvc2l0aW9uc1doZXJlQ29uZGl0aW9uKHNxbEJ1aWxkZXIsIHBvc2l0aW9ucyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc3FsQnVpbGRlci50b1N0cmluZygpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzZXRQb3NpdGlvbnNXaGVyZUNvbmRpdGlvbihTdHJpbmdCdWlsZGVyIHNxbEJ1aWxkZXIsIEludGVnZXJbXSBwb3NpdGlvbnMpIHsKICAgICAgICBzcWxCdWlsZGVyLmFwcGVuZCgiIEFORCAoIik7CiAgICAgICAgaW50IGkgPSAwOwogICAgICAgIGZvciAoSW50ZWdlciBwb3NpdGlvbiA6IHBvc2l0aW9ucykgewogICAgICAgICAgICBpZiAoT2JqZWN0cy5pc051bGwocG9zaXRpb24pKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoaSAhPSAwKSB7CiAgICAgICAgICAgICAgICBzcWxCdWlsZGVyLmFwcGVuZCgiIE9SICIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIOaehOmAoFNRTO+8mm9yIHBvc2l0aW9ucyBsaWtlICclfDM4fCUnCiAgICAgICAgICAgIHNxbEJ1aWxkZXIuYXBwZW5kKCJwb3NpdGlvbnMgbGlrZSBDT05DQVQoJyUnLCAnfCIpLmFwcGVuZChwb3NpdGlvbikuYXBwZW5kKCJ8JyAsJyUnKSAiKTsKICAgICAgICAgICAgaSsrOwogICAgICAgIH0KICAgICAgICBzcWxCdWlsZGVyLmFwcGVuZCgiKSIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgYmF0Y2hVcGRhdGVCeUlkcyhFbXBsb3llZUF0dGVuZFN0YXRzQmF0Y2hVcGRhdGVRdWVyeSBiYXRjaFVwZGF0ZVF1ZXJ5KSB7CiAgICAgICAgU3RyaW5nIHNxbCA9IG5ldyBTUUwoKSB7CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFVQREFURShUQUJMRV9OQU1FKTsKCiAgICAgICAgICAgICAgICBTRVQoImdtdF9tb2RpZmllZD1ub3coKSIpOwoKICAgICAgICAgICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwoYmF0Y2hVcGRhdGVRdWVyeS5nZXRBdHRlbmRhbmNlRXhjZXB0aW9uQ29kZSgpKSkgewogICAgICAgICAgICAgICAgICAgIFNFVCgiYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZT0je2F0dGVuZGFuY2VFeGNlcHRpb25Db2RlfSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKE9iamVjdHMubm9uTnVsbChiYXRjaFVwZGF0ZVF1ZXJ5LmdldEFwcHJvdmFsVXNlcigpKSkgewogICAgICAgICAgICAgICAgICAgIFNFVCgiYXBwcm92YWxfdXNlcj0je2FwcHJvdmFsVXNlcn0iKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChPYmplY3RzLm5vbk51bGwoYmF0Y2hVcGRhdGVRdWVyeS5nZXRBcHByb3ZhbERhdGUoKSkpIHsKICAgICAgICAgICAgICAgICAgICBTRVQoImFwcHJvdmFsX2RhdGU9I3thcHByb3ZhbERhdGV9Iik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0cy5ub25OdWxsKGJhdGNoVXBkYXRlUXVlcnkuZ2V0QXBwcm92YWxSZWFzb24oKSkpIHsKICAgICAgICAgICAgICAgICAgICBTRVQoImFwcHJvdmFsX3JlYXNvbj0je2FwcHJvdmFsUmVhc29ufSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKE9iamVjdHMubm9uTnVsbChiYXRjaFVwZGF0ZVF1ZXJ5LmdldEFwcHJvdmFsUmVtYXJrKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgU0VUKCJhcHByb3ZhbF9yZW1hcms9I3thcHByb3ZhbFJlbWFya30iKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFdIRVJFKCJpZCBpbiAoIiArIEpPSU5FUi5qb2luKGJhdGNoVXBkYXRlUXVlcnkuZ2V0SWRzKCkpICsgIikiKTsKICAgICAgICAgICAgfQogICAgICAgIH0udG9TdHJpbmcoKTsKICAgICAgICByZXR1cm4gc3FsOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nIGJhdGNoVXBkYXRlSXNEZWxldGUoQFBhcmFtKCJ3b3JrcGxhY2VDb2RlIikgU3RyaW5nIHdvcmtwbGFjZUNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgiaWRzIikgTGlzdDxMb25nPiBpZHMpIHsKICAgICAgICBTdHJpbmcgc3FsID0gbmV3IFNRTCgpIHsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgVVBEQVRFKFRBQkxFX05BTUUpOwoKICAgICAgICAgICAgICAgIFNFVCgiZ210X21vZGlmaWVkPW5vdygpIik7CgogICAgICAgICAgICAgICAgU0VUKCJpc19kZWxldGU9MSIpOwoKICAgICAgICAgICAgICAgIFdIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgPSAje3dvcmtwbGFjZUNvZGV9Iik7CiAgICAgICAgICAgICAgICBXSEVSRSgiaWQgaW4gKCIgKyBKT0lORVIuam9pbihpZHMpICsgIikiKTsKICAgICAgICAgICAgfQogICAgICAgIH0udG9TdHJpbmcoKTsKICAgICAgICByZXR1cm4gc3FsOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgcXVlcnlFZmZpY2llbmN5KEVmZmljaWVuY3lEaW5nVGFsa0F0dGVuZGFuY2VTdGF0aXN0aWNzUXVlcnkgcXVlcnkpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpOwogICAgICAgIHNxbC5TRUxFQ1QoImF0dGVuZGFuY2VfZGF0ZSwgd29ya19wbGFjZV9jb2RlIik7CiAgICAgICAgLy8g57y65YukICsg6K+35YWo5aSp5YGHCiAgICAgICAgc3FsLlNFTEVDVCgiQ09VTlQoRElTVElOQ1QoIgogICAgICAgICAgICArICJJRihvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ0FCU0VOVEVFSVNNJyBvciAobGVhdmVfdGltZSA+IDAgYW5kIGVmZmljaWVuY3lfYXR0ZW5kX3RpbWUgPSAiCiAgICAgICAgICAgICsgIjApLCBudWxsLCBlbXBsb3llZV9udW1iZXIpKSkgQVMgcGVvcGxlQ291bnQiKTsKICAgICAgICBzcWwuU0VMRUNUKCJDT1VOVChESVNUSU5DVCgiCiAgICAgICAgICAgICsgIklGKGxlYXZlX3RpbWUgaXMgbm90IG51bGwgYW5kIGxlYXZlX3RpbWUgPD4gMCwgZW1wbG95ZWVfbnVtYmVyLCBudWxsKSkpIEFTIGxlYXZlUGVvcGxlQ291bnQiKTsKICAgICAgICBzcWwuU0VMRUNUKCJDT1VOVChESVNUSU5DVCgiCiAgICAgICAgICAgICsgIklGKGlzX2Zvcl9lZmZpY2llbmN5X2F0dGVuZF90aW1lID0gMCwgZW1wbG95ZWVfbnVtYmVyLCBudWxsKSkpIGFzIG1hbmFnZXJDb3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoIkNPVU5UKERJU1RJTkNUKCIKICAgICAgICAgICAgKyAiSUYoKG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCBPUiBvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlICE9ICdBQlNFTlRFRUlTTScpICIKICAgICAgICAgICAgKyAiQU5EIGNsYXNzX25hbWUgaXMgbm90IG51bGwsIGVtcGxveWVlX251bWJlciwgbnVsbCkpKSBhcyBzaGlmdFBlb3BsZUNvdW50Iik7CiAgICAgICAgc3FsLlNFTEVDVCgiQ09VTlQoRElTVElOQ1QoIgogICAgICAgICAgICArICJJRigob3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSBpcyBudWxsIE9SIChvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlICE9ICdBQlNFTlRFRUlTTScgIgogICAgICAgICAgICArICJBTkQgb3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSAhPSAnT1ZFUl9BVFRFTkRBTkNFJykpICIKICAgICAgICAgICAgKyAiQU5EIGNsYXNzX25hbWUgaXMgbnVsbCwgZW1wbG95ZWVfbnVtYmVyLCBudWxsKSkpIEFTIGZyZWVQZW9wbGVDb3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoIkNPVU5UKERJU1RJTkNUKCIKICAgICAgICAgICAgKyAiSUYob3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdPVkVSX0FUVEVOREFOQ0UnLCBlbXBsb3llZV9udW1iZXIsIG51bGwpKSkgQVMgb3ZlclBlb3BsZUNvdW50Iik7CiAgICAgICAgc3FsLlNFTEVDVCgiQ09VTlQoRElTVElOQ1QoIgogICAgICAgICAgICArICJJRihvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlID0gJ01JU1NfQVRURU5EQU5DRScsIGVtcGxveWVlX251bWJlciwgbnVsbCkpKSBBUyAiCiAgICAgICAgICAgICsgIm1pc3NBdHRlbmRhbmNlQ291bnQiKTsKICAgICAgICBzcWwuU0VMRUNUKCJDT1VOVChESVNUSU5DVCgiCiAgICAgICAgICAgICsgIklGKG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgPSAnQUJTRU5URUVJU00nLCBlbXBsb3llZV9udW1iZXIsIG51bGwpKSkgQVMgYWJzZW50ZWVpc21Db3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoIkNPVU5UKERJU1RJTkNUKCIKICAgICAgICAgICAgKyAiSUYocmVzdF90aW1lIGlzIG5vdCBudWxsIEFORCByZXN0X3RpbWUgPD4gMCwgZW1wbG95ZWVfbnVtYmVyLCBudWxsKSkpIEFTIHJlc3RQZW9wbGVDb3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoIkNPVU5UKERJU1RJTkNUKCIKICAgICAgICAgICAgKyAiSUYob3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSBpcyBub3QgbnVsbCBhbmQgb3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSAhPSAnTk9STUFMJywgIgogICAgICAgICAgICArICJlbXBsb3llZV9udW1iZXIsIG51bGwpKSkgQVMgYWJub3JtYWxQZW9wbGVDb3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoCiAgICAgICAgICAgICJDT1VOVChESVNUSU5DVChJRigoc291cmNlX3R5cGU9ICdBVE0nIGFuZCAob3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA8PiAnQUJTRU5URUVJU00nIG9yICIKICAgICAgICAgICAgICAgICsgIm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCkgYW5kIGVmZmljaWVuY3lfYXR0ZW5kX3RpbWUgPiAwKSwgZW1wbG95ZWVfbnVtYmVyLCAiCiAgICAgICAgICAgICAgICArICJudWxsKSkpIEFTIGZhY2VQZW9wbGVDb3VudCIpOwogICAgICAgIHNxbC5TRUxFQ1QoIlNVTShlZmZpY2llbmN5X2F0dGVuZF90aW1lKSBBUyBlZmZpY2llbmN5VGltZSIpOwogICAgICAgIHNxbC5TRUxFQ1QoIlNVTShyZXN0X3RpbWUpIEFTIHJlc3RUaW1lIik7CiAgICAgICAgc3FsLlNFTEVDVCgiU1VNKGxlYXZlX3RpbWUpIEFTIGxlYXZlVGltZSIpOwogICAgICAgIHNxbC5TRUxFQ1QoIlNVTShjYXNlIHdoZW4gc291cmNlX3R5cGUgPSAnQUNST1NTX1dBUkVIT1VTRScgdGhlbiAxIGVsc2UgMCBlbmQpIGFzIGhlbHBBdHRlbmRhbmNlUGVvcGxlQ291bnQiKTsKICAgICAgICBzcWwuRlJPTShBREJfVEFCTEVfTkFNRSk7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPj0gJyIgKyBEYXRlVXRpbC5nZXREYXRlMlN0cihxdWVyeS5nZXRBdHRlbmRhbmNlU3RhcnREYXRlKCkpICsgIiciKTsKICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2VfZGF0ZSA8PSAnIiArIERhdGVVdGlsLmdldERhdGUyU3RyKHF1ZXJ5LmdldEF0dGVuZGFuY2VFbmREYXRlKCkpICsgIiciKTsKCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFJlZ2lvbklkcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoInJlZ2lvbl9pZCBpbiAiICsgY29tbWFKb2luSW50VmFsdWUocXVlcnkuZ2V0UmVnaW9uSWRzKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRXb3JrUGxhY2VDb2RlcygpKSkgewogICAgICAgICAgICBzcWwuV0hFUkUoIndvcmtfcGxhY2VfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUocXVlcnkuZ2V0V29ya1BsYWNlQ29kZXMoKSkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldEluZHVzdHJ5Q29sbGVjdGlvbnMoKSkpIHsKICAgICAgICAgICAgc3FsLldIRVJFKCJpbmR1c3RyeV9jb2xsZWN0aW9uIGluICIgKyBjb21tYUpvaW5TdHJpbmdWYWx1ZShxdWVyeS5nZXRJbmR1c3RyeUNvbGxlY3Rpb25zKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRMYWJvdXJDb21wYW55SWRzKCkpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgibGFib3VyX2NvbXBhbnlfaWQgaW4gIiArIGNvbW1hSm9pbkludFZhbHVlKHF1ZXJ5LmdldExhYm91ckNvbXBhbnlJZHMoKSkpOwogICAgICAgIH0KCiAgICAgICAgc3FsLkdST1VQX0JZKCJhdHRlbmRhbmNlX2RhdGUsIHdvcmtfcGxhY2VfY29kZSwgd29ya19wbGFjZV9uYW1lLCBpbmR1c3RyeV9jb2xsZWN0aW9uX25hbWUsIHJlZ2lvbl9uYW1lIik7CiAgICAgICAgc3FsLk9SREVSX0JZKCJhdHRlbmRhbmNlX2RhdGUsIHJlZ2lvbl9uYW1lLCB3b3JrX3BsYWNlX2NvZGUiKTsKICAgICAgICBxdWVyeS5zZXRRdWVyeUZyb21BbmRMaW1pdCgpOwogICAgICAgIHJldHVybiBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgIiArIHF1ZXJ5LmdldFF1ZXJ5RnJvbSgpICsgIiwiICsgcXVlcnkuZ2V0UXVlcnlMaW1pdCgpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0RWZmaWNpZW5jeVJhbmsoRGluZ1RhbGtFZmZpY2llbmN5UmFua1F1ZXJ5IHF1ZXJ5KSB7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKSB7ewogICAgICAgICAgICBTRUxFQ1QoIndvcmtfcGxhY2VfY29kZSB3b3JrUGxhY2VDb2RlLCIKICAgICAgICAgICAgICAgICsgImNwX2NvZGUgY3BDb2RlLCBjcF9uYW1lICIKICAgICAgICAgICAgICAgICsgImNwTmFtZSwgY291bnQoRElTVElOQ1QoaWYiCiAgICAgICAgICAgICAgICArICIoYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSA9ICdBQlNFTlRFRUlTTScsIG51bGwsIGNvbmNhdChlbXBsb3llZV9udW1iZXIsIGF0dGVuZGFuY2VfZGF0ZSkpKSkgYXMgIgogICAgICAgICAgICAgICAgKyAicGVvcGxlQ291bnQsICIKICAgICAgICAgICAgICAgICsgImNvdW50KERJU1RJTkNUKGlmKGxlYXZlX3RpbWUgaXMgbm90IG51bGwgYW5kIGxlYXZlX3RpbWUgPD4gMCwgY29uY2F0KGVtcGxveWVlX251bWJlciwgIgogICAgICAgICAgICAgICAgKyAiYXR0ZW5kYW5jZV9kYXRlKSwgbnVsbCkpKSBhcyAiCiAgICAgICAgICAgICAgICArICJsZWF2ZVBlb3BsZUNvdW50LCAiCiAgICAgICAgICAgICAgICArICJjb3VudChESVNUSU5DVChpZihpc19mb3JfZWZmaWNpZW5jeV9hdHRlbmRfdGltZSA9IDAsIGNvbmNhdChlbXBsb3llZV9udW1iZXIsIGF0dGVuZGFuY2VfZGF0ZSksICIKICAgICAgICAgICAgICAgICsgIm51bGwpKSkgYXMgbWFuYWdlckNvdW50LCAiCiAgICAgICAgICAgICAgICArICJjb3VudChESVNUSU5DVChpZihyZXN0X3RpbWUgaXMgbm90IG51bGwgYW5kIHJlc3RfdGltZSA8PiAwLCBjb25jYXQoZW1wbG95ZWVfbnVtYmVyLCAiCiAgICAgICAgICAgICAgICArICJhdHRlbmRhbmNlX2RhdGUpLCBudWxsKSkpIGFzICIKICAgICAgICAgICAgICAgICsgInJlc3RQZW9wbGVDb3VudCwiCiAgICAgICAgICAgICAgICArICJzdW0oZWZmaWNpZW5jeV9hdHRlbmRfdGltZSkgYXMgZWZmaWNpZW5jeVRpbWUsIHN1bShyZXN0X3RpbWUpIGFzIHJlc3RUaW1lLCBzdW0obGVhdmVfdGltZSkgYXMgIgogICAgICAgICAgICAgICAgKyAibGVhdmVUaW1lLCIKICAgICAgICAgICAgICAgICsgIkNPVU5UKERJU1RJTkNUKElGKHNvdXJjZV90eXBlID0gJ0FUTScsIGVtcGxveWVlX251bWJlciwgbnVsbCkpKSBBUyBmYWNlUGVvcGxlQ291bnQiKTsKICAgICAgICAgICAgaWYgKHF1ZXJ5LmdldFRpbWVEaW1lbnNpb24oKSA9PSBUaW1lRGltZW5zaW9uRW51bS5EQVRFKSB7CiAgICAgICAgICAgICAgICBTRUxFQ1QoImF0dGVuZGFuY2VfZGF0ZSwgYXR0ZW5kYW5jZV9kYXRlIGN5Y2xlIik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocXVlcnkuZ2V0VGltZURpbWVuc2lvbigpID09IFRpbWVEaW1lbnNpb25FbnVtLldFRUspIHsKICAgICAgICAgICAgICAgIC8vIOavj+W5tOeahOacgOWQjuWHoOWkqeeul+S9nOS4i+S4gOW5tOeahOesrOS4gOWRqAogICAgICAgICAgICAgICAgU0VMRUNUKAogICAgICAgICAgICAgICAgICAgICJXRUVLKGF0dGVuZGFuY2VfZGF0ZSwgMykgd2VlaywgaWYoTU9OVEgoYXR0ZW5kYW5jZV9kYXRlKSA9IDEyIGFuZCBXRUVLKGF0dGVuZGFuY2VfZGF0ZSwgMykgPSAxLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgIllFQVIoYXR0ZW5kYW5jZV9kYXRlKSArIDEsIFlFQVIoYXR0ZW5kYW5jZV9kYXRlKSkgeWVhciwgY29uY2F0KFdFRUsoYXR0ZW5kYW5jZV9kYXRlLCAzKSwgIgogICAgICAgICAgICAgICAgICAgICAgICArICIndy0nLCBpZihNT05USChhdHRlbmRhbmNlX2RhdGUpID0gMTIgYW5kIFdFRUsoYXR0ZW5kYW5jZV9kYXRlLCAzKSA9IDEsIFlFQVIiCiAgICAgICAgICAgICAgICAgICAgICAgICsgIihhdHRlbmRhbmNlX2RhdGUpICsgMSwgWUVBUihhdHRlbmRhbmNlX2RhdGUpKSkgY3ljbGUiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFNFTEVDVCgKICAgICAgICAgICAgICAgICAgICAiTU9OVEgoYXR0ZW5kYW5jZV9kYXRlKSBtb250aCwgWUVBUihhdHRlbmRhbmNlX2RhdGUpIHllYXIsIGNvbmNhdChNT05USChhdHRlbmRhbmNlX2RhdGUpLCAnbS0nLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgIllFQVIoYXR0ZW5kYW5jZV9kYXRlKSkgY3ljbGUiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBGUk9NKEFEQl9UQUJMRV9OQU1FKTsKICAgICAgICAgICAgV0hFUkUoCiAgICAgICAgICAgICAgICAiYXR0ZW5kYW5jZV9kYXRlID49ICciICsgU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChMb2NhbERhdGVVdGlsLmZvcm1hdERhdGUocXVlcnkuZ2V0U3RhcnREYXRlKCkpKSArICInIik7CiAgICAgICAgICAgIFdIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPD0gJyIgKyBTZWN1cml0eVV0aWwuZXNjYXBlU3FsKExvY2FsRGF0ZVV0aWwuZm9ybWF0RGF0ZShxdWVyeS5nZXRFbmREYXRlKCkpKSArICInIik7CiAgICAgICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShxdWVyeS5nZXRDcENvZGVzKCkpKSB7CiAgICAgICAgICAgICAgICBXSEVSRSgiY3BfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUocXVlcnkuZ2V0Q3BDb2RlcygpKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKENvbGxlY3Rpb25VdGlscy5pc05vdEVtcHR5KHF1ZXJ5LmdldFJlZ2lvbklkcygpKSkgewogICAgICAgICAgICAgICAgV0hFUkUoInJlZ2lvbl9pZCBpbiAiICsgY29tbWFKb2luSW50VmFsdWUocXVlcnkuZ2V0UmVnaW9uSWRzKCkpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNOb3RCbGFuayhxdWVyeS5nZXRJbmR1c3RyeUNvbGxlY3Rpb24oKSkpIHsKICAgICAgICAgICAgICAgIFdIRVJFKCJpbmR1c3RyeV9jb2xsZWN0aW9uID0gI3tpbmR1c3RyeUNvbGxlY3Rpb259Iik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgR1JPVVBfQlkoIndvcmtfcGxhY2VfY29kZSwgaW5kdXN0cnlfY29sbGVjdGlvbl9uYW1lLCByZWdpb25fbmFtZSwgY3BfbmFtZSwgY3ljbGUiKTsKICAgICAgICAgICAgT1JERVJfQlkoImF0dGVuZGFuY2VfZGF0ZSwgcmVnaW9uX25hbWUsIHdvcmtfcGxhY2VfY29kZSIpOwogICAgICAgIH19OwoKICAgICAgICBTdHJpbmcgcmF3U3FsID0gc3FsLnRvU3RyaW5nKCk7CiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLnJlcGxhY2UoU2VjdXJpdHlVdGlsLmVzY2FwZVNxbChyYXdTcWwpLCAiXFwiLCAiIik7CgogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgcXVlcnlBdHRlbmRXaXRoSWROdW0oQFBhcmFtKCJkYXRlIikgRGF0ZSBkYXRlLCBAUGFyYW0oIndvcmtQbGFjZUNvZGVzIikgTGlzdDxTdHJpbmc+IHdvcmtQbGFjZUNvZGVzKSB7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKSB7ewogICAgICAgICAgICBTRUxFQ1QoCiAgICAgICAgICAgICAgICAiYS5hdHRlbmRhbmNlX2RhdGUsIGEuZW1wbG95ZWVfbmFtZSwgYS5lbXBsb3llZV9udW1iZXIsZS5pZF9udW0sIGEud29ya19wbGFjZV9uYW1lLCBhLmNwX2NvZGUsIGUiCiAgICAgICAgICAgICAgICAgICAgKyAiLmNvb3BlcmF0aW9uX3N0YXJ0X2RhdGUiKTsKICAgICAgICAgICAgRlJPTSgiZGluZ3RhbGtfYXR0ZW5kYW5jZV9zdGF0aXN0aWNzIGEiKTsKICAgICAgICAgICAgSU5ORVJfSk9JTigiZW1wbG95ZWUgZSBvbiBlLm51bWJlciA9IGEuZW1wbG95ZWVfbnVtYmVyIik7CiAgICAgICAgICAgIFdIRVJFKAogICAgICAgICAgICAgICAgIihhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCBvciBhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgIT0gIgogICAgICAgICAgICAgICAgICAgICsgIidBQlNFTlRFRUlTTScpIik7CiAgICAgICAgICAgIFdIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPSAje2RhdGV9Iik7CiAgICAgICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eSh3b3JrUGxhY2VDb2RlcykpIHsKICAgICAgICAgICAgICAgIFdIRVJFKCJhLndvcmtfcGxhY2VfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUod29ya1BsYWNlQ29kZXMpKTsKICAgICAgICAgICAgfQogICAgICAgIH19OwogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgMjAwMDAiOwogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5yZXBsYWNlKFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocmF3U3FsKSwgIlxcIiwgIiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgcXVlcnlXZWVrQXR0ZW5kV2l0aElkTnVtKEBQYXJhbSgiZGF0ZSIpIERhdGUgZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgid29ya1BsYWNlQ29kZXMiKSBMaXN0PFN0cmluZz4gd29ya1BsYWNlQ29kZXMpIHsKICAgICAgICBEYXRlIGRhdGU3QWdvID0gRGF0ZVV0aWxzLmFkZERheXMoZGF0ZSwgLTcpOwogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCkge3sKICAgICAgICAgICAgU0VMRUNUKAogICAgICAgICAgICAgICAgImRpc3RpbmN0IGEuZW1wbG95ZWVfbmFtZSwgYS5lbXBsb3llZV9udW1iZXIsZS5pZF9udW0sIGEud29ya19wbGFjZV9uYW1lLCBhLmNwX2NvZGUsIGUiCiAgICAgICAgICAgICAgICAgICAgKyAiLmNvb3BlcmF0aW9uX3N0YXJ0X2RhdGUiKTsKICAgICAgICAgICAgRlJPTSgiZGluZ3RhbGtfYXR0ZW5kYW5jZV9zdGF0aXN0aWNzIGEiKTsKICAgICAgICAgICAgSU5ORVJfSk9JTigiZW1wbG95ZWUgZSBvbiBlLm51bWJlciA9IGEuZW1wbG95ZWVfbnVtYmVyIik7CiAgICAgICAgICAgIFdIRVJFKAogICAgICAgICAgICAgICAgIihhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCBvciBhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgIT0gIgogICAgICAgICAgICAgICAgICAgICsgIidBQlNFTlRFRUlTTScpIik7CiAgICAgICAgICAgIFdIRVJFKCJhLmF0dGVuZGFuY2VfZGF0ZSA+PSAnIiArIERhdGVVdGlsLmdldERhdGUyU3RyKGRhdGU3QWdvKSArICInIGFuZCBhLmF0dGVuZGFuY2VfZGF0ZSA8PSAje2RhdGV9Iik7CiAgICAgICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eSh3b3JrUGxhY2VDb2RlcykpIHsKICAgICAgICAgICAgICAgIFdIRVJFKCJhLndvcmtfcGxhY2VfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUod29ya1BsYWNlQ29kZXMpKTsKICAgICAgICAgICAgfQogICAgICAgIH19OwogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgMjAwMDAiOwogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5yZXBsYWNlKFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocmF3U3FsKSwgIlxcIiwgIiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgcXVlcnlUd29XZWVrQXR0ZW5kV2l0aElkTnVtKEBQYXJhbSgiZGF0ZSIpIERhdGUgZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgid29ya1BsYWNlQ29kZXMiKSBMaXN0PFN0cmluZz4gd29ya1BsYWNlQ29kZXMpIHsKICAgICAgICBEYXRlIGRhdGUxNEFnbyA9IERhdGVVdGlscy5hZGREYXlzKGRhdGUsIC0xNCk7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKSB7ewogICAgICAgICAgICBTRUxFQ1QoCiAgICAgICAgICAgICAgICAiZGlzdGluY3QgYS5lbXBsb3llZV9uYW1lLCBhLmVtcGxveWVlX251bWJlcixlLmlkX251bSwgYS53b3JrX3BsYWNlX25hbWUsIGEuY3BfY29kZSwgZSIKICAgICAgICAgICAgICAgICAgICArICIuY29vcGVyYXRpb25fc3RhcnRfZGF0ZSIpOwogICAgICAgICAgICBGUk9NKCJkaW5ndGFsa19hdHRlbmRhbmNlX3N0YXRpc3RpY3MgYSIpOwogICAgICAgICAgICBJTk5FUl9KT0lOKCJlbXBsb3llZSBlIG9uIGUubnVtYmVyID0gYS5lbXBsb3llZV9udW1iZXIiKTsKICAgICAgICAgICAgV0hFUkUoCiAgICAgICAgICAgICAgICAiKGEub3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSBpcyBudWxsIG9yIGEub3JpZ2luYWxfYXR0ZW5kYW5jZV9leGNlcHRpb25fY29kZSAhPSAiCiAgICAgICAgICAgICAgICAgICAgKyAiJ0FCU0VOVEVFSVNNJykiKTsKICAgICAgICAgICAgV0hFUkUoImEuYXR0ZW5kYW5jZV9kYXRlID49ICciICsgRGF0ZVV0aWwuZ2V0RGF0ZTJTdHIoZGF0ZTE0QWdvKSArICInIGFuZCBhLmF0dGVuZGFuY2VfZGF0ZSA8PSAje2RhdGV9Iik7CiAgICAgICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eSh3b3JrUGxhY2VDb2RlcykpIHsKICAgICAgICAgICAgICAgIFdIRVJFKCJhLndvcmtfcGxhY2VfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUod29ya1BsYWNlQ29kZXMpKTsKICAgICAgICAgICAgfQogICAgICAgIH19OwogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgMjAwMDAiOwogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5yZXBsYWNlKFNlY3VyaXR5VXRpbC5lc2NhcGVTcWwocmF3U3FsKSwgIlxcIiwgIiIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0QXR0ZW5kSWROdW1QcmVmaXgoQFBhcmFtKCJkYXRlIikgRGF0ZSBkYXRlLCBAUGFyYW0oIndvcmtQbGFjZUNvZGVzIikgTGlzdDxTdHJpbmc+IHdvcmtQbGFjZUNvZGVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oInNwZWNpYWxJZE51bVByZWZpeCIpIExpc3Q8U3RyaW5nPiBzcGVjaWFsSWROdW1QcmVmaXgpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpIHt7CiAgICAgICAgICAgIFNFTEVDVCgiY291bnQoMSkiKTsKICAgICAgICAgICAgRlJPTSgiZGluZ3RhbGtfYXR0ZW5kYW5jZV9zdGF0aXN0aWNzIGEiKTsKICAgICAgICAgICAgSU5ORVJfSk9JTigiZW1wbG95ZWUgZSBvbiBlLm51bWJlciA9IGEuZW1wbG95ZWVfbnVtYmVyIik7CiAgICAgICAgICAgIFdIRVJFKAogICAgICAgICAgICAgICAgIihhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCBvciBhLm9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgIT0gIgogICAgICAgICAgICAgICAgICAgICsgIidBQlNFTlRFRUlTTScpIik7CiAgICAgICAgICAgIFdIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPSAje2RhdGV9Iik7CiAgICAgICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eSh3b3JrUGxhY2VDb2RlcykpIHsKICAgICAgICAgICAgICAgIFdIRVJFKCJhLndvcmtfcGxhY2VfY29kZSBpbiAiICsgY29tbWFKb2luU3RyaW5nVmFsdWUod29ya1BsYWNlQ29kZXMpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoQ29sbGVjdGlvblV0aWxzLmlzTm90RW1wdHkoc3BlY2lhbElkTnVtUHJlZml4KSkgewogICAgICAgICAgICAgICAgTGlzdDxTdHJpbmc+IHdoZXJlcyA9IHNwZWNpYWxJZE51bVByZWZpeC5zdHJlYW0oKQogICAgICAgICAgICAgICAgICAgIC5tYXAoaWROdW1QcmVmaXggLT4gIiBpZF9udW0gbGlrZSAnIiArIGlkTnVtUHJlZml4ICsgIiUnICIpCiAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3QoQ29sbGVjdG9ycy50b0xpc3QoKSk7CiAgICAgICAgICAgICAgICBXSEVSRSgiKCIgKyBPUl9KT0lORVIuam9pbih3aGVyZXMpICsgIikiKTsKICAgICAgICAgICAgfQogICAgICAgIH19OwogICAgICAgIHJldHVybiBzcWwudG9TdHJpbmcoKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldEF0dGVuZGFuY2VCeUVtcGxveWVlTnVtYmVyQW5kV29ya0RhdGUoKSB7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKTsKICAgICAgICBzcWwuU0VMRUNUKFNFTEVDVF9DT0xVTU4pOwogICAgICAgIHNxbC5GUk9NKFRBQkxFX05BTUUpOwogICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gI3t3b3JrcGxhY2VDb2RlfSIpOwogICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbnVtYmVyPSN7ZW1wbG95ZWVOdW1iZXJ9Iik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGU9I3t3b3JrRGF0ZX0iKTsKICAgICAgICBzcWwuV0hFUkUoInNvdXJjZV90eXBlPD4nUFBSJyIpOwogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgMSI7CiAgICAgICAgcmV0dXJuIHJhd1NxbDsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldEZpcnN0QnlBdHRlbmRhbmNlRGF0ZShAUGFyYW0oImF0dGVuZGFuY2VEYXRlIikgTG9jYWxEYXRlVGltZSBhdHRlbmRhbmNlRGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBQYXJhbSgid29ya3BsYWNlQ29kZSIpIFN0cmluZyB3b3JrcGxhY2VDb2RlKSB7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKTsKICAgICAgICBzcWwuU0VMRUNUKFNFTEVDVF9DT0xVTU4pOwogICAgICAgIHNxbC5GUk9NKFRBQkxFX05BTUUgKyAiIGZvcmNlIGluZGV4KGlkeF9hdHRlbmRhbmNlX2RhdGUpICIpOwogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlPSN7YXR0ZW5kYW5jZURhdGV9Iik7CiAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGU9I3t3b3JrcGxhY2VDb2RlfSIpOwogICAgICAgIHNxbC5XSEVSRSgic291cmNlX3R5cGU8PidQUFInIik7CiAgICAgICAgc3FsLk9SREVSX0JZKCJpZCIpOwogICAgICAgIFN0cmluZyByYXdTcWwgPSBzcWwudG9TdHJpbmcoKSArICIgbGltaXQgMSI7CiAgICAgICAgcmV0dXJuIHJhd1NxbDsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIHNlbGVjdEF0dGVuZGFuY2VzKEBQYXJhbSgic3RhcnRUaW1lIikgTG9jYWxEYXRlVGltZSBzdGFydFRpbWUpIHsKICAgICAgICBMb2NhbERhdGUgc3RhcnREYXRlID0gc3RhcnRUaW1lLnRvTG9jYWxEYXRlKCk7CiAgICAgICAgTGlzdDxTdHJpbmc+IGF0dGVuZGFuY2VEYXRlID0gTGlzdHMubmV3QXJyYXlMaXN0KExvY2FsRGF0ZVV0aWwuZm9ybWF0RGF0ZShzdGFydERhdGUubWludXNEYXlzKDEpKSwKICAgICAgICAgICAgTG9jYWxEYXRlVXRpbC5mb3JtYXREYXRlKHN0YXJ0RGF0ZSksIExvY2FsRGF0ZVV0aWwuZm9ybWF0RGF0ZShzdGFydERhdGUubWludXNEYXlzKDEpKSk7CiAgICAgICAgU1FMIHNxbCA9IG5ldyBTUUwoKTsKICAgICAgICBzcWwuU0VMRUNUKFNFTEVDVF9DT0xVTU4pOwogICAgICAgIHNxbC5GUk9NKFRBQkxFX05BTUUpOwogICAgICAgIHNxbC5XSEVSRSgid29ya19wbGFjZV9jb2RlID0gI3t3b3JrcGxhY2VDb2RlfSIpOwogICAgICAgIHNxbC5XSEVSRSgiYXR0ZW5kYW5jZV9kYXRlIElOIiArIGNvbW1hSm9pblN0cmluZ1ZhbHVlKGF0dGVuZGFuY2VEYXRlKSk7CiAgICAgICAgc3FsLldIRVJFKCJvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlIDw+ICdBQlNFTlRFRUlTTSciKTsKICAgICAgICBzcWwuV0hFUkUoIigoYXR0ZW5kYW5jZV9zdGFydF90aW1lID49ICN7c3RhcnRUaW1lfSBBTkQgYXR0ZW5kYW5jZV9zdGFydF90aW1lIDw9ICN7ZW5kVGltZX0pIE9SICIKICAgICAgICAgICAgKyAiKGF0dGVuZGFuY2Vfc3RhcnRfdGltZSA8ICN7c3RhcnRUaW1lfSBBTkQgIgogICAgICAgICAgICArICIoYXR0ZW5kYW5jZV9lbmRfdGltZSBJUyBOVUxMIE9SIGF0dGVuZGFuY2VfZW5kX3RpbWUgPiAje3N0YXJ0VGltZX0pKSkiKTsKCiAgICAgICAgcmV0dXJuIHNxbC50b1N0cmluZygpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgc2VsZWN0SW43ZChAUGFyYW0oIndvcmtwbGFjZUNvZGUiKSBTdHJpbmcgd29ya3BsYWNlQ29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oImF0dGVuZGFuY2VEYXRlIikgTG9jYWxEYXRlIGF0dGVuZGFuY2VEYXRlLCBMaXN0PExvbmc+IGVtcGxveWVlTnVtYmVycykgewogICAgICAgIFNRTCBzcWwgPSBuZXcgU1FMKCk7CiAgICAgICAgc3FsLlNFTEVDVCgKICAgICAgICAgICAgImVtcGxveWVlX251bWJlciwgY291bnQoKikgY291bnREYXlzLCBzdW0oY2FzZSB3aGVuIGF0dGVuZGFuY2VfZGF0ZSA9ICN7YXR0ZW5kYW5jZURhdGV9IHRoZW4gMSBlbHNlIDAgIgogICAgICAgICAgICAgICAgKyAiZW5kKSBpc0F0dGVuZGFuY2UiKTsKICAgICAgICBzcWwuRlJPTShUQUJMRV9OQU1FKTsKICAgICAgICBzcWwuV0hFUkUoIndvcmtfcGxhY2VfY29kZSA9ICN7d29ya3BsYWNlQ29kZX0iKTsKICAgICAgICBzcWwuV0hFUkUoImF0dGVuZGFuY2VfZGF0ZT49IGRhdGVfYWRkKCN7YXR0ZW5kYW5jZURhdGV9LCBpbnRlcnZhbCAtNyBkYXkpIik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGU8PSAje2F0dGVuZGFuY2VEYXRlfSIpOwogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShlbXBsb3llZU51bWJlcnMpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbnVtYmVyIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShlbXBsb3llZU51bWJlcnMpKTsKICAgICAgICB9CiAgICAgICAgc3FsLldIRVJFKAogICAgICAgICAgICAiKG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgIT0gJ0FCU0VOVEVFSVNNJyBvciBvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlIGlzIG51bGwpIik7CiAgICAgICAgc3FsLkdST1VQX0JZKCJlbXBsb3llZV9udW1iZXIiKTsKICAgICAgICByZXR1cm4gc3FsLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBsaXN0QXR0ZW5kYW5jZUluZm8oQFBhcmFtKCJ3b3JrcGxhY2VDb2RlIikgU3RyaW5nIHdvcmtwbGFjZUNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAUGFyYW0oIndvcmtEYXRlIikgTG9jYWxEYXRlIHdvcmtEYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdDxMb25nPiBlbXBsb3llZU51bWJlcnMpIHsKICAgICAgICBTUUwgc3FsID0gbmV3IFNRTCgpOwogICAgICAgIHNxbC5TRUxFQ1QoU0VMRUNUX0NPTFVNTik7CiAgICAgICAgc3FsLkZST00oVEFCTEVfTkFNRSk7CiAgICAgICAgc3FsLldIRVJFKCJ3b3JrX3BsYWNlX2NvZGUgPSAje3dvcmtwbGFjZUNvZGV9Iik7CiAgICAgICAgc3FsLldIRVJFKCJhdHRlbmRhbmNlX2RhdGUgPSAje3dvcmtEYXRlfSIpOwogICAgICAgIGlmIChDb2xsZWN0aW9uVXRpbHMuaXNOb3RFbXB0eShlbXBsb3llZU51bWJlcnMpKSB7CiAgICAgICAgICAgIHNxbC5XSEVSRSgiZW1wbG95ZWVfbnVtYmVyIGluICIgKyBjb21tYUpvaW5JbnRWYWx1ZShlbXBsb3llZU51bWJlcnMpKTsKICAgICAgICB9CiAgICAgICAgc3FsLldIRVJFKAogICAgICAgICAgICAiKChvcmlnaW5hbF9hdHRlbmRhbmNlX2V4Y2VwdGlvbl9jb2RlICE9ICdBQlNFTlRFRUlTTScpIG9yIG9yaWdpbmFsX2F0dGVuZGFuY2VfZXhjZXB0aW9uX2NvZGUgaXMgbnVsbCkiKTsKICAgICAgICByZXR1cm4gc3FsLnRvU3RyaW5nKCk7CiAgICB9</text>
      </register>
      <register name="q" type="4">
        <text />
      </register>
      <register name="2" type="2">
        <text encoding="base64">Cg==</text>
      </register>
      <register name="3" type="2">
        <text encoding="base64">ICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBXT1JLX1BMQUNFX0NPREUgPSAid29ya19wbGFjZV9jb2RlIjsK</text>
      </register>
      <register name="4" type="2">
        <text encoding="base64">ICogQHZlcnNpb24gMS4wCg==</text>
      </register>
      <register name="5" type="2">
        <text encoding="base64">ICAgIC8vIFRPRE8g5LiK57q/5pu/5o2iCg==</text>
      </register>
      <register name="u" type="4">
        <keys>
          <key char="101" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="121" code="0" mods="0" />
          <key char="65535" code="91" mods="130" />
          <key char="117" code="0" mods="0" />
          <key char="117" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="113" code="0" mods="0" />
          <key char="117" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="119" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="121" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="121" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="66" code="0" mods="0" />
          <key char="121" code="0" mods="0" />
          <key char="65" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="73" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="83" code="0" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="103" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="103" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="73" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="73" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="24212" code="0" mods="0" />
          <key char="29992" code="0" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="24212" code="0" mods="0" />
          <key char="29992" code="0" mods="0" />
          <key char="65535" code="69" mods="130" />
          <key char="65535" code="91" mods="130" />
          <key char="65" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="61" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="21024" code="0" mods="0" />
          <key char="38500" code="0" mods="0" />
          <key char="24212" code="0" mods="0" />
          <key char="29992" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="73" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="99" code="0" mods="0" />
          <key char="47" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="83" code="0" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="103" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="117" code="0" mods="0" />
          <key char="115" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="73" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="44" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="99" code="0" mods="0" />
          <key char="65535" code="91" mods="130" />
          <key char="65535" code="80" mods="130" />
          <key char="106" code="0" mods="0" />
          <key char="108" code="0" mods="0" />
          <key char="108" code="0" mods="0" />
          <key char="99" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="119" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="47" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="115" code="0" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="121" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="37" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="109" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="78" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="109" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="78" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="109" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="24212" code="0" mods="0" />
          <key char="29992" code="0" mods="0" />
          <key char="21517" code="0" mods="0" />
          <key char="31216" code="0" mods="0" />
          <key char="65535" code="91" mods="130" />
          <key char="106" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="106" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="65" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="26597" code="0" mods="0" />
          <key char="35810" code="0" mods="0" />
          <key char="20070" code="0" mods="0" />
          <key char="35759" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="23646" code="0" mods="0" />
          <key char="24615" code="0" mods="0" />
          <key char="65535" code="40" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="20998" code="0" mods="0" />
          <key char="39029" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="36215" code="0" mods="0" />
          <key char="22987" code="0" mods="0" />
          <key char="39029" code="0" mods="0" />
          <key char="65535" code="40" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="39029" code="0" mods="0" />
          <key char="25968" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="27599" code="0" mods="0" />
          <key char="39029" code="0" mods="0" />
          <key char="35760" code="0" mods="0" />
          <key char="24405" code="0" mods="0" />
          <key char="25968" code="0" mods="0" />
          <key char="37327" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="23454" code="0" mods="0" />
          <key char="20363" code="0" mods="0" />
          <key char="21015" code="0" mods="0" />
          <key char="34920" code="0" mods="0" />
          <key char="65535" code="37" mods="0" />
          <key char="65535" code="37" mods="0" />
          <key char="20998" code="0" mods="0" />
          <key char="39029" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="113" code="0" mods="0" />
          <key char="117" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="121" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="34" code="0" mods="0" />
          <key char="48" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="109" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="109" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="78" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="109" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="10" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="102" code="0" mods="0" />
          <key char="40" code="0" mods="0" />
          <key char="83" code="0" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="103" code="0" mods="0" />
          <key char="85" code="0" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="108" code="0" mods="0" />
          <key char="115" code="0" mods="0" />
          <key char="46" code="0" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="115" code="0" mods="0" />
          <key char="66" code="0" mods="0" />
          <key char="78" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="66" code="0" mods="0" />
          <key char="59" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="108" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="78" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="109" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="123" code="0" mods="0" />
          <key char="65535" code="10" mods="0" />
          <key char="65535" code="91" mods="130" />
          <key char="65535" code="91" mods="130" />
          <key char="106" code="0" mods="0" />
          <key char="106" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="106" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="65535" code="91" mods="130" />
          <key char="65535" code="91" mods="130" />
          <key char="112" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="106" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="106" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="99" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="47" code="0" mods="0" />
          <key char="113" code="0" mods="0" />
          <key char="117" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="121" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="40" mods="0" />
          <key char="65535" code="37" mods="0" />
          <key char="65535" code="37" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="91" mods="130" />
          <key char="65535" code="91" mods="130" />
          <key char="107" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="107" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="99" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="119" code="0" mods="0" />
          <key char="65" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="84" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="78" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65" code="0" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="84" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="78" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="82" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="115" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="117" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="99" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="82" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="115" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="117" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="99" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="99" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="65535" code="10" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="65535" code="10" mods="0" />
          <key char="46" code="0" mods="0" />
          <key char="118" code="0" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="106" code="0" mods="0" />
          <key char="115" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="79" code="0" mods="0" />
          <key char="98" code="0" mods="0" />
          <key char="106" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="99" code="0" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="65535" code="38" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="65535" code="10" mods="0" />
          <key char="106" code="0" mods="0" />
          <key char="115" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="79" code="0" mods="0" />
          <key char="98" code="0" mods="0" />
          <key char="46" code="0" mods="0" />
          <key char="115" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="46" code="0" mods="0" />
          <key char="34" code="0" mods="0" />
          <key char="58" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="116" code="0" mods="0" />
          <key char="121" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="44" code="0" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="34" code="0" mods="0" />
          <key char="34" code="0" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="59" code="0" mods="0" />
          <key char="65535" code="37" mods="0" />
          <key char="65535" code="37" mods="0" />
          <key char="65535" code="37" mods="0" />
          <key char="97" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="112" code="0" mods="0" />
          <key char="84" code="0" mods="0" />
          <key char="114" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="78" code="0" mods="0" />
          <key char="111" code="0" mods="0" />
          <key char="100" code="0" mods="0" />
          <key char="101" code="0" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="65535" code="10" mods="0" />
          <key char="47" code="0" mods="0" />
          <key char="47" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="10" mods="0" />
          <key char="65535" code="37" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="121" code="0" mods="0" />
          <key char="105" code="0" mods="0" />
          <key char="110" code="0" mods="0" />
          <key char="103" code="0" mods="0" />
          <key char="121" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="29992" code="0" mods="0" />
          <key char="29992" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="24212" code="0" mods="0" />
          <key char="29992" code="0" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="21015" code="0" mods="0" />
          <key char="34920" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="39" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="120" code="0" mods="0" />
          <key char="65535" code="8" mods="0" />
          <key char="32" code="0" mods="0" />
          <key char="20840" code="0" mods="0" />
          <key char="37096" code="0" mods="0" />
          <key char="24212" code="0" mods="0" />
          <key char="29992" code="0" mods="0" />
          <key char="21015" code="0" mods="0" />
          <key char="34920" code="0" mods="0" />
        </keys>
      </register>
      <register name="6" type="2">
        <text encoding="base64">Cg==</text>
      </register>
      <register name="7" type="2">
        <text encoding="base64">Cg==</text>
      </register>
      <register name="8" type="2">
        <text encoding="base64">ICAgICAgICBDb21wbGV0YWJsZUZ1dHVyZTxFbXBsb3llZVBwckNvbnRleHQ+IGNvbnRleHRGdXR1cmUgPSBuZXcgQ29tcGxldGFibGVGdXR1cmU8PigpOwo=</text>
      </register>
      <register name="9" type="2">
        <text encoding="base64">ICAgICAgICAgICAgbG9nZ2VyLmluZm8oImhiYXNlIGZldGNoQ291bnQ6IHt9LCBmdXR1cmVTaXplOiB7fSIsIGZldGNoRnV0dXJlQ291bnQsIGZldGNoRnV0dXJlcy5zaXplKCkpOwo=</text>
      </register>
      <register name=":" type="4">
        <text>wq</text>
      </register>
    </registers>
  </component>
  <component name="VimSearchSettings">
    <search>
      <last-search>TODO</last-search>
      <last-offset />
      <last-pattern>TODO</last-pattern>
      <last-replace>startTime</last-replace>
      <last-substitute>localDateTime</last-substitute>
      <last-dir>1</last-dir>
      <show-last>false</show-last>
    </search>
  </component>
  <component name="VimSettings">
    <state version="6" enabled="true" />
    <notifications>
      <idea-join enabled="true" />
      <idea-put enabled="false" />
    </notifications>
  </component>
</application>